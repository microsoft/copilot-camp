---
search:
  exclude: true
---
# ãƒ©ãƒœ BTA5 - è¤‡é›‘ãªã‚¿ã‚¹ã‚¯å‡¦ç†ã®ãŸã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 

ã“ã®ãƒ©ãƒœã§ã¯ã€æ¬¡ã®ã“ã¨ã‚’è¡Œã„ã¾ã™:

- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒä½•ã‹ã€ã¾ãŸãã‚Œã‚‰ã‚’ç”¨ã„ã¦è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã‚’å‡¦ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™
- ã‚«ã‚¹ã‚¿ãƒ  ã‚¨ãƒ³ã‚¸ãƒ³ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒãƒ«ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’çµ±åˆã—ã¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†ã—ã¾ã™
- ã‚«ã‚¹ã‚¿ãƒ  ã‚¨ãƒ³ã‚¸ãƒ³ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™
- Microsoft Graph ã¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•åŒ–ã—ã¾ã™

<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/bfULaDnpAXY" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>ã“ã®ãƒ“ãƒ‡ã‚ªã§ãƒ©ãƒœã®æ¦‚è¦ã‚’ç´ æ—©ãç¢ºèªã§ãã¾ã™ã€‚</div>
    </div>
    <div style="flex: 1; min-width: 0;">
        ---8<--- "ja/b-labs-prelude.md"
    </div>
</div>

## ã¯ã˜ã‚ã«

Career Genie ãŒè¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹æ™‚ãŒæ¥ã¾ã—ãŸï¼ ã“ã®ãƒ©ãƒœã§ã¯ã€å€™è£œè€…ãƒªã‚¹ãƒˆã‚’å‡¦ç†ã§ãã‚‹æ–°ãŸãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ Career Genie ã®ãƒ­ã‚¸ãƒƒã‚¯ã«çµ±åˆã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€Career Genie ã§å€™è£œè€…ã‚’æ¤œç´¢ã™ã‚‹éš›ã«ã€å€™è£œè€…ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã€åå‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã€ä½œæ¥­å®Œäº†å¾Œã¯ã“ã‚Œã‚‰ã®ãƒªã‚¹ãƒˆã‚’ HR ã«é€ä¿¡ã—ã¦é¢æ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ„ã‚€ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ã™ã¹ã¦ã€Career Genie ã«å®Ÿè£…ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦å‡¦ç†ã•ã‚Œã¾ã™ã€‚ã§ã¯ã€å§‹ã‚ã¾ã—ã‚‡ã†ã€‚

???+ info "ã‚«ã‚¹ã‚¿ãƒ  ã‚¨ãƒ³ã‚¸ãƒ³ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãŠã‘ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯"
    AI ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ã‚³ãƒ¼ãƒ‰å†…ã®åŸºæœ¬çš„ãªé–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ˆã†ãªã‚‚ã®ã§ã€ã‚·ã‚¹ãƒ†ãƒ ãŒå®Ÿè¡Œå¯èƒ½ãªç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã‚’æ„å‘³ã—ã¾ã™ã€‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã«åŸºã¥ã„ã¦ AI ãŒæ§˜ã€…ãªã‚¿ã‚¹ã‚¯ã‚’é‚è¡Œã™ã‚‹ãŸã‚ã®åŸºæœ¬éƒ¨å“ã¨ãªã‚Šã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ AI ã‚·ã‚¹ãƒ†ãƒ ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹éš›ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è§£é‡ˆã—ã€å®Ÿè¡Œã™ã¹ãé©åˆ‡ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¾ã™ã€‚ã¾ã‚‹ã§ãƒ„ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’æŒã£ã¦ãŠã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‹ãƒ¼ã‚ºã«åˆã‚ã›ã¦æœ€é©ãªãƒ„ãƒ¼ãƒ«ã‚’é¸ã³å‡ºã™ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

    ãŸã¨ãˆã°ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ä»¥ä¸‹ã®ã‚‚ã®ãŒå«ã¾ã‚Œã¾ã™:

    * æ–°ã—ã„ãƒªã‚¹ãƒˆã®ä½œæˆ

    * ãƒªã‚¹ãƒˆã®å‰Šé™¤
    
    * æ—¢å­˜ã®ãƒªã‚¹ãƒˆã¸ã®é …ç›®ã®è¿½åŠ 
    
    * æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‹ã‚‰ã®é …ç›®ã®å‰Šé™¤

## æ¼”ç¿’ 1ï¼šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¼´ã†æ–°è¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ

ã“ã®æ¼”ç¿’ã§ã¯ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®æ–°ã—ã„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ "prompts" ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«ä½œæˆã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼š ã€Œmonologueã€ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® `src/prompts/` ã«ç§»å‹•ã—ã€åå‰ãŒ **monologue** ã®æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’è¿½åŠ ã—ã¾ã™ã€‚`src/prompts/monologue/` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«ã€åå‰ãŒ **config.json** ã®æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:

```json
{
  "schema": 1.1,
  "description": "A bot that can chat with users",
  "type": "completion",
  "completion": {
    "completion_type": "chat",
    "include_history": true,
    "include_input": true,
    "max_input_tokens": 2800,
    "max_tokens": 1000,
    "temperature": 0.9,
    "top_p": 0.0,
    "presence_penalty": 0.6,
    "frequency_penalty": 0.0
  },
  "augmentation": {
      "augmentation_type": "monologue"
  }
}
```

!!! tip "config.json å†…ã® `augmentation` ã«ã¤ã„ã¦ã®ç°¡å˜ãªç´¹ä»‹"
    Augmentations ã«ã‚ˆã‚Šã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãŒç°¡ç•¥åŒ–ã•ã‚Œã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ç‰¹å®šã®æŒ‡ç¤ºã‚’è‡ªå‹•çš„ã«è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Augmentations ã‚’ä½¿ç”¨ã™ã‚Œã°ã€AI ã« multi-step tasks (sequence) ã‚’å‡¦ç†ã•ã›ã‚‹ã®ã‹ã€æ®µéšçš„ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è€ƒãˆã•ã›ã‚‹ (monologue) ã®ã‹ã‚’è¨­å®šã§ãã¾ã™ã€‚

`src/prompts/monologue/` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«ã€åå‰ãŒ **skprompt.txt** ã®æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:

```
You are a career specialist named "Career Genie" that helps Human Resources team who can manage lists of Candidates. 
You are friendly and professional. You like using emojis where appropriate.
Always share the lists in bullet points.

rules:
- only create lists the user has explicitly asked to create.
- only add Candidates to a list that the user has asked to have added.
- if multiple lists are being manipulated, call a separate action for each list.
- if Candidates are being added and removed from a list, call a separate action for each operation.
- if user asks for a summary, share all the lists and candidates. 
- only send an email to HR if user has explicitly asked to send.

Current lists:
{{$conversation.lists}}
```

`src/prompts/monologue/` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«ã€åå‰ãŒ **actions.json** ã®æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:

```json
[
    {
        "name": "createList",
        "description": "Creates a new list with an optional set of initial Candidates",
        "parameters": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "string",
                    "description": "The name of the list to create"
                },
                "Candidates": {
                    "type": "array",
                    "description": "The Candidates to add to the list",
                    "Candidates": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "list"
            ]
        }
    },
    {
        "name": "deleteList",
        "description": "Deletes a list",
        "parameters": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "string",
                    "description": "The name of the list to delete"
                }
            },
            "required": [
                "list"
            ]
        }
    },
    {
        "name": "addCandidates",
        "description": "Adds one or more Candidates to a list",
        "parameters": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "string",
                    "description": "The name of the list to add the item to"
                },
                "Candidates": {
                    "type": "array",
                    "description": "The Candidates to add to the list",
                    "Candidates": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "list",
                "Candidates"
            ]
        }
    },
    {
        "name": "removeCandidates",
        "description": "Removes one or more Candidates from a list",
        "parameters": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "string",
                    "description": "The name of the list to remove the item from"
                },
                "Candidates": {
                    "type": "array",
                    "description": "The Candidates to remove from the list",
                    "Candidates": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "list",
                "Candidates"
            ]
        }
    }
]
```

<cc-end-step lab="bta5" exercise="1" step="1" />

## æ¼”ç¿’ 2ï¼šãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé¸æŠãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…

ã“ã®æ¼”ç¿’ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç¢ºèªã—ã€"chat" ã¾ãŸã¯ "monologue" ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é¸æŠã™ã‚‹é–¢æ•°ã‚’ä½œæˆã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã«ãŠã‘ã‚‹ `defaultPrompt` é–¢æ•°ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® `src/app/app.ts` ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã€æ¬¡ã®é–¢æ•°ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
async function choosePrompt(context){
  if (context.activity.text.includes('list')){
    const template = await prompts.getPrompt('monologue');
    return template;
  }
  else {
    const template = await prompts.getPrompt('chat');
    const skprompt = fs.readFileSync(path.join(__dirname, '..', 'prompts', 'chat', 'skprompt.txt'));

    const dataSources = (template.config.completion as any)['data_sources'];

    dataSources.forEach((dataSource: any) => {
      if (dataSource.type === 'azure_search') {
        dataSource.parameters.authentication.key = config.azureSearchKey;
        dataSource.parameters.endpoint = config.azureSearchEndpoint;
        dataSource.parameters.indexName = config.indexName;
        dataSource.parameters.embedding_dependency.deployment_name =
          config.azureOpenAIEmbeddingDeploymentName;
        dataSource.parameters.role_information = `${skprompt.toString('utf-8')}`;
      }
    });

    return template;
  }
}
```

!!! tip " `choosePrompt` é–¢æ•°ã®ç¢ºèª"
    choosePrompt é–¢æ•°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã« "list" ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚å«ã¾ã‚Œã¦ã„ã‚Œã° **monologue** ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿”ã—ã€å«ã¾ã‚Œã¦ã„ãªã‘ã‚Œã°ç¾åœ¨ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ã‚‹ **chat** ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿”ã—ã¾ã™ã€‚

`src/app/app.ts` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ `planner` ã‚’æ¢ã—ã€**defaultPrompt** ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚ãã®å¾Œã€ `choosePrompt` é–¢æ•°ã‚’ **defaultPrompt** ã¨ã—ã¦å®šç¾©ã—ã¾ã™ã€‚ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
const planner = new ActionPlanner({
  model,
  prompts,
  defaultPrompt: choosePrompt,
});
```

<cc-end-step lab="bta5" exercise="2" step="1" />

## æ¼”ç¿’ 3ï¼šã‚¢ãƒ—ãƒªã¸ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè£…

ã“ã®æ¼”ç¿’ã§ã¯ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç”¨ã®é–¢æ•°ã‚’ä½œæˆã—ã€ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼š `ConversationState` ã®æ›´æ–°ãŠã‚ˆã³å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é–¢æ•°å®šç¾©

`src/app/app.ts` å†…ã§ã€`@microsoft/teams-ai` ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ **DefaultConversationState** ã‚’ç”¨ã„ã¦æ›´æ–°ã—ã¾ã™ã€‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
import { AuthError, ActionPlanner, OpenAIModel, PromptManager, AI, PredictedSayCommand, Application, TurnState, DefaultConversationState } from "@microsoft/teams-ai";
```

`src/app/app.ts` å†…ã§ã€**ConversationState** ã¨ **ApplicationTurnState** ã‚’æ¢ã—ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¦ãã ã•ã„:

```javascript
// Strongly type the applications turn state
interface ConversationState extends DefaultConversationState {
  lists: Record<string, string[]>;
}
export type ApplicationTurnState = TurnState<ConversationState>;
```

`src/app/` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«ã€åå‰ãŒ **actions.ts** ã®åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é–¢æ•°ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
import { ApplicationTurnState } from './app';

function getCandidates(state: ApplicationTurnState, list: string): string[] {
    ensureListExists(state, list);
    return state.conversation.lists[list];
}
  
function setCandidates(state: ApplicationTurnState, list: string, Candidates: string[]): void {
    ensureListExists(state, list);
    state.conversation.lists[list] = Candidates ?? [];
}

function ensureListExists(state: ApplicationTurnState, listName: string): void {
    if (typeof state.conversation.lists != 'object') {
        state.conversation.lists = {};
    }

    if (!Object.prototype.hasOwnProperty.call(state.conversation.lists, listName)) {
        state.conversation.lists[listName] = [];
    }
}
  
function deleteList(state: ApplicationTurnState, listName: string): void {
    if (
        typeof state.conversation.lists == 'object' &&
        Object.prototype.hasOwnProperty.call(state.conversation.lists, listName)
    ) {
        delete state.conversation.lists[listName];
    }
}

export { getCandidates, setCandidates, ensureListExists, deleteList };
```

<cc-end-step lab="bta5" exercise="3" step="1" />

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šã‚¢ãƒ—ãƒªã¸ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ç™»éŒ²

`src/app/app.ts` ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«ã€ä»¥ä¸‹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
import { ensureListExists, getCandidates, setCandidates, deleteList } from "./actions";
```

æ¬¡ã«ã€`src/app/app.ts` ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’è¿½åŠ ã—ã€AI ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„:

```javascript
// Register action handlers
interface ListOnly {
  list: string;
}

interface ListAndCandidates extends ListOnly {
  Candidates?: string[];
}

app.ai.action('createList', async (context: TurnContext, state: ApplicationTurnState, parameters: ListAndCandidates) => {
  ensureListExists(state, parameters.list);
  if (Array.isArray(parameters.Candidates) && parameters.Candidates.length > 0) {
      await app.ai.doAction(context, state, 'addCandidates', parameters);
      return `List created and Candidates added. Summarize your action.`;
  } else {
      return `List created. Summarize your action.`;
  }
});

app.ai.action('deleteList', async (context: TurnContext, state: ApplicationTurnState, parameters: ListOnly) => {
  deleteList(state, parameters.list);
  return `list deleted. Summarize your action.`;
});

app.ai.action('addCandidates', async (context: TurnContext, state: ApplicationTurnState, parameters: ListAndCandidates) => {
  const Candidates = getCandidates(state, parameters.list);
  Candidates.push(...(parameters.Candidates ?? []));
  setCandidates(state, parameters.list, Candidates);
  return `Candidates added. Summarize your action.`;
});

app.ai.action('removeCandidates', async (context: TurnContext, state: ApplicationTurnState, parameters: ListAndCandidates) => {
  const Candidates = getCandidates(state, parameters.list);
  (parameters.Candidates ?? []).forEach((candidate: string) => {
      const index = Candidates.indexOf(candidate);
      if (index >= 0) {
          Candidates.splice(index, 1);
      }
  });
  setCandidates(state, parameters.list, Candidates);
  return `Candidates removed. Summarize your action.`;
});

```

<cc-end-step lab="bta5" exercise="3" step="2" />

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šæ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ãŸã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ

æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ­è¼‰ã—ãŸ Career Genie ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚Visual Studio Code ã® **Run and Debug** ã‚¿ãƒ–ã‹ã‚‰ **Debug in Teams (Edge)** ã¾ãŸã¯ **Debug in Teams (Chrome)** ã‚’é¸æŠã—ã¦ã€ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒãƒƒã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚ã™ã‚‹ã¨ã€Microsoft Teams ãŒãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚Teams ä¸Šã«ã‚¢ãƒ—ãƒªã®è©³ç´°ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€**Add** ã‚’é¸æŠã—ã€ã‚¢ãƒ—ãƒªã¨ã®ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚

!!! tip "ãƒ’ãƒ³ãƒˆï¼šã“ã®æ¼”ç¿’ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆ"
    ã“ã‚Œã¾ã§ã«ã‚¢ãƒ—ãƒªã«å®Ÿè£…ã—ãŸ Teams AI ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ã®ä¸€éƒ¨ã¯ Teams App Test Tool ã§ã¯æ­£å¸¸ã«å‹•ä½œã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€Teams ä¸Šã§ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ†ã‚¹ãƒˆãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªé †ç•ªã§ä¼šè©±ã‚’é€²ã‚ã‚‹ã¨ã€å‹•ä½œç¢ºèªã«å½¹ç«‹ã¡ã¾ã™:

- ã“ã‚“ã«ã¡ã¯
- .NET ã®çµŒé¨“ãŒã‚ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚ .NET Developer Candidates ãƒªã‚¹ãƒˆã« Isaac Talbot ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- åŒã˜ãƒªã‚¹ãƒˆã« Anthony Ivanov ã‚’ Isaac ã¨ä¸€ç·’ã«è¿½åŠ ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- Python ã®çµŒé¨“ãŒã‚ã‚Šã€ã‚¹ãƒšã‚¤ãƒ³èªã‚’è©±ã›ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- ã„ã„ã§ã™ã­ï¼ Python Developer Candidates (Spanish speaking) ãƒªã‚¹ãƒˆã« Sara Folgueroles ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- 10å¹´ä»¥ä¸Šã®çµŒé¨“ãŒã‚ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- äº†è§£ã§ã™ã€‚ .NET Developer Candidates ãƒªã‚¹ãƒˆã‹ã‚‰ Anthony ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„
- Talent ãƒªã‚¹ãƒˆã« Anthony Ivanov ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã—ã¦ãã ã•ã„

![ä¸Šè¨˜ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒ•ãƒ­ãƒ¼ã«å¾“ã£ã¦å€™è£œè€…ã‚’æ¤œç´¢ã—ã€ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹ Career Genie ã®å‹•ä½œã‚’ç¤ºã™ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³](../../../assets/images/custom-engine-05/actions.gif)

<cc-end-step lab="bta5" exercise="3" step="3" />

## æ¼”ç¿’ 4ï¼šMicrosoft Graph ã¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€£æºã—ã¦ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®è‡ªå‹•åŒ–ã‚’å®Ÿç¾

ã“ã®æ¼”ç¿’ã§ã¯ã€Microsoft Graph ã‚’åˆ©ç”¨ã—ã¦å€™è£œè€…ãƒªã‚¹ãƒˆã‚’ HR ã«é€ä¿¡ã—ã€é¢æ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª¿æ•´ã™ã‚‹æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šãƒ¡ãƒ¼ãƒ«é€ä¿¡ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® `src/prompts/monologue/actions.json` ã«ç§»å‹•ã—ã€ä»¥ä¸‹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```json
,
{
    "name": "sendLists",
    "description": "Send list of Candidates to Human Resources, aka HR for scheduling interviews",
    "parameters": {
        "type": "object",
        "properties": {
            "list": {
                "type": "string",
                "description": "The name of the list to send Human Resources, aka HR for scheduling interviews"
            },
            "Candidates": {
                "type": "array",
                "description": "The Candidates in the list to send Human Resources, aka HR for scheduling interviews",
                "Candidates": {
                    "type": "string"
                }
            }
        },
        "required": [
            "list",
            "Candidates"
        ]
    }
}
```

<cc-end-step lab="bta5" exercise="4" step="1" />

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šæ–°ã—ã„ `sendLists` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç”¨ã®é–¢æ•°ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® `src/app/app.ts` ã«ç§»å‹•ã—ã€`getUserDisplayName` ã‚’æ¢ã—ã¦ã€é–¢æ•°ã®å‰ã« **export** ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚é–¢æ•°ã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
export async function getUserDisplayName {
...
...
...
}

```

`src/app/app.ts` å†…ã® `app` ã‚’è¦‹ã¤ã‘ã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’ **'Mail.Send'** ã«æ›´æ–°ã—ã¦ãã ã•ã„ã€‚ã‚¢ãƒ—ãƒªã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
const app = new Application({
  storage,
  authentication: {settings: {
    graph: {
      scopes: ['User.Read', 'Mail.Send'],
        ...
        ...
    }
  }}});
```

`env/.env.local.user` ã«ç§»å‹•ã—ã€ä»¥ä¸‹ã® HR ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¿½åŠ ã—ã¦ãã ã•ã„:

```
HR_EMAIL=<YOUR-EMAIL-ADDRESS>
```

!!! pied-piper "`HR_EMAIL` ã®è©³ç´°ï¼ˆã“ã®ãƒ©ãƒœã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ï¼‰"
    ã“ã®ãƒ©ãƒœã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€`HR_EMAIL` ã«ã”è‡ªèº«ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ç†æƒ³çš„ã«ã¯ã€é¢æ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ã€Human Resources Team ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ©ãƒœã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ç›®çš„ã®ã¿ã§ã‚ã‚Šã€æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨ã¯æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ã€‚

`teamsapp.local.yml` ã«ç§»å‹•ã—ã€`file/createOrUpdateEnvironmentFile` ã® **envs** ãƒªã‚¹ãƒˆã®ä¸‹ã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```
HR_EMAIL: ${{HR_EMAIL}}
```

`src/config.ts` ã«ç§»å‹•ã—ã€è¨­å®šã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
HR_EMAIL: process.env.HR_EMAIL
```

`src/app/actions.ts` ã«ç§»å‹•ã—ã€ã‚³ãƒ¼ãƒ‰ä¸Šéƒ¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›´æ–°ã—ã¦ãã ã•ã„:

```javascript
import { getUserDisplayName, ApplicationTurnState } from './app';
import { Client } from "@microsoft/microsoft-graph-client";
import config from '../config';
```

æ¬¡ã«ã€`actions.ts` ã«ä»¥ä¸‹ã®é–¢æ•°ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
async function sendLists(state: ApplicationTurnState, token): Promise<string> {
    const email = await createEmailContent(state.conversation.lists, token);
    try {
        const client = Client.init({
            authProvider: (done) => {
                done(null, token);
            }
        });
        const sendEmail = await client.api('/me/sendMail').post(JSON.stringify(email));
        if (sendEmail.ok) {
            return email.message.body.content;
        }
        else {
            console.log(`Error ${sendEmail.status} calling Graph in sendToHR: ${sendEmail.statusText}`);
            return 'Error sending email';
        }
    } catch (error) {
        console.error('Error in sendLists:', error);
        throw error;
    }
}
   
async function createEmailContent(lists, token) {
    let emailContent = '';
    for (const listName in lists) {
        if (lists.hasOwnProperty(listName)) {
        emailContent += `${listName}:\n`;
        lists[listName].forEach(candidate => {
            emailContent += `  â€¢ ${candidate}\n`;
        });
        emailContent += '\n'; // Add an extra line between different lists
        }
    }

    const profileName = await getUserDisplayName(token);

    const email ={
        "message": {
        "subject": "Request to Schedule Interviews with Shortlisted Candidates",
        "body": {
            "contentType": "Text",
            "content": `Hello HR Team, \nI hope this email finds you well. \n\nCould you please assist in scheduling 1:1 interviews with the following shortlisted candidates? \n\n${emailContent} Please arrange suitable times and send out the calendar invites accordingly. \n\n Best Regards, \n ${profileName}`
        },
        "toRecipients": [
            {
            "emailAddress": {
                "address": `${config.HR_EMAIL}`
            }
            }
        ]
        },
        "saveToSentCandidates": "true"
    };
    return await email;
}
```

æœ€å¾Œã« `src/app/actions.ts` ã«ã¦ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã« **sendLists** ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
export { getCandidates, setCandidates, ensureListExists, deleteList, sendLists };
```

<cc-end-step lab="bta5" exercise="4" step="2" />

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼š`sendLists` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ç™»éŒ²

`src/app/app.ts` ã«ç§»å‹•ã—ã€`./actions` ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ **sendLists** é–¢æ•°ä»˜ãã«æ›´æ–°ã—ã¦ãã ã•ã„ã€‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```javascript
import { ensureListExists, getCandidates, setCandidates, deleteList, sendLists } from "./actions";
```

æ¬¡ã«ã€AI ã‚·ã‚¹ãƒ†ãƒ ã« `sendLists` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™»éŒ²ã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
app.ai.action('sendLists', async (context: TurnContext, state: ApplicationTurnState, parameters: ListAndCandidates) => {
  await sendLists(state, state.temp.authTokens['graph']);
  return `Email sent to HR. Summarize your action.`;
});
```

<cc-end-step lab="bta5" exercise="4" step="3" />

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼šEntra ID ã‚¢ãƒ—ãƒªç™»éŒ²ã®æ›´æ–°

æ–°ã—ã„ã‚¹ã‚³ãƒ¼ãƒ— `Mail.Send` ã‚’å¯¾è±¡ã¨ã™ã‚‹ Entra ID ã‚¢ãƒ—ãƒªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚**aad.manifest.json** ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã€ãƒãƒ¼ãƒ‰ `requiredResourceAccess` å†…ã§ `  "resourceAppId": "Microsoft Graph",` ã‚’æ¢ã—ã¾ã™ã€‚`resourceAccess` é…åˆ—å†…ã«ã€ã‚«ãƒ³ãƒã®å¾Œã«ä»¥ä¸‹ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

```JSON
 {
    "id": "Mail.Send",
    "type": "Scope"
}
```

<cc-end-step lab="bta5" exercise="4" step="4" />

### ã‚¹ãƒ†ãƒƒãƒ— 5ï¼šã‚¢ãƒ—ãƒªãŠã‚ˆã³æ–°ã—ã„ `sendLists` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ

æ–°ã—ã„ **sendLists** ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ­è¼‰ã—ãŸ Career Genie ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚Visual Studio Code ã® **Run and Debug** ã‚¿ãƒ–ã‹ã‚‰ **Debug in Teams (Edge)** ã¾ãŸã¯ **Debug in Teams (Chrome)** ã‚’é¸æŠã—ã¦ã€ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒãƒƒã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚ã™ã‚‹ã¨ã€Microsoft Teams ãŒãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚Teams ä¸Šã«ã‚¢ãƒ—ãƒªã®è©³ç´°ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€**Add** ã‚’é¸æŠã—ã¦ã€ã‚¢ãƒ—ãƒªã¨ã®ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚

!!! tip "ãƒ’ãƒ³ãƒˆï¼šã“ã®æ¼”ç¿’ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆ"
    ã“ã‚Œã¾ã§ã«ã‚¢ãƒ—ãƒªã«å®Ÿè£…ã—ãŸ Teams AI ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ã®ä¸€éƒ¨ã¯ Teams App Test Tool ã§ã¯æ­£å¸¸ã«å‹•ä½œã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€Teams ä¸Šã§ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ†ã‚¹ãƒˆãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

Career Genie ã¨ã®ä¼šè©±ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€å˜ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä¾‹ãˆã°ã€'Hi' ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

!!! tip "ãƒ’ãƒ³ãƒˆï¼šãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¨­å®šã‚’ç¢ºèªã™ã‚‹"
    ä¸‹è¨˜ã®æŒ‡ç¤ºãŒå††æ»‘ã«é€²ã‚€ã‚ˆã†ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ `Pop up` ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

è¿½åŠ ã®æ¨©é™ã«é–¢ã™ã‚‹å°ã•ãªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒœãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã€â€˜Cancelâ€™ ã¨ â€˜Continueâ€™ ã®ãƒœã‚¿ãƒ³ãŒç¾ã‚Œã¾ã™ã€‚ã“ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦å¿…è¦ãªæ¨©é™ã¸ã®åŒæ„ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚**Continue** ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

![Microsoft Teams ã®ãƒãƒ£ãƒƒãƒˆã«ãŠã„ã¦ã€ã‚«ã‚¹ã‚¿ãƒ  ã‚¨ãƒ³ã‚¸ãƒ³ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸã‚¢ãƒ—ãƒªã¸ã®æ¨©é™ã®åŒæ„ã‚’æ±‚ã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã€'Continue' ãƒœã‚¿ãƒ³ã¨ 'Cancel' ãƒœã‚¿ãƒ³ãŒå­˜åœ¨ã™ã‚‹æ§˜å­ã€‚](../../../assets/images/custom-engine-04/consent-teams.png)

Developer Tunnels ã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã—ã¦ã„ã‚‹ãŸã‚ã€è­¦å‘Šç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ãŒã€**Continue** ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚ã‚¢ãƒ—ãƒªãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã¨ã€ã“ã®è­¦å‘Šã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã€ã‚¢ãƒ—ãƒªã®æ¨©é™ã«åŒæ„ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

!!! tip "ãƒ’ãƒ³ãƒˆï¼šçµ„ç¹”å…¨ä½“ã‚’ä»£è¡¨ã—ã¦åŒæ„ã™ã‚‹"
    Microsoft 365 ã®ç®¡ç†è€…ã®å ´åˆã€ãƒ†ãƒŠãƒ³ãƒˆå†…ã®å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä»£ã‚ã£ã¦åŒæ„ã™ã‚‹ "Consent on behalf of your organization" ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

æ¨©é™ã«åŒæ„ã™ã‚‹ã«ã¯ **Accept** ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸåå‰ãŒè¡¨ç¤ºã•ã‚ŒãŸ Career Genie ã‹ã‚‰æˆåŠŸã—ãŸèªè¨¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šãã¾ã™ã€‚ã“ã‚Œã§ã€Career Genie ã®æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã§ãã¾ã™ï¼

ä»¥ä¸‹ã®ã‚ˆã†ãªé †ç•ªã§ä¼šè©±ã‚’é€²ã‚ã‚‹ã¨ã€å‹•ä½œç¢ºèªã«å½¹ç«‹ã¡ã¾ã™:

- ã“ã‚“ã«ã¡ã¯
- .NET ã®çµŒé¨“ãŒã‚ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚ .NET Developer Candidates ãƒªã‚¹ãƒˆã« Isaac Talbot ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- åŒã˜ãƒªã‚¹ãƒˆã« Anthony Ivanov ã‚’ Isaac ã¨ä¸€ç·’ã«è¿½åŠ ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- Python ã®çµŒé¨“ãŒã‚ã‚Šã€ã‚¹ãƒšã‚¤ãƒ³èªã‚’è©±ã›ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- ã„ã„ã§ã™ã­ï¼ Python Developer Candidates (Spanish speaking) ãƒªã‚¹ãƒˆã« Sara Folgueroles ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- 10å¹´ä»¥ä¸Šã®çµŒé¨“ãŒã‚ã‚‹å€™è£œè€…ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ
- äº†è§£ã§ã™ã€‚ .NET Developer Candidates ãƒªã‚¹ãƒˆã‹ã‚‰ Anthony ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„
- Talent ãƒªã‚¹ãƒˆã« Anthony Ivanov ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã—ã¦ãã ã•ã„
- åŒã˜ãƒªã‚¹ãƒˆã« Sara ã¨ä¸€ç·’ã« Pedro Armijo ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã—ã¦ãã ã•ã„
- ç§ã®ãƒªã‚¹ãƒˆã‚’ HR ã«é€ä¿¡ã—ã¦ãã ã•ã„

!!! tip "ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’ç¢ºèªã™ã‚‹"
    æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ãŸå¾Œã€å€™è£œè€…ãƒªã‚¹ãƒˆã®ãƒ¡ãƒ¼ãƒ«ãŒå±Šã„ã¦ã„ã‚‹ã‹ã€ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

![ä¸Šè¨˜ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒ•ãƒ­ãƒ¼ã«å¾“ã£ã¦å€™è£œè€…ã‚’æ¤œç´¢ã€ãƒªã‚¹ãƒˆã¸ã®è¿½åŠ ã€ãƒªã‚¹ãƒˆã‹ã‚‰ã®å‰Šé™¤ã€å€™è£œè€…ãƒªã‚¹ãƒˆã‚’ HR ã«ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã™ã‚‹ Career Genie ã®å…¨ä½“çš„ãªå‹•ä½œä½“é¨“ã‚’ç¤ºã™ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³](../../../assets/images/custom-engine-05/career-genie-full.gif)

<cc-end-step lab="bta5" exercise="4" step="5" />

---8<--- "ja/b-congratulations.md"

BTA5 - è¤‡é›‘ãªã‚¿ã‚¹ã‚¯å‡¦ç†ã®ãŸã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ãŒå®Œäº†ã—ã¾ã—ãŸï¼ ã•ã‚‰ã«æ¢ç´¢ã—ãŸã„å ´åˆã¯ã€ã“ã®ãƒ©ãƒœã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒ [Copilot Developer Camp repo](https://github.com/microsoft/copilot-camp/tree/main/src/custom-engine-agent/Lab05-Actions/CareerGenie){target=_blank} ã«ã¦ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚

ã“ã‚Œã§ **Build your own agent** ãƒ‘ã‚¹ã¯çµ‚äº†ã§ã™ï¼ Career Genie ã®æ§‹ç¯‰ã‚’æ¥½ã—ã‚“ã§ã„ãŸã ã‘ã¾ã—ãŸã‹ï¼Ÿ ã”æ„è¦‹ã‚„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚ ğŸ’œ

<cc-next label="Home" url="/" />

<!-- <cc-award path="Build" /> -->

<img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/custom-engine/teams-ai/05-actions" />