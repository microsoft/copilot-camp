---
search:
  exclude: true
---
# ãƒ©ãƒœ E1 â€“ ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã«åŸºã¥ã Gelocator ã‚²ãƒ¼ãƒ  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

ã“ã®ãƒ©ãƒœã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€šã—ã¦æä¾›ã•ã‚Œã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã¨è£œè¶³çŸ¥è­˜ã‚’ç”¨ã„ã¦ã€åŸºæœ¬çš„ãª declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ãªãŸã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€ä¸–ç•Œå„å›½ã®éƒ½å¸‚ã‚’æ¢ç´¢ã™ã‚‹æ‰‹åŠ©ã‘ã‚’ã™ã‚‹ã“ã¨ã§ã€ä»•äº‹ã®åˆé–“ã«æ¥½ã—ãå­¦ã³ãªãŒã‚‰ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§ãã‚‹ã‚ˆã†è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚æŠ½è±¡çš„ãªãƒ’ãƒ³ãƒˆã‚’æç¤ºã—ã€éƒ½å¸‚ã‚’å½“ã¦ã•ã›ã‚‹ä»•çµ„ã¿ã§ã€ä½¿ç”¨ã™ã‚‹ãƒ’ãƒ³ãƒˆãŒå¤šã„ã»ã©ç²å¾—ãƒã‚¤ãƒ³ãƒˆãŒå°‘ãªããªã‚Šã¾ã™ã€‚æœ€å¾Œã«ã€æœ€çµ‚ã‚¹ã‚³ã‚¢ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ãƒ©ãƒœã§å­¦ã¶ã“ã¨ï¼š

- Agents Toolkit ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ä½œæˆã™ã‚‹
- ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ ã‚’æ´»ç”¨ã—ã¦ geo locator ã‚²ãƒ¼ãƒ å‘ã‘ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹
- ã‚¢ãƒ—ãƒªã®å®Ÿè¡Œæ–¹æ³•ã¨ãƒ†ã‚¹ãƒˆæ–¹æ³•ã‚’å­¦ã¶
- ãƒœãƒ¼ãƒŠã‚¹æ¼”ç¿’ã¨ã—ã¦ã€ SharePoint Teams ã‚µã‚¤ãƒˆãŒå¿…è¦ã«ãªã‚Šã¾ã™

<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/VDhRFMH3Qbs" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>ã“ã®å‹•ç”»ã§ãƒ©ãƒœã®æ¦‚è¦ã‚’ç´ æ—©ãç¢ºèªã§ãã¾ã™ã€‚</div>
        </div>
    <div style="flex: 1; min-width: 0;">
  ---8<--- "ja/e-labs-prelude.md"
    </div>
</div>

## ã¯ã˜ã‚ã«

Declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¯ã€ Microsoft 365 Copilot ã®ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚¤ãƒ³ãƒ•ãƒ©ãŠã‚ˆã³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ´»ç”¨ã—ãªãŒã‚‰ã€ç‰¹å®šã®åˆ†é‡ã«ç„¦ç‚¹ã‚’åˆã‚ã›ãŸã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒæ–½ã•ã‚Œã¦ã„ã¾ã™ã€‚ç‰¹å®šã®æ¥­å‹™å†…å®¹ã‚„ãƒ†ãƒ¼ãƒã«é–¢ã™ã‚‹å°‚é–€å®¶ã¨ã—ã¦æ©Ÿèƒ½ã—ã€é€šå¸¸ã® Microsoft 365 Copilot ãƒãƒ£ãƒƒãƒˆã¨åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åˆ©ç”¨ã—ã¤ã¤ã€å°‚ã‚‰ãã®ã‚¿ã‚¹ã‚¯ã«æ³¨åŠ›ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

ã“ã®ãƒ©ãƒœã§ã¯ã€åˆã‚ã« Agents Toolkit ã‚’ç”¨ã„ã¦ãƒ„ãƒ¼ãƒ«ã«å‚™ãˆä»˜ã‘ã‚‰ã‚ŒãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€å–ã‚Šæ›ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚æ¬¡ã«ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ geo locator ã‚²ãƒ¼ãƒ ã«ç‰¹åŒ–ã™ã‚‹ã‚ˆã†ä¿®æ­£ã—ã¾ã™ã€‚

ã‚ãªãŸã® AI ã®ç›®çš„ã¯ã€ä»•äº‹ã®åˆé–“ã®æ¥½ã—ã„ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã ã‘ã§ãªãã€ä¸–ç•Œå„å›½ã®éƒ½å¸‚ã«ã¤ã„ã¦å­¦ã¶æ‰‹åŠ©ã‘ã‚’ã™ã‚‹ã“ã¨ã«ã‚ã‚Šã¾ã™ã€‚æŠ½è±¡çš„ãªãƒ’ãƒ³ãƒˆã‚’æç¤ºã—ã€éƒ½å¸‚ã‚’ç‰¹å®šã•ã›ã¾ã™ã€‚åˆ©ç”¨ã™ã‚‹ãƒ’ãƒ³ãƒˆãŒå¤šã„ã»ã©ç²å¾—ãƒã‚¤ãƒ³ãƒˆã¯æ¸›å°‘ã—ã€ã‚²ãƒ¼ãƒ çµ‚äº†æ™‚ã«æœ€çµ‚ã‚¹ã‚³ã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![The initial UI of the Geo Locator Game with a couple of guesses from the user.](../../assets/images/extend-m365-copilot-01/game.png)

ãƒœãƒ¼ãƒŠã‚¹ã¨ã—ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«ç§˜å¯†ã®æ—¥è¨˜ ğŸ•µğŸ½ ãŠã‚ˆã³ åœ°å›³ ğŸ—ºï¸ ã‚’å‚ç…§ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦è¿½åŠ ã—ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã•ã‚‰ãªã‚‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’æä¾›ã—ã¾ã™ã€‚

ã•ã‚ã€å§‹ã‚ã¾ã—ã‚‡ã† ğŸ’ªğŸ¼

## ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º 1ï¼š ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã™ã‚‹

ã‚¢ãƒ—ãƒªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆãŒåˆ†ã‹ã£ã¦ã„ã‚Œã°ã€ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ä½œæˆã§ãã¾ã™ã€‚ã—ã‹ã—ã€Agents Toolkit ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°ã€è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆã‚„ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤ã€å…¬é–‹ã¾ã§æ‰‹åŠ©ã‘ã—ã¦ãã‚Œã‚‹ãŸã‚ã€éå¸¸ã«ç°¡å˜ã§ã™ã€‚ãã“ã§ã€ã§ãã‚‹ã ã‘æ‰‹è»½ã«ã™ã‚‹ãŸã‚ã« Agents Toolkit ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼š Agents Toolkit ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

- Visual Studio Code ã®æ‹¡å¼µæ©Ÿèƒ½ ã‚¿ãƒ–ã«ç§»å‹•ã—ã€ **Microsoft 365 Agents Toolkit** ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚
- é¸æŠã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

<cc-end-step lab="e1a" exercise="1" step="1" />

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼š Agents Toolkit ã‚’ä½¿ã£ã¦ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹

Visual Studio Code ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®å·¦å´ 1ï¸âƒ£ ã«ã‚ã‚‹ Agents Toolkit æ‹¡å¼µæ©Ÿèƒ½ã«ç§»å‹•ã—ã€ **Create a New Agent/App** 2ï¸âƒ£ ã‚’é¸æŠã—ã¾ã™ã€‚

![The UI of the Agents Toolkit to start creating a new app with the 'Create a New Agent' button highlighted.](../../assets/images/extend-m365-copilot-01/atk-create-new-agent.png)

ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¨®é¡ä¸€è¦§ã‹ã‚‰ **Declarative Agent** ã‚’é¸æŠã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![The project types available when creating a new app with Agents Toolkit. Options include 'Agent', which is highlighted.](../../assets/images/extend-m365-copilot-01/atk-da.png)

æ¬¡ã«ã€åŸºæœ¬ã® declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ä½œæˆã™ã‚‹ã‹ã€API ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä»˜ãã®ã‚‚ã®ã‚’ä½œæˆã™ã‚‹ã‹ã®é¸æŠãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ **No Action** ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

![The Agents Toolkit app creation flow with the type of Declarative Agent with 'No plugin' selected.](../../assets/images/extend-m365-copilot-01/atk-no-action.png)

!!! tip "ãªãœã“ã“ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä»˜ãã«ã—ãªã„ã®ã‹ï¼Ÿ"
    æ¬¡ã®ãƒ©ãƒœã§ REST API ã‚’æ§‹ç¯‰ã—ã€ã“ã‚Œã‚’ä½¿ã£ã¦ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã‚‚å­¦ã³ã¾ã™ã€‚ã“ã®ãƒ‘ã‚¹ã®æ¬¡ã®ãƒ©ãƒœã§ã€ãã® API ã‚’ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦çµ±åˆã™ã‚‹æ‰‹é †ã‚’å­¦ã³ã¾ã™ã€‚ã“ã“ã§ã¯ã€å˜ã« declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ä½œæˆã™ã‚‹ã ã‘ã§ã™ã€‚åˆæ­©ã‹ã‚‰é€²ã‚ã¾ã—ã‚‡ã†ï¼

æ¬¡ã«ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¥åŠ›ã—ã¾ã™ã€‚

![The Agents Toolkit app creation flow with the prompt to provide a target path where to store the new app.](../../assets/images/extend-m365-copilot-01/atk-folder.png)

ç¶šã„ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã¨ã—ã¦ `Geo Locator Game` ã‚’å…¥åŠ›ã—ã€ Enter ã‚­ãƒ¼ã‚’æŠ¼ã—ã¾ã™ã€‚

![The Agents Toolkit app creation flow with the prompt to provide a name for the app.](../../assets/images/extend-m365-copilot-01/atk-app-name.png)

æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã«æ•°ç§’ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã€æ–°ãŸãª Visual Studio Code ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™ã€‚ã“ã‚ŒãŒä½œæ¥­ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚

![Visual Studio Code with the new app scaffolded and ready to be extendend and the README file on the screen.](../../assets/images/extend-m365-copilot-01/atk-scaffold.png)

ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼ åŸºæœ¬ã® declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ¬¡ã«ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ geo locator ã‚²ãƒ¼ãƒ ã‚¢ãƒ—ãƒªã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ãŸã‚ã€å«ã¾ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

<cc-end-step lab="e1a" exercise="1" step="2" />

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼š Agents Toolkit ã§ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š

å·¦å´ 1ï¸âƒ£ ã«ã‚ã‚‹ Agents Toolkit ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠã—ã€ã€ŒAccountsã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ **Sign in to Microsoft 365** 2ï¸âƒ£ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã‚ãªãŸã® Microsoft 365 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚

![The UI of Agents Toolkit to allow logging into a target Microsoft 365 tenant.](../../assets/images/extend-m365-copilot-01/atk-accounts.png)

ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã€ Microsoft 365 ã¸ã®ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒä¿ƒã•ã‚Œã¾ã™ã€‚ã€ŒYou are signed in now and close this pageã€ã¨è¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€ã€ŒCustom App Upload Enabledã€ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ãŒç·‘è‰²ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ç·‘è‰²ã§ãªã„å ´åˆã€ã‚ãªãŸã® ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¯ Teams ã‚¢ãƒ—ãƒªã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¨©é™ãŒãªã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã“ã®ãƒ©ãƒœã®ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º 1 ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€ã€ŒCopilot Access Enabledã€ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ãŒç·‘è‰²ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ç·‘è‰²ã§ãªã„å ´åˆã€ã‚ãªãŸã® ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¯ Copilot ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒä»˜ä¸ã•ã‚Œã¦ã„ãªã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ãƒ©ãƒœã‚’é€²ã‚ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚

![The UI of Agents Toolkit after logging in, when the checkmarks are green.](../../assets/images/extend-m365-copilot-01/atk-accounts-logged.png)

ã•ã‚ã€ã‚³ãƒ¼ãƒ‰ãƒ„ã‚¢ãƒ¼ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚

<cc-end-step lab="e1a" exercise="1" step="3" />

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼š ã‚¢ãƒ—ãƒªå†…ãƒ•ã‚¡ã‚¤ãƒ«ã®ç†è§£

åŸºæœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹æˆã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ï¼š

| Folder/File                          | Contents                                                                                                            |
| ------------------------------------ | ------------------------------------------------------------------------------------------------------------------- |
| `.vscode`                            | ãƒ‡ãƒãƒƒã‚°ç”¨ã® VSCode ãƒ•ã‚¡ã‚¤ãƒ«                                                                                        |
| `appPackage`                         | Teams ã‚¢ãƒ—ãƒªã®ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã€ãŠã‚ˆã³ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰API ä»•æ§˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ                          |
| `env`                                | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `.env.dev` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«                                                                    |
| `appPackage/color.png`               | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚´ç”»åƒ                                                                                           |
| `appPackage/outline.png`             | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚´ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ç”»åƒ                                                                              |
| `appPackage/declarativeAgent.json`   | declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®è¨­å®šãŠã‚ˆã³æ§‹æˆã‚’å®šç¾©                                                                        |
| `appPackage/instruction.txt`         | declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®å‹•ä½œã‚’å®šç¾©ã™ã‚‹å†…å®¹                                                                          |
| `appPackage/manifest.json`           | declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹ Teams ã‚¢ãƒ—ãƒªã®ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ                                             |
| `m365agent.yml`                      | ä¸»ãª Agents Toolkit ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŠã‚ˆã³æ§‹æˆã‚¹ãƒ†ãƒ¼ã‚¸ã®å®šç¾©ã¨ã„ã† 2 ã¤ã®ä¸»è¦ãªäº‹é …ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ |

ã“ã®ãƒ©ãƒœã§æ³¨ç›®ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ä¸»ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«å¿…è¦ãªã‚³ã‚¢æŒ‡ç¤ºãŒè¨˜è¼‰ã•ã‚ŒãŸ **appPackage/instruction.txt** ã§ã™ã€‚ã“ã‚Œã¯ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚Šã€è‡ªç„¶è¨€èªã§æŒ‡ç¤ºã‚’è¨˜è¿°ã§ãã¾ã™ã€‚

ã‚‚ã†ä¸€ã¤é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ **appPackage/declarativeAgent.json** ã§ã™ã€‚ã“ã“ã§ã¯ã€æ–°ãŸãª declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ Microsoft 365 Copilot ã«æ‹¡å¼µã™ã‚‹ãŸã‚ã®ã‚¹ã‚­ãƒ¼ãƒãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒãŒæŒã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ï¼š

- ã€Œ$schemaã€ï¼šã‚¹ã‚­ãƒ¼ãƒå‚ç…§ã§ã™
- ã€Œversionã€ï¼šã‚¹ã‚­ãƒ¼ãƒã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™
- ã€Œnameã€ï¼šdeclarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®åç§°ã‚’è¡¨ã—ã¦ã„ã¾ã™
- ã€Œdescriptionã€ï¼šèª¬æ˜ã‚’æä¾›ã—ã¾ã™
- ã€Œinstructionsã€ï¼šå‹•ä½œæŒ‡ç¤ºã‚’æ±ºå®šã™ã‚‹ãŸã‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’è¨˜è¼‰ã—ãŸ **instruction.txt** ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚ã“ã“ã«ã¯ã€æŒ‡ç¤ºã‚’ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦ç›´æ¥è¨˜å…¥ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€ã“ã®ãƒ©ãƒœã§ã¯ **instruction.txt** ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ã•ã‚‰ã«é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ `appPackage/manifest.json` ã§ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã€é–‹ç™ºè€…åã€ãã—ã¦ã‚¢ãƒ—ãƒªãŒåˆ©ç”¨ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¸ã®å‚ç…§ãªã©ã€é‡è¦ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã® manifest.json ãƒ•ã‚¡ã‚¤ãƒ«ã®æŠœç²‹ã¯ã€ã“ã‚Œã‚‰ã®è©³ç´°ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

```JSON
"copilotAgents": {
        "declarativeAgents": [            
            {
                "id": "declarativeAgent",
                "file": "declarativeAgent.json"
            }
        ]
    },
```  
ãƒ­ã‚´ç”»åƒãƒ•ã‚¡ã‚¤ãƒ« `color.png` ãŠã‚ˆã³ `outline.png` ã‚’ã€ã‚¢ãƒ—ãƒªã®ãƒ–ãƒ©ãƒ³ãƒ‰ã«åˆã‚ã›ã¦æ›´æ–°ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚æœ¬ãƒ©ãƒœã§ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’éš›ç«‹ãŸã›ã‚‹ãŸã‚ã« **color.png** ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤‰æ›´ã—ã¾ã™ã€‚

<cc-end-step lab="e1a" exercise="1" step="4" />

## ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º 2ï¼š ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã¨ã‚¢ã‚¤ã‚³ãƒ³ã®æ›´æ–°

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼š ã‚¢ã‚¤ã‚³ãƒ³ã¨ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®æ›´æ–°

ã¾ãšã¯ã€ãƒ­ã‚´ã®å·®ã—æ›¿ãˆã¨ã„ã†ç°¡å˜ãªä½œæ¥­ã‚’è¡Œã„ã¾ã™ã€‚[ã“ã¡ã‚‰](../../assets/images/extend-m365-copilot-01/color.png){target=_blank} ã®ç”»åƒã‚’ã‚³ãƒ”ãƒ¼ã—ã€ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® **appPackage** ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚‹åŒåã®ç”»åƒã¨ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® **appPackage/manifest.json** ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ **copilotAgents** ãƒãƒ¼ãƒ‰ã‚’æ¢ã—ã¾ã™ã€‚declarativeAgents é…åˆ—ã®æœ€åˆã®ã‚¨ãƒ³ãƒˆãƒªã® id å€¤ã‚’ `declarativeAgent` ã‹ã‚‰ `dcGeolocator` ã«æ›´æ–°ã—ã€ã“ã® ID ã‚’ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚‚ã®ã«ã—ã¾ã™ã€‚

<pre>
 "copilotAgents": {
        "declarativeAgents": [            
            {
                "id": "<b>dcGeolocator</b>",
                "file": "declarativeAgent.json"
            }
        ]
    },
</pre>

æ¬¡ã«ã€ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã® **appPackage/instruction.txt** ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ä»¥ä¸‹ã®æŒ‡ç¤ºå†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ã€æ—¢å­˜ã®å†…å®¹ã‚’ä¸Šæ›¸ãã—ã¦ãã ã•ã„ã€‚

```txt
System Role: You are the game host for a geo-location guessing game. Your goal is to provide the player with clues about a specific city and guide them through the game until they guess the correct answer. You will progressively offer more detailed clues if the player guesses incorrectly. You will also reference PDF files in special rounds to create a clever and immersive game experience.

Game play Instructions:
Game Introduction Prompt
Use the following prompt to welcome the player and explain the rules:
Welcome to the Geo Location Game! Iâ€™ll give you clues about a city, and your task is to guess the name of the city. After each wrong guess, Iâ€™ll give you a more detailed clue. The fewer clues you use, the more points you score! Letâ€™s get started. Hereâ€™s your first clue:
Clue Progression Prompts
Start with vague clues and become progressively specific if the player guesses incorrectly. Use the following structure:
Clue 1: Provide a general geographical clue about the city (e.g., continent, climate, latitude/longitude).
Clue 2: Offer a hint about the cityâ€™s landmarks or natural features (e.g., a famous monument, a river).
Clue 3: Give a historical or cultural clue about the city (e.g., famous events, cultural significance).
Clue 4: Offer a specific clue related to the cityâ€™s cuisine, local people, or industry.
Response Handling
After the playerâ€™s guess, respond accordingly:

If the player guesses correctly, say:
Thatâ€™s correct! Youâ€™ve guessed the city in [number of clues] clues and earned [score] points. Would you like to play another round?
If the guess is wrong, say:
Nice try! [followed by more clues]
PDF-Based Scenario
For special rounds, use a PDF file to provide clues from a historical document, traveler's diary, or ancient map:
This round is different! Iâ€™ve got a secret document to help us. Iâ€™ll read clues from this [historical map/travelerâ€™s diary] and guide you to guess the city. Hereâ€™s the first clue:
Reference the specific PDF to extract details: Do not provide the citations and also link to the document since its a secret document for generating the questions.
Traveler's Diary PDF,Historical Map PDF. Do not provide the citations and also link to the document since its a secret document for generating the questions.
Use emojis where necessary to have friendly tone. 
Scorekeeping System
Track how many clues the player uses and calculate points:

1 clue: 10 points
2 clues: 8 points
3 clues: 5 points
4 clues: 3 points
End of Game Prompt
After the player guesses the city or exhausts all clues, prompt:
Would you like to play another round, try a special challenge?

```  
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãŒä¼šè©±ã®ãã£ã‹ã‘ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã¨é–¢ã‚ã‚‹æ‰‹åŠ©ã‘ã‚’ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

!!! tip "ç‹¬è‡ªã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ **appPackage** å†…ã«å«ã‚ã‚‹å ´åˆ"
    **appPackage/declarativeAgent.json** å†…ã®ä»¥ä¸‹ã®è¡Œã«æ³¨ç›®ã—ã¦ãã ã•ã„ï¼š

    `"instructions": "$[file('instruction.txt')]",`

    ã“ã‚Œã«ã‚ˆã‚Šã€**instruction.txt** ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æŒ‡ç¤ºå†…å®¹ãŒå–ã‚Šè¾¼ã¾ã‚Œã¾ã™ã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã—ãŸã„å ´åˆã€**appPackage** ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã®ä»»æ„ã® JSON ãƒ•ã‚¡ã‚¤ãƒ«ã§ã“ã®æ‰‹æ³•ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚

<cc-end-step lab="e1a" exercise="2" step="1" />

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼š ä¼šè©±é–‹å§‹ä¿ƒã—ã®è¿½åŠ 

ä¼šè©±é–‹å§‹ä¿ƒã—ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¼šè©±é–‹å§‹ä¿ƒã—ã®åˆ©ç‚¹ï¼š

- **Engagement**ï¼šã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã‚„ã™ãã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®‰å¿ƒã—ã¦å‚åŠ ã§ãã‚‹ã‚ˆã†ä¿ƒã—ã¾ã™ã€‚
- **Context Setting**ï¼šä¼šè©±ã®ãƒˆãƒ¼ãƒ³ã‚„è©±é¡Œã‚’è¨­å®šã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ã‚ˆã†ã«é€²ã‚ã‚‹ã¹ãã‹ã‚’å°ãã¾ã™ã€‚
- **Efficiency**ï¼šæ˜ç¢ºãªç„¦ç‚¹ã‚’æŒã¤ã“ã¨ã§æ›–æ˜§ã•ã‚’æ¸›å°‘ã•ã›ã€å††æ»‘ãªä¼šè©±ã®é€²è¡Œã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
- **User Retention**ï¼šé©åˆ‡ã«è¨­è¨ˆã•ã‚ŒãŸé–‹å§‹ä¿ƒã—ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é–¢å¿ƒã‚’å¼•ãã€ç¹°ã‚Šè¿”ã—ã®åˆ©ç”¨ã‚’ä¿ƒã—ã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ« `declarativeAgent.json` ã‚’é–‹ãã€`instructions` ãƒãƒ¼ãƒ‰ã®ç›´å¾Œã«ã‚«ãƒ³ãƒ `,` ã‚’è¿½åŠ ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚

```JSON
 "conversation_starters": [
      { 
            "title": "Getting Started",
            "text":"I am ready to play the Geo Location Game! Give me a city to guess, and start with the first clue."          

         },
        {
            "title": "Ready for a Challenge",
            "text": "Let us try something different. Can we play a round using the travelers diary?"
        },
        { 
            "title": "Feeling More Adventurous",
            "text": "I am in the mood for a challenge! Can we play the game using the historical map? I want to see if I can figure out the city from those ancient clues."
        }
    ]
```

ã“ã‚Œã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¸ã®å¤‰æ›´ã¯å®Œäº†ã§ã™ã€‚ã•ã‚ã€ãƒ†ã‚¹ãƒˆã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚

<cc-end-step lab="e1a" exercise="2" step="2" />

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼š ã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ

ã‚¢ãƒ—ãƒªã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€Visual Studio Code å†…ã® `Agents Toolkit` æ‹¡å¼µæ©Ÿèƒ½ã«æˆ»ã£ã¦ãã ã•ã„ã€‚å·¦å´ã®ãƒšã‚¤ãƒ³ãŒé–‹ãã€ã€ŒLIFECYCLEã€å†…ã®ã€ŒProvisionã€ã‚’é¸æŠã—ã¾ã™ã€‚Agents Toolkit ã®åˆ©ä¾¿æ€§ãŒã“ã“ã«ç¾ã‚Œã¦ãŠã‚Šã€ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥ãŒéå¸¸ã«ç°¡å˜ã§ã™ã€‚

![The UI of Agents Toolkit highlighting the 'Provision' command under the 'Lifecycle' group of commands.](../../assets/images/extend-m365-copilot-01/atk-provision.png)

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€Agents Toolkit ãŒ `appPackage` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ zip ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã€ã‚ãªãŸã®ã‚¢ãƒ—ãƒª ã‚«ã‚¿ãƒ­ã‚°ã« declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

Microsoft 365 Copilot BizChat [https://microsoft365.com/copilot/](https://microsoft365.com/copilot/){target=_blank} ã‚’é–‹ãã€ã‚ãªãŸã®é–‹ç™ºè€…ãƒ†ãƒŠãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚

Copilot ã‚¢ãƒ—ãƒªãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã¨ã€å³å´ã®ãƒ‘ãƒãƒ«ã‹ã‚‰ **Geo Locator Game** ã‚’æ¢ã—ã¦ãã ã•ã„ã€‚

![The UI of Microsoft 365 Copilot with the list of agents on the right side and the 'Geo Locator Game' agent highlighted.](../../assets/images/extend-m365-copilot-01/launch-geo.png)

è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ãƒªã‚¹ãƒˆãŒé•·ããªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã€Œsee moreã€ã‚’é¸æŠã—ã¦ãƒªã‚¹ãƒˆã‚’å±•é–‹ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’æ¢ã—ã¦ãã ã•ã„ã€‚

èµ·å‹•å¾Œã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¨ã®é›†ä¸­ãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¡¨ç¤ºã•ã‚Œã€ä¼šè©±é–‹å§‹ä¿ƒã—ãŒä»¥ä¸‹ã®ã‚ˆã†ã«ç¤ºã•ã‚Œã¾ã™ï¼š

![The UI of Microsoft 365 Copilot when the 'Geo Locator Game' agent is selected. The image highlights the conversation starters.](../../assets/images/extend-m365-copilot-01/launched-geo.png)

ä¼šè©±é–‹å§‹ä¿ƒã—ã®ã„ãšã‚Œã‹ã‚’é¸æŠã™ã‚‹ã¨ã€ãã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒä½œæˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ãƒœãƒƒã‚¯ã‚¹ã«è‡ªå‹•å…¥åŠ›ã•ã‚Œã€ Enter ã‚­ãƒ¼ã‚’æŠ¼ã™ã ã‘ã§é€ä¿¡ã§ãã¾ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¯ã‚ãã¾ã§ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¨ã—ã¦å¾…æ©Ÿã—ã¦ã„ã¾ã™ ğŸŸ¢

ã‚²ãƒ¼ãƒ ã®ãƒ‡ãƒ¢ã‚‚ã”è¦§ãã ã•ã„ã€‚

![A video of the 'Geo Locator Game' in action with a user guessing a couple of cities and the agent showing the collected points.](../../assets/images/extend-m365-copilot-01/demo.gif)

<cc-end-step lab="e1a" exercise="2" step="3" />

## ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º 3ï¼š å‚ç…§ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ  (ãƒœãƒ¼ãƒŠã‚¹ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º)

åŒã˜ã‚²ãƒ¼ãƒ ã‚’ä½•åº¦ã‚‚ãƒ—ãƒ¬ã‚¤ã—ã¦ã„ã‚‹ã¨é£½ãã¦ã—ã¾ã„ã¾ã™ã€‚æ¥½ã—ãã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«ã¯ã€å®šæœŸçš„ã«æ›´æ–°ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«æ–°ãŸãªèƒ½åŠ›ã‚’ä»˜ä¸ã—ã¦ã€ã‚²ãƒ¼ãƒ ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã®é›£æ˜“åº¦ã‚’ä¸Šã’ã¾ã—ã‚‡ã†ã€‚å‰è¿°ã®ã¨ãŠã‚Šã€declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«ã¯ä¸»ã« 3 ã¤ã®æ©Ÿèƒ½ãŒã‚ã‚Šã€ãã®ã†ã¡ã® 1 ã¤ãŒ SharePoint ã‚µã‚¤ãƒˆã‚„ OneDrive ã¸ã®å‚ç…§ã§ã™ã€‚ã§ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«æ•°å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼š SharePoint ã¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

ã“ã® [ãƒªãƒ³ã‚¯](https://download-directory.github.io/?url=https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab01a-declarative-copilot/geo-locator-lab-sample/sharepoint-docs&filename=sharepoint-docs){target=_blank} ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€2 ã¤ã® PDF ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚ŒãŸ zip ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚

zip ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ 2 ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã€åŒã˜ãƒ†ãƒŠãƒ³ãƒˆå†…ã® SharePoint Teams ã‚µã‚¤ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª **Documents** ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ã‚²ãƒ¼ãƒ ã‚’ã‚ˆã‚Šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã«ã™ã‚‹ãŸã‚ã® **historical_map.pdf** ã¨ **travelers_diary** ã§ã™ã€‚

ã‚µã‚¤ãƒˆã®çµ¶å¯¾ URL ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚ä¾‹ï¼š `https://xyz.sharepoint.com/sites/contoso` ã€‚

> [!NOTE]
> ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å®Œå…¨ãªãƒ‘ã‚¹ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€SharePoint ã®ã€ŒCopy direct linkã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ŒDetailsã€ã‚’é¸æŠã—ã€ã€ŒPathã€ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚³ãƒ”ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã¿ã¾ã™ã€‚

<cc-end-step lab="e1a" exercise="3" step="1" />

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼š declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®æ›´æ–°

ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ« **.env.dev** ã‚’é–‹ãã€æ–°ãŸãªå¤‰æ•° "SP_SITE_URL" ã‚’ä½œæˆã—ã€SharePoint ã‚µã‚¤ãƒˆã®çµ¶å¯¾ URL ã‚’ãã®å€¤ã¨ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

æ¬¡ã«ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ **appPackage/declarativeAgent.json** ã‚’é–‹ãã€conversation_starters é…åˆ—ã®å¾Œã«ã‚«ãƒ³ãƒ `,` ã‚’è¿½åŠ ã—ã€ä»¥ä¸‹ã®æ–°ã—ã„é…åˆ—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦ã€ç‰¹å®šã® SharePoint ã‚µã‚¤ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®æ©Ÿèƒ½ã‚’æ‹¡å¼µã—ã¾ã™ã€‚

```JSON
 "capabilities": [
        {

            "name": "OneDriveAndSharePoint",
            "items_by_url": [
            {
                "url": "${{SP_SITE_URL}}"
            }
        ]
        }
    ]
```  
ã“ã‚Œã«ã‚ˆã‚Šã€declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã¯ã“ã® SharePoint ã‚µã‚¤ãƒˆå†…ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€ã‚²ãƒ¼ãƒ ã«åˆºæ¿€ãŒåŠ ãˆã‚‰ã‚Œã¾ã™ã€‚URL ã®è¿½åŠ ã«åˆ¶é™ã¯ã‚ã‚Šã¾ã›ã‚“ ğŸ’ªğŸ¼

<cc-end-step lab="e1a" exercise="3" step="2" />

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼š ã‚¢ãƒ—ãƒªãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰

æ¬¡ã«ã€**appPackage/manifest.json** ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ã‚¢ãƒ—ãƒªã® `version` ã‚’ "1.0.0" ã‹ã‚‰ "1.0.1" ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«å¤‰æ›´ãŒåæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

<cc-end-step lab="e1a" exercise="3" step="3" />

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼š ã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ

- ã‚¢ãƒ—ãƒªã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€Visual Studio Code å†…ã® `Agents Toolkit` æ‹¡å¼µæ©Ÿèƒ½ã«æˆ»ã£ã¦ãã ã•ã„ã€‚å·¦å´ã®ãƒšã‚¤ãƒ³ãŒé–‹ãã€ã€ŒLIFECYCLEã€å†…ã®ã€ŒProvisionã€ã‚’é¸æŠã—ã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚ŒãŸ declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚’ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã¦ã‚ãªãŸã®ã‚¢ãƒ—ãƒª ã‚«ã‚¿ãƒ­ã‚°ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

- é–‹ç™ºè€…ãƒ†ãƒŠãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸçŠ¶æ…‹ã§ã€Microsoft 365 Copilot BizChat [https://microsoft365.com/copilot/](https://microsoft365.com/copilot/){target=_blank} ã‚’é–‹ã„ã¦ãã ã•ã„ã€‚

- å†åº¦ **Geo Locator Game** ã‚’èµ·å‹•ã—ã¾ã™ã€‚

![The UI of Microsoft 365 Copilot when the 'Geo Locator Game' agent is selected. The image highlights the conversation starters.](../../assets/images/extend-m365-copilot-01/launched-geo.png)

ä»Šå›ã¯ã€æ—…è¡Œæ—¥è¨˜ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ãŸãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«æŒ‘æˆ¦ã—ã¦ãã ã•ã„ã€‚2 ç•ªç›®ã®ä¼šè©±é–‹å§‹ä¿ƒã—ã‚’é¸æŠã—ã¾ã™ã€‚

![The 'Geo Locator Game' when relying on the travel diary. The agent answers providing a reference to the travelers_diary.pdf document stored in SharePoint Online.](../../assets/images/extend-m365-copilot-01/traveller.gif)

ã“ã‚Œã§ã€ã‚ãªãŸã¯ã¾ã•ã« declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®é”äººã¨ãªã‚Šã¾ã—ãŸã€‚ã“ã¡ã‚‰ã®å‹•ç”»ã§è©³ç´°ã‚’ã”è¦§ãã ã•ã„ã€‚

 <div class="tinyVideo">
      <iframe src="//www.youtube.com/embed/QTP4PfXyyNk" frameborder="0" allowfullscreen></iframe>
      <div>Declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®ç´¹ä»‹</div>
    </div>

<cc-end-step lab="e1a" exercise="3" step="4" />

## ãƒªã‚½ãƒ¼ã‚¹
- [Declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/overview-declarative-copilot){target=_blank}
- [Declarative agent ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ ã‚¹ã‚­ãƒ¼ãƒ](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/declarative-agent-manifest){target=_blank}
- [ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ã‚¿ã‚¤ãƒ—](https://learn.microsoft.com/microsoftsearch/semantic-index-for-copilot#supported-content-types){target=_blank}
- [Declarative ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®æ©Ÿèƒ½](https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-capabilities-ids?tabs=explorer){target=_blank}
- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®æ¤œè¨¼ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](https://learn.microsoft.com/microsoftteams/platform/concepts/deploy-and-publish/appsource/prepare/review-copilot-validation-guidelines){target=_blank}


---8<--- "ja/e-congratulations.md"

ã‚²ãƒ¼ãƒ  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã®æ§‹ç¯‰ã€ãŠç–²ã‚Œæ§˜ã§ã—ãŸ ğŸ‰ ï¼ æ¬¡ã®ãƒ©ãƒœã§ã¯ã€REST API ã‚’ä½œæˆã—ã€ã“ã‚Œã‚’ä½¿ã£ã¦ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã€ãã—ã¦åˆ¥ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã«ã‚ˆã£ã¦è§£æ±ºã•ã‚ŒãŸå®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒŠãƒªã‚ªã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚éå¸¸ã«ã‚¨ã‚­ã‚µã‚¤ãƒ†ã‚£ãƒ³ã‚°ãªå†…å®¹ã§ã™ã€‚æ¬¡ã®ãƒ©ãƒœã«é€²ã‚€ã«ã¯ **Next** ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

<cc-next />

<img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/extend-m365-copilot/01a-geolocator" />

<!-- <script src="https://giscus.app/client.js"
        data-repo="microsoft/copilot-camp"
        data-repo-id="R_kgDOLMKPIA"
        data-mapping="number"
        data-term="548"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script> -->