---
search:
  exclude: true
---
# ãƒ©ãƒœ 09: Connected Agent - Zava ã®ãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè«‹æ±‚ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ã“ã®ãƒ©ãƒœã§ã¯ã€Zava Insurance å‘ã‘ã«ãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ã¾ãšã€ç¬æ™‚ã«ä¾¡æ ¼ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã‚’æä¾›ã™ã‚‹è«‹è² æ¥­è€…ã®ä¾¡æ ¼çŸ¥è­˜ã‚’çµ„ã¿è¾¼ã‚“ã  **Zava Procurement** ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚æ¬¡ã«ã€**Zava Procurement** ã¨ **Zava Claims Assistant**ï¼ˆãƒ©ãƒœ 08 ã§ä½œæˆï¼‰ã‚’æ¥ç¶šã™ã‚‹ **Zava Care** ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã—ã€ã‚¯ãƒ¬ãƒ¼ãƒ  ã‚¢ã‚¸ãƒ£ã‚¹ã‚¿ãƒ¼ãŒå˜ä¸€ã‹ã¤çµ±åˆã•ã‚ŒãŸå¯¾è©±å‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‹ã‚‰ã€çµ„ã¿è¾¼ã¿ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã¨ MCP ã‚µãƒ¼ãƒãƒ¼ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  ã‚¯ãƒ¬ãƒ¼ãƒ æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/coGNxTRBfyw" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>ã“ã®ãƒ“ãƒ‡ã‚ªã§ãƒ©ãƒœã®æ¦‚è¦ã‚’ã”è¦§ãã ã•ã„ã€‚</div>
            <div class="note-box">
            ğŸ“˜ <strong>Note:</strong>  Agents Toolkit ãŠã‚ˆã³ Microsoft 365 Copilot ã«ãŠã‘ã‚‹ Embedded knowledge ã¯ç¾åœ¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã™ã€‚
        </div>
    </div>
    <div style="flex: 1; min-width: 0;">
  ---8<--- "ja/e-labs-prelude.md"
    </div>
</div>

---

## Connected Agent ã¨ã¯

**Connected Agent** ã¯ AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¬¡ã®é€²åŒ–å½¢ã§ã‚ã‚Šã€è¤‡æ•°ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«é€£æºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã™ã¹ã¦ã‚’ 1 ã¤ã§è¡Œã†ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ä»£ã‚ã‚Šã«ã€Connected Agent ã¯ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã«æœ€é©åŒ–ã•ã‚ŒãŸå°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ãªãŒã‚‰ã€çµ±ä¸€ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’ç¶­æŒã—ã¾ã™ã€‚

> Declarative Agent ã«ãŠã‘ã‚‹ Connected Agent ã¯ç¾åœ¨ Public Preview ã§ã™ã€‚

### ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¸ã®åˆ©ç‚¹

ä¿é™ºé‡‘è«‹æ±‚å‡¦ç†ã®ã‚ˆã†ãªè¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ ã‚·ãƒŠãƒªã‚ªã«ãŠã„ã¦ã€Connected Agent ã¯ä»¥ä¸‹ã‚’æä¾›ã—ã¾ã™ã€‚

- å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹ **ãƒ‰ãƒ¡ã‚¤ãƒ³å°‚é–€çŸ¥è­˜**
- è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ ã‚½ãƒ¼ã‚¹ã«ã¾ãŸãŒã‚‹ **åŒ…æ‹¬çš„ãªã‚«ãƒãƒ¬ãƒƒã‚¸**
- é›†ä¸­å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¿½åŠ ã«ã‚ˆã‚‹ **åŠ¹ç‡çš„ãªã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®è¤‡é›‘ã•ã‚’æ„Ÿã˜ã•ã›ãªã„ **ä¸€è²«ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹**
- è²¬å‹™åˆ†é›¢ãŒæ˜ç¢ºãª **ä¿å®ˆã—ã‚„ã™ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**

## ğŸ¯ ãƒ©ãƒœã®ç›®çš„

ã“ã®ãƒ©ãƒœã‚’å®Œäº†ã™ã‚‹ã¨ã€æ¬¡ã®ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

1. è«‹è² æ¥­è€…ã®ä¾¡æ ¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ **Embedded knowledge ã‚’å‚™ãˆãŸ Declarative Agent ã‚’ä½œæˆ** ã™ã‚‹  
2. è¤‡æ•°ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èª¿æ•´ã™ã‚‹ **Connected Orchestrator Agent ã‚’æ§‹ç¯‰** ã™ã‚‹  
3. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  MCP ãƒ‡ãƒ¼ã‚¿ã¨ Embedded knowledge** ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹  
4. **ãƒ©ã‚¤ãƒ– ãƒ‡ãƒ¼ã‚¿ ã‚½ãƒ¼ã‚¹ã¨é™çš„ãƒŠãƒ¬ãƒƒã‚¸ ãƒ™ãƒ¼ã‚¹** ã‚’æ´»ç”¨ã™ã‚‹ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ AI ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç†è§£ã™ã‚‹  

---

## ğŸ“š å‰ææ¡ä»¶

ã“ã®ãƒ©ãƒœã‚’å§‹ã‚ã‚‹å‰ã«ã€æ¬¡ã‚’æº–å‚™ã—ã¦ãã ã•ã„ã€‚

- **ãƒ©ãƒœ 8 ã‚’å®Œäº†** ã—ã¦ã„ã‚‹ã“ã¨ï¼šMCP ã‚µãƒ¼ãƒãƒ¼çµ±åˆãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ Zava ã® Declarative Agent  
- **Microsoft 365 Agents Toolkit** ã®ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ç‰ˆï¼ˆEmbedded knowledge ç”¨ï¼‰  
- ãƒ†ã‚¹ãƒˆç”¨ã® **Microsoft 365 Copilot ãƒ©ã‚¤ã‚»ãƒ³ã‚¹** ãŒæœ‰åŠ¹  

---

## Exercise 1: Embedded knowledge ç”¨ã®æ–°ã—ã„ Declarative Agent ã‚’ä½œæˆã™ã‚‹

ã“ã®æ¼”ç¿’ã§ã¯ã€Microsoft 365 Agents Toolkit ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã«ä¿å­˜ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹æ–°ã—ã„ Declarative Agent ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

### Step 1: Microsoft 365 Agents Toolkit ã§æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆ

1. **VS Code** ã‚’é–‹ãã¾ã™  
2. ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ ãƒãƒ¼ï¼ˆå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ã® **Microsoft 365 Agents Toolkit** ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ Microsoft 365 é–‹ç™ºè€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¾ã™  
4. Agents Toolkit ãƒ‘ãƒãƒ«ã§ **"Create a New Agent/App"** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
5. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰ **"Declarative Agent"** ã‚’é¸æŠã—ã¾ã™  
6. ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰ **"No Action"** ã‚’é¸æŠã—ã¾ã™  
7. **Default folder** ã‚’é¸æŠã—ã¾ã™  
8. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã¨ã—ã¦ `Zava Procurement` ã¨å…¥åŠ›ã—ã¾ã™  

ã“ã‚Œã§æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæ–°ã—ã„ VS Code ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™ã€‚

  <cc-end-step lab="e9" exercise="1" step="1" />

### Step 2: ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ„ã¿è¾¼ã¿æ–¹æ³•ã‚’ç†è§£ã™ã‚‹

`appPackage` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ç§»å‹•ã—ã€ãã®å†…å®¹ã‚’ç¢ºèªã—ã¾ã™ã€‚`manifest.json`ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ©Ÿèƒ½ã‚’å®šç¾©ï¼‰ã‚„ `declarativeAgent.json`ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‹•ä½œã‚’æ§‹æˆï¼‰ãªã©ã€ä»¥å‰ã® Declarative Agent ã®ä½œæ¥­ã§è¦‹è¦šãˆã®ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç¢ºèªã§ãã¾ã™ã€‚

ã“ã“ã§ã®é‡è¦ãªè¿½åŠ è¦ç´ ã¯ `EmbeddedKnowledge` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã§ã™ã€‚ã“ã“ã« Zava ã®è«‹è² æ¥­è€…ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ç›´æ¥çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã€ãƒ©ã‚¤ãƒ– ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ã‚¯ã‚¨ãƒªã‚’è¡Œã‚ãšã«ç¬æ™‚ã«ä¾¡æ ¼ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

!!! note
    ãƒ†ã‚¹ãƒˆç”¨ã«æ©Ÿå¯†ãƒ©ãƒ™ãƒ«ã®ãªã„ã‚µãƒ³ãƒ—ãƒ« PDF ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ç‹¬è‡ªã®ãƒ•ã‚¡ã‚¤ãƒ«ã€ç‰¹ã« Office ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆã¯ã€ãƒ†ãƒŠãƒ³ãƒˆã§æ§‹æˆã•ã‚ŒãŸæ©Ÿå¯†ãƒ©ãƒ™ãƒ«ã‚’é †å®ˆã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

  <cc-end-step lab="e9" exercise="1" step="2" />

## Exercise 2: Zava ã®è«‹è² æ¥­è€…èª¿é”çŸ¥è­˜ç”¨ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ§‹æˆã™ã‚‹

### Step 1: ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

[ã“ã¡ã‚‰ã® URL](https://download-directory.github.io/?url=https://github.com/microsoft/copilot-camp/tree/main/docs/assets/docs/extend-m365-copilot-09&filename=EmbeddedKnowledge){target=_blank} ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°ã—ãä½œæˆã—ãŸ Declarative Agent ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `appPackage/EmbeddedKnowledge` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«å±•é–‹ã—ã¾ã™ã€‚

  <cc-end-step lab="e9" exercise="2" step="1" />

### Step 2: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã® ID ã¨èª¬æ˜ã‚’æ›´æ–°

`appPackage/declarativeAgent.json` ã®å†…å®¹ã‚’æ¬¡ã®æ§‹æˆã«ç½®ãæ›ãˆã¾ã™ã€‚

```json
{
    "$schema": "https://developer.microsoft.com/json-schemas/copilot/declarative-agent/v1.6/schema.json",
    "version": "v1.6",
    "name": "Zava Procurement",
    "description": "An agent that helps insurance adjusters streamline the search of the right procurement information by leveraging embedded knowledge from Zava approved partners' network of trusted contractors and service providers.",
    "instructions": "$[file('instruction.txt')]",
    "conversation_starters": [
        {
            "title": "Water damage restoration pricing",
            "text": "What are the rates for emergency water extraction and drying services?"
        },
        {
            "title": "Roof repair cost estimate",
            "text": "I need pricing for a 2,000 sq ft asphalt shingle roof replacement"
        },
        {
            "title": "Find cheapest option",
            "text": "What's the most cost-effective contractor for basic drywall repair?"
        },
        {
            "title": "Structural repair costs",
            "text": "What are the rates for foundation repair and structural work?"
        },
        {
            "title": "Claims inspection guidelines",
            "text": "What are the standard procedures for documenting water damage claims?"
        },
        {
            "title": "Emergency services availability",
            "text": "Which contractors offer 24/7 emergency response and what are their rates?"
        }
    ],
    "capabilities": [
        {
            "name": "EmbeddedKnowledge",
            "files": [
                {
                    "file": "EmbeddedKnowledge/Claims_Inspection_Guidelines.pdf"
                },
                {
                    "file": "EmbeddedKnowledge/Pacific Water Restoration-Pricing.pdf"
                },
                {
                    "file": "EmbeddedKnowledge/Thompson Roofing Solutions-Pricing.pdf"
                },
                {
                    "file": "EmbeddedKnowledge/Wilson General Contractors-Pricing.pdf"
                }
            ]
        }
    ]
}
```
  <cc-end-step lab="e9" exercise="2" step="2" />

### Step 3: è©³ç´°ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ

```txt
# Role and Expertise
You are a specialized procurement expert for Zava, an insurance claims management company. Your primary responsibility is to help insurance adjusters find the most appropriate and cost-effective contractors for property damage repairs and restoration work.

# Core Competencies
- Expert knowledge of construction and restoration pricing
- Deep familiarity with approved contractor networks
- Understanding of insurance claims processes and requirements
- Ability to compare pricing across multiple vendors
- Knowledge of industry-standard repair methodologies

# Available Resources
You have exclusive access to confidential pricing documents from Zava's network of pre-approved, vetted contractors:
- Pacific Water Restoration - Water damage and restoration services
- Thompson Roofing Solutions - Roofing repairs and replacements
- Wilson General Contractors - General construction and repair services
- Claims Inspection Guidelines - Standard procedures and requirements

These pricing documents contain valuable, proprietary information that gives you the ability to provide accurate cost estimates and vendor recommendations.

# Primary Responsibilities
1. Help adjusters quickly identify appropriate contractors for specific repair needs
2. Provide accurate pricing information based on the embedded contractor rate sheets
3. Compare pricing across multiple approved vendors when applicable
4. Ensure recommendations align with claims inspection guidelines
5. Offer insights on cost-effectiveness and vendor specializations

# Interaction Guidelines
- Always base your responses on the information in the embedded knowledge files
- When providing pricing, cite the specific contractor and reference their rate sheet
- If a request falls outside the scope of available contractor services, clearly state this
- Prioritize accuracy over speed - verify pricing details before responding
- Be concise and professional, as adjusters need quick, actionable information
- When comparing options, present information in a clear, organized format

# Constraints
- Only recommend contractors whose pricing documents you have access to
- Do not make up or estimate pricing that isn't documented in your knowledge base
- Stay focused on procurement and vendor selection - defer claims policy questions to appropriate resources
- Maintain confidentiality of pricing information - this is for internal Zava use only

# Response Format
When answering queries:
1. Acknowledge the specific need (e.g., type of repair, scope of work)
2. Identify relevant contractor(s) from your knowledge base
3. Provide specific pricing information with clear references
4. Offer comparative analysis when multiple options exist
5. Include any relevant guidelines or considerations from inspection standards
```
  <cc-end-step lab="e9" exercise="2" step="3" />

### Step 4: Teams ã‚¢ãƒ—ãƒª ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’æ›´æ–°

`appPackage/manifest.json` ã‚’é–‹ãã€Zava ã®ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã«æ›´æ–°ã—ã¾ã™ã€‚

```json
{
    "$schema": "https://developer.microsoft.com/en-us/json-schemas/teams/v1.23/MicrosoftTeams.schema.json",
    "manifestVersion": "1.23",
    "version": "1.0.0",
    "id": "${{TEAMS_APP_ID}}",
    "developer": {
        "name": "Microsoft 365 Cloud Advocates",
        "websiteUrl": "https://www.example.com",
        "privacyUrl": "https://www.example.com/privacy",
        "termsOfUseUrl": "https://www.example.com/termofuse"
    },
    "icons": {
        "color": "color.png",
        "outline": "outline.png"
    },
    "name": {
        "short": "Zava Procurement${{APP_NAME_SUFFIX}}",
        "full": "Full name for Zava Procurement"
    },
    "description": {
        "short": "Get procurement data from embedded knowledge with Zava Procurement",
        "full": "Zava Procurement helps you access procurement data seamlessly within Microsoft 365 apps by leveraging embedded knowledge."
    },
    "accentColor": "#FFFFFF",
    "composeExtensions": [],
    "permissions": [
        "identity",
        "messageTeamMembers"
    ],
    "copilotAgents": {
        "declarativeAgents": [            
            {
                "id": "declarativeAgent",
                "file": "declarativeAgent.json"
            }
        ]
    },
    "validDomains": []
}
```

<cc-end-step lab="e9" exercise="2" step="4" />

## Exercise 3: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçµ±åˆã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹

Declarative Agent ãŒãƒã‚¤ãƒ†ã‚£ãƒ– Embedded knowledge ã‹ã‚‰è«‹è² æ¥­è€…ã®ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã‚’æ­£å¸¸ã«å–å¾—ã§ãã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

### Step 1: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã„ãŸçŠ¶æ…‹ã® VS Code ã§:

1. **Microsoft 365 Agents Toolkit** ãƒ‘ãƒãƒ«ã‚’é–‹ãã¾ã™  
2. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã® **"Provision"** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
4. ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä½œæˆã•ã‚Œã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™  

<cc-end-step lab="e9" exercise="3" step="1" />

### Step 2: Microsoft 365 Copilot ã§ãƒ†ã‚¹ãƒˆ

1. ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’é–‹ãã€URL  https://m365.cloud.microsoft/chat/ ã§ Copilot ãƒãƒ£ãƒƒãƒˆã‚’é–‹ãã¾ã™  
2. å·¦å´ã® Agents ã§ **"Zava Procurement"** ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ¢ã—ã¾ã™  
3. ä»¥ä¸‹ã®ä¼šè©±ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚  

   - "What are the rates for emergency water extraction and drying services?"  
   - "Which contractors offer 24/7 emergency response and what are their rates?"  

  <cc-end-step lab="e9" exercise="3" step="2" />

---

## Exercise 4: Orchestrator Agent ã‚’æ§‹ç¯‰ã™ã‚‹

ã“ã®æ¼”ç¿’ã§ã¯ã€æ—¢å­˜ã® Zava ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’çµ±åˆã—ã€çµ±åˆã•ã‚ŒãŸè«‹æ±‚å‡¦ç†ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’æä¾›ã™ã‚‹ Connected Agent ã‚’ä½œæˆã—ã¾ã™ã€‚

### Step 1: Connected Agent ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ

1. **VS Code** ã‚’é–‹ãã¾ã™  
2. **Microsoft 365 Agents Toolkit** ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
3. Agents Toolkit ãƒ‘ãƒãƒ«ã§ **"Create a New Agent/App"** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
4. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰ **"Declarative Agent"** ã‚’é¸æŠã—ã¾ã™  
5. **"No Action"** ã‚’é¸æŠã—ã¾ã™  
6. æ—¢å®šã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å ´æ‰€ã‚’é¸æŠã—ã¾ã™  
7. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åã« `ZavaCare` ã¨å…¥åŠ›ã—ã¾ã™  

ã“ã‚Œã§æ–°ã—ã„ Declarative Agent ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã€æ—¢å­˜ã® 2 ã¤ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ¥ç¶šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

<cc-end-step lab="e9" exercise="4" step="1" />

### Step 2: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã® ID ã¨èª¬æ˜ã‚’æ›´æ–°

`appPackage/declarativeAgent.json` ã®å†…å®¹ã‚’ Zava ã®æ§‹æˆã«ç½®ãæ›ãˆã¾ã™ã€‚

```json
{
    "$schema": "https://developer.microsoft.com/json-schemas/copilot/declarative-agent/v1.6/schema.json",
    "version": "v1.6",
    "name": "ZavaCare",
    "description": "An intelligent agent that helps you manage and process insurance claims efficiently. Get instant answers about claim status, policy details, and streamline your claims workflow.",
    "instructions": "$[file('instruction.txt')]",
    "conversation_starters": [
        {
            "title": "End-to-End Claims Processing",
            "text": "For all moderate-severity roof or water damage claims , group them by city and propose contractor assignments using our approved network. For each claim, estimate the repair cost using current pricing for inspection, repair, and materials, and highlight where contractor selection changes the total cost by more than 15%."
        },
        {
            "title": "Contractor Recommendations for Emergency Roof Damage",
            "text": "Find all open roof damage claims that require emergency work, then recommend the top three approved contractors with 24/7 response coverage and include their latest pricing for tarping and temporary roof repairs. Prioritize by claim severity and estimated loss"
        },
        {
            "title": "Emergency Response Coordination",
            "text": "Find urgent claims needing immediate attention and match with emergency contractor pricing"
        }
    ]
}

```
<cc-end-step lab="e9" exercise="4" step="2" />

### Step 3: è©³ç´°ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ

`appPackage/instruction.txt` ã‚’æ›´æ–°ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç”¨ã®åŒ…æ‹¬çš„ãªã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```plaintext
You are the Zava Claims Assistant, an intelligent agent designed to help Zava insurance employees manage claims efficiently by coordinating with specialized worker agents and providing comprehensive claims management support.

    ## CORE CAPABILITIES

    You have access to two specialized connected agents:
    1. **Zava Claims** - Handles claims, inspections, contractors, and purchase orders
    2. **Zava Procurement** - Provides up-to-date contractor pricing information

    ## PRIMARY RESPONSIBILITIES

    ### Claims Management
    - Retrieve and display claim information and status
    - Provide comprehensive claim details including policy information, damage assessments, and timelines
    - Answer questions about claim history and current status
    - create, delete, update claims

    ### Inspection Operations
    - Retrieve existing inspection records and details
    - Create new inspection requests for claims
    - Update or delete inspections
    - Provide inspection status updates and findings
    - Coordinate inspection scheduling and documentation requirements

    ### Contractor Management
    - Access approved contractor lists for specific types of repairs
    - Retrieve contractor qualifications, certifications, and service areas
    - Provide contractor availability and emergency response capabilities
    - Get up-to-date pricing information for contractor services via the Zava Procurement agent

    ### Purchase Order Processing
    - Retrieve purchase order information and status
    - Access PO details including contractor assignments, costs, and timelines
    - Track PO approvals and completion status

    ## WORKFLOW GUIDELINES

    ### When Users Ask About Claims
    1. Use the Zava Claims agent to retrieve claim information
    2. Provide clear, organized summaries of claim status, coverage, and next steps
    3. If pricing questions arise, consult the Zava Procurement agent for current rates

    ### When Users Ask About Inspections
    1. **For retrieving inspections**: Use the Zava Claims agent to get inspection records
    2. **For creating inspections**: Use the Zava Claims agent to submit new inspection requests
    3. Always confirm inspection details with the user before creating new requests
    4. Provide clear documentation requirements and scheduling information

    ### When Users Ask About Contractors
    1. Use the Zava Claims agent to get approved contractor lists
    2. Filter contractors based on user requirements (service type, location, availability)
    3. **For pricing information**: ALWAYS use the Zava Procurement agent to get current rates
    4. Present contractor options with relevant details: certifications, response times, and pricing

    ### When Users Ask About Purchase Orders
    1. Use the Zava Claims agent to retrieve PO information
    2. Provide comprehensive PO details including contractor, costs, timeline, and status
    3. Clarify any approval requirements or pending actions

    ### When Users Ask About Pricing
    1. **ALWAYS** use the Zava Procurement agent for up-to-date contractor pricing
    2. Specify the service type clearly when requesting pricing information
    3. Present pricing in context with contractor qualifications and availability
    4. Compare pricing options when multiple contractors are available

    ## RESPONSE GUIDELINES

    **ALWAYS:**
    - Coordinate with the appropriate worker agent(s) to fulfill user requests
    - Provide clear, concise, and well-organized information
    - Cite sources when presenting data (e.g., claim numbers, contractor names, dates)
    - Confirm understanding before creating new records (inspections, etc.)
    - Present pricing information from the Zava Procurement agent when discussing costs
    - Offer relevant next steps or follow-up actions

    **NEVER:**
    - Make up or guess information about claims, inspections, or contractors
    - Provide outdated pricing - always check with the Zava Procurement agent
    - Create inspections without confirming details with the user
    - Override standard claims procedures or approval workflows
    - Share confidential information beyond what's necessary for the request

    ## COMMUNICATION STYLE

    - Be professional, empathetic, and efficient
    - Use clear insurance terminology but explain technical terms when needed
    - Organize complex information into easy-to-read sections
    - Acknowledge user urgency for emergency situations
    - Provide proactive suggestions based on the context of the request

    ## EXAMPLE INTERACTIONS

    **Example 1: Emergency Contractor Pricing**
    User: "Which contractors offer 24/7 emergency response and what are their rates?"
    Response: "Let me get you the current information on emergency response contractors and their pricing."
    [Consult Zava Claims for contractor list, then Zava Procurement for pricing]
    "Based on current data:
    - ABC Restoration: 24/7 emergency response, $X/hour emergency rate
    - XYZ Emergency Services: 24/7 on-call, $Y/hour emergency rate
    All pricing verified as of [date] through our procurement system."

    **Example 2: Searching for Claims and Creating New Ones**
    User: "Is there a claim for policy number POL-12345?"
    Response: "Let me search for any claims associated with policy POL-12345."
    [Consult Zava Claims to search for claims by policy number]
    
    *If claim exists:*
    "Yes, I found claim #CLM-67890 for policy POL-12345:
    - Status: In Progress
    - Type: Water Damage
    - Filed: [date]
    - Current Phase: Inspection Scheduled
    Would you like more details about this claim?"
    
    *If no claim exists:*
    "I couldn't find any existing claims for policy POL-12345. Would you like to create a new claim? I can help you with that. Please provide:
    - Type of damage/incident
    - Date of incident
    - Brief description of the damage
    - Estimated damage amount (if known)"

    ## PRIORITY HANDLING

    When users mention emergency situations or urgent claims:
    1. Acknowledge the urgency immediately
    2. Prioritize gathering critical information first
    3. Identify contractors with emergency response capabilities
    4. Provide fastest available options with clear timelines
```

<cc-end-step lab="e9" exercise="1" step="3" />

### Step 4: Connected Agent ã®æ©Ÿèƒ½ã‚’æ§‹æˆ

ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ 2 ã¤ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¥ç¶šã™ã‚‹ã«ã¯ã€ãã‚Œãã‚Œã® Microsoft 365 Title ID ã‚’ä½¿ç”¨ã—ã¦ãƒªãƒ³ã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

#### 4.1: Zava Claims Agent ID ã‚’å–å¾—

1. **ZavaClaims ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ï¼ˆãƒ©ãƒœ 08 ã§ä½œæˆï¼‰ã‚’ VS Code ã§é–‹ãã¾ã™  
2. `env/.env.dev` ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã¾ã™  
3. `M365_TITLE_ID` ã®å€¤ï¼ˆä¾‹: `12345678-abcd-1234-abcd-123456789abc`ï¼‰ã‚’æ¢ã—ã¾ã™  
4. ã“ã® GUID ã‚’ **Claims Agent ID** ã¨ã—ã¦å®‰å…¨ãªå ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™  

#### 4.2: Zava Procurement Agent ID ã‚’å–å¾—

1. **ZavaProcurement ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ï¼ˆæœ¬ãƒ©ãƒœã§ä½œæˆï¼‰ã‚’ VS Code ã§é–‹ãã¾ã™  
2. `env/.env.dev` ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã¾ã™  
3. `M365_TITLE_ID` ã®å€¤ã‚’æ¢ã—ã¾ã™  
4. ã“ã® GUID ã‚’ **Procurement Agent ID** ã¨ã—ã¦å®‰å…¨ãªå ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™  

#### 4.3: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ¥ç¶š

1. **ZavaCare ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ï¼ˆç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã«æˆ»ã‚Šã¾ã™  
2. `appPackage/declarativeAgent.json` ã‚’é–‹ãã¾ã™  
3. `conversation_starters` é…åˆ—ï¼ˆ`]` ã§çµ‚äº†ï¼‰ã‚’è¦‹ã¤ã‘ã¾ã™  
4. `conversation_starters` ã®é–‰ã˜æ‹¬å¼§ã®å¾Œã« **ã‚³ãƒ³ãƒ** ã‚’è¿½åŠ ã—ã¾ã™  
5. ç›´å¾Œã«æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ **è²¼ã‚Šä»˜ã‘** ã¾ã™  

```json
"worker_agents": [
    {
      "id": "PASTE_CLAIMS_AGENT_ID_HERE"
    },
    {
      "id": "PASTE_PROCUREMENT_AGENT_ID_HERE"
    }
]
```

6. **ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®ãæ›ãˆã¾ã™**  

   - `PASTE_CLAIMS_AGENT_ID_HERE` ã‚’ **Claims Agent ID** ã«ç½®ãæ›ãˆ  
   - `PASTE_PROCUREMENT_AGENT_ID_HERE` ã‚’ **Procurement Agent ID** ã«ç½®ãæ›ãˆ  

**æœ€çµ‚æ§‹é€ ã®ä¾‹:**  
```json
{
  "conversation_starters": [
    { "title": "...", "text": "..." }
  ],
  "worker_agents": [
    {
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
    },
    {
      "id": "9876fedc-ba09-8765-4321-abcdef123456"
    }
  ]
}
```

7. **ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜** ã™ã‚‹ã¨ã€ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ 2 ã¤ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¥ç¶šã•ã‚Œã¾ã™ï¼

<cc-end-step lab="e9" exercise="1" step="4" />

## Exercise 5: Connected Agent ã®ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹

### Step 1: Connected Agent ã‚’ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

1. VS Code ã§ **Microsoft 365 Agents Toolkit** ãƒ‘ãƒãƒ«ã‚’é–‹ãã¾ã™  
2. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã® **"Provision"** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™  
3. ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™  

<cc-end-step lab="e9" exercise="2" step="1" />

### Step 2: ãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹

1. ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’é–‹ãã€URL  https://m365.cloud.microsoft/chat/ ã§ Copilot ãƒãƒ£ãƒƒãƒˆã‚’é–‹ãã¾ã™  
2. å·¦å´ã® Agents ã§ **Zava Care** ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é–‹ãã€æ¬¡ã®ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚  

**è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ : Emergency Coordination**  
```
Find me all open roof damage claims along with contractor pricing insights.
```  

ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä¼šè©±ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚‚è©¦ã—ã¦ã€ãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå”èª¿ã®å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

<cc-end-step lab="e9" exercise="2" step="2" />

## ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ğŸ‰

Zava Insurance ã® Connected Agent ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã¾ã—ãŸï¼ã“ã‚Œã¯ã€å°‚é–€æ€§ã‚’æŒã¡ãªãŒã‚‰å”èª¿ã—ã€ç„¡é™ã«æ‹¡å¼µå¯èƒ½ãªã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º AI ã‚·ã‚¹ãƒ†ãƒ ã®æœªæ¥ã‚’ç¤ºã™å…ˆé€²çš„ãªãƒãƒ«ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®çµå®Ÿã§ã™ã€‚ ğŸš€


<img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/extend/09-connected-agent--ja" />