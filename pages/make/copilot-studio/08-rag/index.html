
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/pages/make/copilot-studio/08-rag/">
      
      
        <link rel="prev" href="../07-autonomous/">
      
      
        <link rel="next" href="../../sharepoint-agents/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Lab MCS8 - Integrating Azure AI Search for RAG - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-mcs8-integrating-azure-ai-search-for-rag" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab MCS8 - Integrating Azure AI Search for RAG
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../../ja/pages/make/copilot-studio/08-rag/" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Maker Path - Make your agent

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../extend-m365-copilot/" class="md-tabs__link">
          
  
  
  Extend - Build a declarative agent

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../custom-engine/" class="md-tabs__link">
          
  
  
  Build - Build a custom engine agent

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../beyond-agents/" class="md-tabs__link">
          
  
  
  Beyond Agents - AI concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../resources/" class="md-tabs__link">
        
  
  
    
  
  Resources

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Maker Path - Make your agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Maker Path - Make your agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB - Copilot Studio agent builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB1 - Agent builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS - Microsoft Copilot Studio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS0 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS1 - First agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS2 - Defining Topics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS3 - Defining Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS4 - Extending Microsoft 365 Copilot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS5 - Consuming a custom connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS6 - Consuming an MCP server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-autonomous/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS7 - Creating Autonomous Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab MCS8 - Integrating Azure AI Search for RAG
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab MCS8 - Integrating Azure AI Search for RAG
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1-setting-up-azure-ai-search-service" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Setting up Azure AI Search Service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-creating-and-populating-the-search-index" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Creating and Populating the Search Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-creating-the-rag-enabled-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Creating the RAG-Enabled Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-4-testing-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 4: Testing the agent
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA - SharePoint agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA1 - Build your first SharePoint agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA2 - Sharing SharePoint agents
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Extend - Build a declarative agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extend - Build a declarative agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E0 - Prerequisites and Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Declarative Agent Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Declarative Agent Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1 - Build a Detailed Declarative Agent using TypeSpec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1a - Build a game agent
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Build and Integrate API from scratch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Build and Integrate API from scratch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E2 - Build a Backend API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E3 - Add Declarative Agent and API Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E4 - Enhance API and Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/05-add-adaptive-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E5 - Add Adaptive Cards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6a - Add Entra ID Authentication (Toolkit)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Older Authentication Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Older Authentication Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6b - Add Entra ID Authentication (Manual Setup)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6c - Add Entra ID Authentication (Single Sign-on manual)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E7 - Add Copilot Connector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Build - Build a custom engine agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Build - Build a custom engine agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    M365 Agents SDK labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            M365 Agents SDK labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA0 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA1 - Prepare your agent in Azure AI Foundry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA2 - Build your first agent using M365 Agents SDK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA3 - Configure agent properties and test on Teams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA4 - Bring your agent to Copilot Chat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Beyond Agents - AI concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Beyond Agents - AI concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../beyond-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../beyond-agents/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Level 1 - Simple agent instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-mcs8-integrating-azure-ai-search-for-rag">Lab MCS8 - Integrating Azure AI Search for RAG</h1>
<p>In this lab, you are going to understand how to enhance your Microsoft Copilot Studio agents with Retrieval-Augmented Generation (RAG) capabilities using Azure AI Search. You'll create a specialized HR Knowledge Agent that can search through candidate documents using vector search, providing intelligent, contextual responses backed by your organization's data. This lab demonstrates how to create powerful AI agents that combine the conversational abilities of Copilot Studio with the advanced search capabilities of Azure AI Search.</p>
<div class="lab-intro-video">
    <!-- <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/placeholder" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>Get a quick overview of the lab in this video.</div>
    </div> -->
    <div style="flex: 1; min-width: 0;">

   <div class="floatwide">
   <div class="cc-lab-toc mcs-path">
     <img src="/copilot-camp/assets/images/path-icons/MCS-path-heading.png"></img>
     <div>
       <p>Do these labs if you want to build agents with Microsoft Copilot Studio</p>
       <ul>
         <li><a href="/copilot-camp/pages/make/copilot-studio/00-prerequisites/">MCS0 - Setup</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/01-first-agent/">MCS1 - First agent</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/02-topics/">MCS2 - Defining Topics</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/03-actions/">MCS3 - Defining Tools</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/04-extending-m365-copilot/">MCS4 - Extending Microsoft 365 Copilot</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/05-connectors/">MCS5 - Consuming a custom connector</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/06-mcp/">MCS6 - Consuming an MCP server</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/07-autonomous/">MCS7 - Creating Autonomous Agents</a></li>
         <li><a href="/copilot-camp/pages/make/copilot-studio/08-rag/">MCS8 - Integrating Azure AI Search for RAG</a></li>
       </ul>
     </div>
   </div>

   <script>
   (() => {

   // This script decorates the table of contents with a "you are here" indicator.
   const toc = document.getElementsByClassName('cc-lab-toc');
   for (const div of toc) {
       const lis = div.querySelectorAll('li');
       for (const li of lis) {
           const anchor = li.querySelector('a');
           if (location.href.includes(anchor.href)) {
               const span = document.createElement("span");
               span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
               li.appendChild(span);
           }
       }    
   }
   })();
   </script>


   <!-- 
     <div class="cc-mcs-lab-steps">
       <h4>Table of Contents</h4>
       <cc-table-of-contents />
     </div> -->
   </div>

    </div>
</div>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You should have experience with Microsoft Copilot Studio agent creation and basic Azure resource management.</p>
</div>
<p>In this lab you will learn:</p>
<ul>
<li>How to create and configure Azure AI Search service for knowledge indexing</li>
<li>How to import and vectorize PDF documents using Azure AI Search</li>
<li>How to integrate Azure AI Search as a knowledge source in Microsoft Copilot Studio</li>
<li>How to create agents that leverage RAG for intelligent document search</li>
</ul>
<details class="info">
<summary>What is Retrieval-Augmented Generation (RAG)?</summary>
<p>Retrieval-Augmented Generation (RAG) is a technique used in artificial intelligence to improve the quality of responses generated by language models. Here's a simple example to understand it better:</p>
<p>Imagine you have a smart assistant that can write answers to your questions. Sometimes, this assistant might not know everything it needs to give a great answer. To help with this, RAG lets the assistant look up information from a large collection of documents, similar to how you might search the internet for answers. After finding the relevant information, the assistant then uses this data to write a better, more accurate response.</p>
<p>So, RAG combines two steps:</p>
<ul>
<li><strong>Retrieval:</strong> Finding relevant information from a big pool of data.</li>
<li><strong>Generation:</strong> Using that information to create a detailed and accurate response.</li>
</ul>
<p>This way, RAG helps in providing more informed and useful answers, making it very effective for tasks like answering questions, writing articles, and assisting with research.</p>
<p><em>Learn more about the RAG by watching this Doodle to Code video!</em></p>
<p><iframe src="//www.youtube.com/embed/1k4XGgsqfTM?si=P6O9baroreDKizb" frameborder="0" allowfullscreen></iframe></p>
</details>
<details class="tip">
<summary>Benefits of using Vector Search</summary>
<p>Vector search is an advanced technique used to find information quickly and accurately based on its meaning rather than just matching exact words. Unlike traditional text-based search, which relies on exact keyword matches, vector search uses numeric vectors to find content that is similar to your query. This enables Vector search to handle:</p>
<ul>
<li><strong>Semantic or conceptual similarity:</strong> Matching concepts that are similar in meaning even if they use different words (e.g., "recruitment" and "hiring").</li>
<li><strong>Multilingual content:</strong> Finding equivalent content across different languages (e.g., "resume" in English and "curriculum vitae" in Latin).</li>
<li><strong>Multiple content types:</strong> Searching across different formats (e.g., text documents, and PDFs).</li>
</ul>
<p>Here is how vector search works:</p>
<ol>
<li><strong>Converting text to vectors:</strong> Text or documents are turned into a series of numbers (a vector) that captures the essence or meaning of that content. This is done using embedding models.</li>
<li><strong>Storing vectors:</strong> These vectors are stored in a special database (for example an Azure AI Search index) designed to handle them efficiently.</li>
<li><strong>Searching with vectors:</strong> When you search for something, your query is also converted into a vector. The search system then looks for vectors in the index that are close to your query vector in terms of meaning.</li>
</ol>
<p>For example, if you search for "software engineering skills," the system can find candidates with "programming expertise" or "development capabilities" even if they don't have the exact words from your search query.</p>
</details>
<h2 id="exercise-1-setting-up-azure-ai-search-service">Exercise 1: Setting up Azure AI Search Service</h2>
<p>In this exercise you are going to create and configure the Azure AI Search service that will serve as the knowledge foundation for your RAG-enabled agent.</p>
<h3 id="step-1-creating-azure-ai-search-service-resource">Step 1: Creating Azure AI Search Service Resource</h3>
<p>Before integrating with Microsoft Copilot Studio, you need to set up Azure AI Search service to store and index your documents.</p>
<p>Navigate to the <a href="https://portal.azure.com" target="_blank">Azure Portal</a> and create an Azure AI Search service:</p>
<ol>
<li>Select <strong>Create a resource</strong> and search for <code>Azure AI Search</code></li>
<li>Select the Azure AI Search service and then <strong>Create</strong></li>
<li>
<p>Fill out the following details and select <strong>Review + Create</strong>:</p>
<ul>
<li><strong>Subscription:</strong> Your Azure subscription</li>
<li><strong>Resource group:</strong> Select the same resource group used for other labs or create new one: <code>copilot-camp-rg</code></li>
<li><strong>Service name:</strong> A descriptive name such as <code>copilotcamp-ai-search</code> (must be globally unique)</li>
<li><strong>Location:</strong> Choose the same region as your other Azure resources, if any</li>
<li><strong>Pricing tier:</strong> Basic (sufficient for this lab)</li>
</ul>
</li>
</ol>
<p><img alt="The Azure portal interface showing the creation of a new Azure AI Search service with the required fields filled in including subscription, resource group, service name, location, and pricing tier." src="../../../../assets/images/make/copilot-studio-08/azure-search-01.png" /></p>
<p>Once your Azure AI Search service is created, navigate to your resource:</p>
<ol>
<li>In the <strong>Overview</strong> section, copy and save the <strong>URL</strong> (you'll need this later)</li>
<li>Navigate to <strong>Keys</strong> under <strong>Settings</strong>, in the left navigation bar, and copy the <strong>Primary admin key</strong> (you'll need this later)</li>
</ol>
<p>Both the URL and admin key will be required when connecting to Azure AI Search from within Microsoft Copilot Studio.</p>
<p><cc-end-step lab="mcs8" exercise="1" step="1" /></p>
<h3 id="step-2-creating-azure-storage-account">Step 2: Creating Azure Storage Account</h3>
<p>For storing the documents that will be indexed, you need an Azure Storage Account that will work with Azure AI Search.</p>
<p>In the Azure Portal, create a storage account:</p>
<ol>
<li>Select <strong>Create a resource</strong> and search for <code>Storage Account</code></li>
<li>Select Storage Account and then <strong>Create</strong></li>
<li>
<p>Fill out the following details and select <strong>Review + Create</strong>:</p>
<ul>
<li><strong>Subscription:</strong> Your Azure subscription</li>
<li><strong>Resource group:</strong> Select the same resource group as your Azure AI Search service</li>
<li><strong>Storage account name:</strong> A unique name such as <code>copilotcampstorage</code> (must be globally unique)</li>
<li><strong>Region:</strong> Same region as your Azure AI Search service</li>
<li><strong>Preferred storage type:</strong> Azure Blob Storage or Azure Data Lake Storage Gen 2</li>
<li><strong>Performance:</strong> Standard</li>
<li><strong>Redundancy:</strong> Locally redundant storage (LRS)</li>
</ul>
</li>
</ol>
<p><img alt="The Azure portal interface showing the creation of a storage account with the basic configuration including subscription, resource group, storage account name, region, performance, and redundancy settings." src="../../../../assets/images/make/copilot-studio-08/azure-storage-01.png" /></p>
<p>After the storage account is created, you'll use it to store the PDF documents before they are indexed by Azure AI Search.</p>
<p><cc-end-step lab="mcs8" exercise="1" step="2" /></p>
<h3 id="step-3-creating-text-embedding-model">Step 3: Creating Text Embedding Model</h3>
<p>To enable vector search capabilities, you need to create a text embedding model in Azure OpenAI that will convert documents and queries into vector representations.</p>
<p>If you don't already have an Azure OpenAI service instance, create one first:</p>
<ol>
<li>In the Azure Portal, select <strong>Create a resource</strong> and search for <code>Azure OpenAI</code></li>
<li>Select <strong>Azure OpenAI</strong> and then <strong>Create</strong></li>
<li>
<p>Fill out the following details:</p>
<ul>
<li><strong>Subscription:</strong> Your Azure subscription</li>
<li><strong>Resource group:</strong> Select the same resource group as your other resources</li>
<li><strong>Region:</strong> Choose a region that supports Azure OpenAI (such as East US, West Europe, or South Central US)</li>
<li><strong>Name:</strong> A descriptive name such as <code>copilotcamp-openai</code></li>
<li><strong>Pricing tier:</strong> Standard S0</li>
</ul>
</li>
<li>
<p>Move <strong>Next</strong> until the end of the creation wizard and then select <strong>Create</strong></p>
</li>
<li>Wait for the deployment to complete (this may take a few minutes)</li>
<li>Once created, navigate to your Azure OpenAI resource and note the endpoint URL for later use</li>
</ol>
<p>Now navigate to <a href="https://oai.azure.com/portal" target="_blank">Azure AI Foundry</a>. If it is the first time that you access the Azure AI Foundry portal, you might need to select the Azure OpenAI instance that you just created. Select the service instance and proceed with the creation of an embedding model going through the following steps:</p>
<ol>
<li>Select 1️⃣ <strong>Deployments</strong> from the left navigation</li>
<li>Select 2️⃣ <strong>+ Deploy model</strong></li>
<li>Select 3️⃣ <strong>Deploy base model</strong> to start deploying the model</li>
<li>In the popup dialog, search for model 4️⃣ <code>text-embedding-ada-002</code></li>
<li>Select 5️⃣ <strong>Confirm</strong> to start configuring the deployment</li>
<li>
<p>When the configuration dialog pops up, configure the following settings:</p>
<ul>
<li><strong>Deployment name:</strong> <code>text-embeddings</code> (remember this name)</li>
<li><strong>Deployment type:</strong> Standard</li>
<li><strong>Model version:</strong> 2 (Default)</li>
<li><strong>Content Filter:</strong> DefaultV2</li>
</ul>
</li>
<li>
<p>Select 6️⃣ <strong>Deploy</strong> and wait for the deployment to complete</p>
</li>
</ol>
<p><img alt="The Azure OpenAI deployment interface showing the creation of a text-embedding-ada-002 model with the specified configuration including model selection, version, deployment type, name, and content filter settings." src="../../../../assets/images/make/copilot-studio-08/openai-embedding-01.png" /></p>
<details class="info">
<summary>What does <code>text-embedding-ada-002</code> do?</summary>
<p>The <code>text-embedding-ada-002</code> model on Azure OpenAI converts text into numeric vectors that represent the meaning of the text. This allows for vector search, where instead of matching exact words, the search finds text with similar meanings. It works with multiple languages and different content types, making it useful for comparing text across languages and formats. When used with Azure AI Search, it improves search results by finding the most relevant and contextually accurate information. This model is perfect for creating advanced search solutions and applications that need to understand natural language.</p>
</details>
<p>The text embedding model is essential for converting both the indexed documents and user queries into vectors that can be compared for semantic similarity.</p>
<div class="admonition tip">
<p class="admonition-title">Tip: Handling quota limitations</p>
<p>If you see a "No quota available" message, you can either:</p>
<ol>
<li>Select a different region for your deployment</li>
<li>Request additional quota from the Azure OpenAI quota management page</li>
<li>Free up resources from other deployments you're not using</li>
</ol>
</div>
<p><cc-end-step lab="mcs8" exercise="1" step="3" /></p>
<h2 id="exercise-2-creating-and-populating-the-search-index">Exercise 2: Creating and Populating the Search Index</h2>
<p>In this exercise you will create a search index in Azure AI Search and populate it with candidate resume documents using the integrated vectorization feature.</p>
<h3 id="step-1-preparing-sample-documents">Step 1: Preparing Sample Documents</h3>
<p>For this lab, download the sample resume documents that will be indexed for search. Download <a href="https://github.com/microsoft/copilot-camp/raw/main/src/custom-engine-agent/Lab02-RAG/CareerGenie/fictitious_resumes.zip">fictitious_resumes.zip</a> and unzip the folder to access the PDF files.</p>
<p>These sample resumes contain diverse candidate profiles with information such as:</p>
<ul>
<li>Candidate names and contact information</li>
<li>Technical skills and expertise areas</li>
<li>Work experience and role history</li>
<li>Education backgrounds</li>
<li>Language proficiencies</li>
<li>Professional certifications</li>
</ul>
<p>Review the content of these files to understand the type of information that will be searchable through your RAG-enabled agent. Notice also that the documents are written in various languages. This will not be a problem for the <code>text-embedding-ada-002</code> model or for the vector index.</p>
<p><cc-end-step lab="mcs8" exercise="2" step="1" /></p>
<h3 id="step-2-uploading-sample-documents-in-the-storage-account">Step 2: Uploading sample documents in the Storage Account</h3>
<p>Using Azure AI Search, you'll create a vector index with your resume documents using the integrated vectorization feature.</p>
<p>Navigate to <a href="https://portal.azure.com/" target="_blank">Azure Portal</a> and access the Azure Storage Account service instance. </p>
<ol>
<li>Select the 1️⃣ <strong>Containers</strong> in the <strong>Data storage</strong> group of commands in the left navigation</li>
<li>Select the 2️⃣ <strong>+ Add container</strong> command in the command bar</li>
<li>Provide a name 3️⃣ for the new container, for example <code>resumes</code></li>
<li>Select 4️⃣ <strong>Create</strong> to create the actual container</li>
</ol>
<p><img alt="The Azure Storage Account service instance while showing the &quot;Containers&quot; page. There is a command to &quot;+ Add container&quot; highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-storage-02.png" /></p>
<p>Once the container has been created, you can upload the resume files following these steps:</p>
<ol>
<li>Select 1️⃣ <strong>Upload</strong></li>
<li>Drag and drop the resume files or select 2️⃣ <strong>Browse for files</strong> and select the resume files</li>
<li>Select the 3️⃣ <strong>Upload</strong> command and wait for the upload to complete</li>
</ol>
<p><img alt="The Azure Storage Account service instance while uploading files in target container. The commands to upload files are highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-storage-03.png" /></p>
<p><cc-end-step lab="mcs8" exercise="2" step="2" /></p>
<h3 id="step-3-populating-the-vector-index-with-integrated-vectorization">Step 3: Populating the Vector Index with Integrated Vectorization</h3>
<p>Once the resume files are uploaded go back to the home page of the <a href="https://portal.azure.com/" target="_blank">Azure Portal</a> and access the Azure AI Search service instance. Then select the <strong>Import data (new)</strong> command in the top command bar.</p>
<p><img alt="The Azure AI Search service instance overview page with basic information about the service instance. There is a command to &quot;Import data (new)&quot; highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-search-02.png" /></p>
<p>A new page will show up, through which you can configure the data import process. Select the <strong>Azure Blob Storage</strong> data source.</p>
<p><img alt="The Azure AI Search service instance page to start importing data. There is the &quot;Azure Blob Storage&quot; data source highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-search-03.png" /></p>
<p>Right after, select <strong>RAG</strong> as the scenario that you are targeting.</p>
<p><img alt="The Azure AI Search service instance page to choose the target scenario. There is the &quot;RAG&quot; scenario highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-search-04.png" /></p>
<p>Now configure the RAG scenario accordingly to the following settings:</p>
<ol>
<li>
<p><strong>Configure your Azure Blob Storage</strong> section:</p>
<ul>
<li><strong>Subscription:</strong> Your Azure subscription</li>
<li><strong>Storage account:</strong> the Storage Account you created before</li>
<li><strong>Blob container:</strong> the new container that you just created and where you uploaded the resume files, for example <code>resumes</code></li>
<li><strong>Blob folder:</strong> you can leave it blank, unless you created a folders structure in the storage container</li>
<li><strong>Parsing mode:</strong> use the <code>Default</code> value</li>
<li>Move <strong>Next</strong></li>
</ul>
</li>
<li>
<p><strong>Vectorize your text</strong> section:</p>
<ul>
<li><strong>Kind:</strong> Azure OpenAI</li>
<li><strong>Subscription:</strong> Your Azure subscription</li>
<li><strong>Azure Open AI service:</strong> select the Azure OpenAI instance that you created</li>
<li><strong>Model deployment:</strong> select the <code>text-embeddings</code> model that you just created</li>
<li><strong>Authentication type:</strong> the default <code>API Key</code> value is ok</li>
<li>Check the box to declare <code>I acknowledge that connecting to an Azure OpenAI service will incur additional costs to my account.</code></li>
<li>Move <strong>Next</strong></li>
</ul>
</li>
<li>
<p><strong>Vectorize your images</strong> section:</p>
<ul>
<li>In case you are willing to process images and text in images, you could configure specific settings</li>
<li>Here you can simply move <strong>Next</strong></li>
</ul>
</li>
<li>
<p><strong>Advanced ranking and relevancy</strong> section:</p>
<ul>
<li>If you like you can schedule recurring updates of the index, on a timer based model. You can also choose whether to use the semantic ranker to get results also based on semantic and not only on lexical analysis. Last but not least, you can configure the fields that will be created in the target index</li>
<li>Here you can simply move <strong>Next</strong></li>
</ul>
</li>
<li>
<p><strong>Review and create</strong> section:</p>
<ul>
<li>Here you can provide a prefix for the index, indexer, data source, and skillset that will be created. For example you can use the value <code>resumes</code></li>
<li>Review the settings and when you are ready select <strong>Create</strong> to create and feed the vector index</li>
</ul>
</li>
</ol>
<p><img alt="The Azure AI Search service instance page to recap the settings that will be applied when creating and feeding the vector index." src="../../../../assets/images/make/copilot-studio-08/azure-search-05.png" /></p>
<p>Once the vector index is created, a small dialog confirms the index creation and availability. Select the <strong>Start searching</strong> command to start playing with the index. In the search index page, you can simply select the <strong>Search</strong> command and see the output. Notice that, for every value in the index, you also have a <code>text_vector</code> field that contains the text vectorized using the <code>text-embedding-ada-002</code> model.</p>
<p><img alt="The Azure AI Search vector index showing the results of a get all query with the &quot;text_vector&quot; field highlighted." src="../../../../assets/images/make/copilot-studio-08/azure-search-06.png" /></p>
<p><cc-end-step lab="mcs8" exercise="2" step="3" /></p>
<h2 id="exercise-3-creating-the-rag-enabled-agent">Exercise 3: Creating the RAG-Enabled Agent</h2>
<p>In this exercise you will create a Microsoft Copilot Studio agent that leverages your Azure AI Search index to provide intelligent, document-backed responses about HR candidates.</p>
<h3 id="step-1-creating-the-hr-knowledge-agent">Step 1: Creating the HR Knowledge Agent</h3>
<p>Navigate to <a href="https://copilotstudio.microsoft.com" target="_blank">Microsoft Copilot Studio</a> and create a new agent optimized for knowledge search.</p>
<p>Using your work account, access your <code>Copilot Dev Camp</code> environment and create a new agent:</p>
<ol>
<li>Select <strong>Create</strong> → <strong>+ New agent</strong></li>
<li>Choose to manually <strong>Configure</strong> the agent</li>
</ol>
<p>Define your agent as follows:</p>
<ul>
<li><strong>Name</strong>: </li>
</ul>
<pre><code class="language-text">HR Knowledge Agent
</code></pre>
<ul>
<li><strong>Description</strong>: </li>
</ul>
<pre><code class="language-text">An intelligent HR assistant that searches through candidate documents using advanced 
vector search capabilities to provide contextual, document-backed responses
</code></pre>
<ul>
<li><strong>Instructions</strong>: </li>
</ul>
<pre><code class="language-text">You are an intelligent HR Knowledge Assistant specializing in candidate search. 
You have access to a comprehensive database of candidate resumes through advanced 
vector search capabilities.

When users ask questions, you should:

1. Search through the candidate database using semantic understanding
2. Provide detailed, accurate information based on the indexed documents
3. Always include proper citations and references to source documents
4. Explain your reasoning when matching candidates to requirements
5. Suggest alternative candidates when exact matches aren't available
6. Help users understand the skills and qualifications of different candidates

You excel at:
- Finding candidates with specific technical skills
- Matching language requirements with candidate profiles
- Identifying experience levels and career progression
- Understanding educational backgrounds and certifications
- Semantic search that goes beyond keyword matching

Always provide helpful, accurate information while respecting privacy and being professional.
</code></pre>
<p><img alt="The Microsoft Copilot Studio user experience when creating the &quot;HR Knowledge Agent&quot;. There are name, description, and instructions accordingly to the above suggeted settings." src="../../../../assets/images/make/copilot-studio-08/mcs-agent-01.png" /></p>
<p>Select <strong>Create</strong> to create your knowledge-enabled agent.</p>
<p>Once the agent is created, double check that the option to <strong>Use generative AI to determine how best to respond to users and events</strong> is enabled, in order to have the Generative AI based orchestrator configured. Also verify that <code>GPT-4o</code> model is selected in the <strong>Details</strong> panel of the agent's settings.</p>
<p><img alt="The Microsoft Copilot Studio settings for the new agent with Generative Orchestrator enabled and GPT-4o model highlighted." src="../../../../assets/images/make/copilot-studio-08/mcs-agent-02.png" /></p>
<p><cc-end-step lab="mcs8" exercise="3" step="1" /></p>
<h3 id="step-2-adding-azure-ai-search-as-knowledge-source">Step 2: Adding Azure AI Search as Knowledge Source</h3>
<p>Integrate your Azure AI Search index as a knowledge source for your agent.</p>
<p>Navigate to the <strong>Knowledge</strong> section and add your search index:</p>
<ol>
<li>Select <strong>+ Add knowledge</strong></li>
<li>From the <strong>Add knowledge</strong> dialog, select <strong>Featured</strong></li>
<li>Select <strong>Azure AI Search</strong></li>
</ol>
<p><img alt="The knowledge sources interface showing the option to add Azure AI Search as a featured knowledge source, with various other knowledge source options visible." src="../../../../assets/images/make/copilot-studio-08/mcs-add-knowledge-01.png" /></p>
<p>Configure the Azure AI Search connection:</p>
<ol>
<li>Select <strong>Create new connection</strong></li>
<li>
<p>Configure the authentication:</p>
<ul>
<li><strong>Authentication type:</strong> Access Key</li>
<li><strong>Azure AI Search Endpoint URL:</strong> Enter the URL you saved from your Azure AI Search service</li>
<li><strong>Azure AI Search Admin Key:</strong> Enter the admin key you copied earlier</li>
</ul>
</li>
<li>
<p>Select <strong>Create</strong> to establish the connection (a green checkmark confirms success)</p>
</li>
</ol>
<p><img alt="The Azure AI Search connection configuration dialog showing the authentication type selection, endpoint URL field, and admin key field for establishing the connection." src="../../../../assets/images/make/copilot-studio-08/mcs-add-knowledge-02.png" /></p>
<p>Complete the knowledge source configuration:</p>
<ol>
<li>Select the index with name <code>resumes</code> (or whatever else name you used when you created the index)</li>
<li>Select <strong>Add to agent</strong> to complete the integration</li>
</ol>
<p><img alt="The Azure AI Search connection configuration dialog allowing you to select the index to use as the new knowledge base in the agent." src="../../../../assets/images/make/copilot-studio-08/mcs-add-knowledge-03.png" /></p>
<p>The knowledge source will appear in your knowledge sources table with a status of "In progress" while Copilot Studio indexes the metadata. Wait for the status to change to "Ready" before proceeding.</p>
<p><cc-end-step lab="mcs8" exercise="3" step="2" /></p>
<h2 id="exercise-4-testing-the-agent">Exercise 4: Testing the agent</h2>
<p>In this exercise you will test your RAG-enabled agent and learn how to leverage different types of queries and use cases.</p>
<h3 id="step-1-testing-basic-knowledge-retrieval">Step 1: Testing Basic Knowledge Retrieval</h3>
<p>Start by testing fundamental search capabilities to ensure your agent can access and use the indexed knowledge effectively.</p>
<p>In the test panel, try these basic queries to validate the knowledge integration:</p>
<pre><code class="language-text">Hello! Can you help me find candidates with software engineering experience?
</code></pre>
<pre><code class="language-text">I'm looking for candidates who speak multiple languages. Can you help?
</code></pre>
<pre><code class="language-text">Show me candidates with machine learning or AI experience.
</code></pre>
<p><img alt="The test panel showing a conversation with the HR Knowledge Agent where the user asks about software engineering candidates and receives detailed responses with proper citations from the indexed documents." src="../../../../assets/images/make/copilot-studio-08/mcs-agent-03.png" /></p>
<p>Observe how the agent:</p>
<ul>
<li>Searches through the indexed documents using vector search</li>
<li>Provides relevant candidate information</li>
<li>Includes citations and references to source documents</li>
<li>Uses semantic understanding rather than exact keyword matching</li>
</ul>
<p><cc-end-step lab="mcs8" exercise="4" step="1" /></p>
<h3 id="step-2-testing-complex-query-scenarios">Step 2: Testing Complex Query Scenarios</h3>
<p>Test more sophisticated scenarios that demonstrate the power of RAG and vector search capabilities.</p>
<p>Try these advanced queries that combine multiple requirements:</p>
<pre><code class="language-text">Find candidates suitable for a senior role that requires 5+ years of Python 
experience and fluency in Spanish
</code></pre>
<pre><code class="language-text">I need someone with both frontend and backend development skills. 
Who would be good for a full-stack position?
</code></pre>
<pre><code class="language-text">Can you recommend candidates for a data science position that requires 
experience with machine learning frameworks?
</code></pre>
<pre><code class="language-text">Who has project management experience combined with technical skills?
</code></pre>
<p><img alt="The test panel showing complex multi-criteria queries with the agent providing detailed candidate recommendations, explanations of market insights, and suggestions for the best candidate to select." src="../../../../assets/images/make/copilot-studio-08/mcs-agent-04.png" /></p>
<p>Notice how the agent:</p>
<ul>
<li>Combines multiple search criteria intelligently</li>
<li>Explains the reasoning behind candidate recommendations</li>
<li>Suggests alternatives when exact matches aren't available</li>
<li>Provides context about candidate qualifications</li>
</ul>
<p><cc-end-step lab="mcs8" exercise="4" step="2" /></p>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">CONGRATULATIONS!</span></p>
<p>You have completed Lab MCS8 - Integrating Azure AI Search for RAG!</p>
<p>In this lab, you learned how to:</p>
<ul>
<li>Create and configure Azure AI Search service for enterprise knowledge management</li>
<li>Build vector search indexes using integrated vectorization with embedding models</li>
<li>Connect Azure AI Search as a knowledge source in Microsoft Copilot Studio</li>
<li>Design intelligent agents that leverage RAG for document-backed conversations</li>
<li>Test vector search with various query types</li>
</ul>
<p>Your HR Knowledge Agent now demonstrates the power of combining conversational AI with enterprise search capabilities, enabling users to interact with organizational knowledge using natural language while receiving accurate, well-cited responses based on actual documents.</p>
<p>The RAG patterns you've learned can be applied to many other scenarios including customer support knowledge bases, technical documentation, policy and procedure guides, and any domain where users need to search and understand large document collections through conversational interfaces.</p>
<!-- <a href="../09-agent-to-agent">Start here</a> with Lab MCS9, to learn how to create agent to agent solutions in Copilot Studio.
<cc-next />  -->

<!-- <cc-award path="Make" /> -->

<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/make/copilot-studio/08-rag" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>