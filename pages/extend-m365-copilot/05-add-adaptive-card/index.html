
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/pages/extend-m365-copilot/05-add-adaptive-card/">
      
      
        <link rel="prev" href="../04-enhance-api-plugin/">
      
      
        <link rel="next" href="../06a-add-authentication-ttk/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Lab E5 - Add Adaptive Cards - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-e5-add-adaptive-cards" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab E5 - Add Adaptive Cards
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ja/pages/extend-m365-copilot/05-add-adaptive-card/" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../make/" class="md-tabs__link">
          
  
  
  Maker Path - Make your agent

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Extend - Build a declarative agent

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  
  Build - Build a custom engine agent

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../copilot-instructions/" class="md-tabs__link">
          
  
  
  Prompt engineering

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resources/" class="md-tabs__link">
        
  
  
    
  
  Resources

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Maker Path - Make your agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Maker Path - Make your agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB - Copilot Studio agent builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB1 - Agent builder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS - Microsoft Copilot Studio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS0 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS1 - First agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS2 - Defining Topics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS3 - Defining Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS4 - Extending Microsoft 365 Copilot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS5 - Consuming a custom connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS6 - Consuming an MCP server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/07-autonomous/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS7 - Creating Autonomous Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA - SharePoint agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA1 - Build your first SharePoint agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MSA2 - Sharing SharePoint agents
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Extend - Build a declarative agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extend - Build a declarative agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E0 - Prerequisites and Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Declarative Agent Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Declarative Agent Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1 - Build a Detailed Declarative Agent using TypeSpec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1a - Build a game agent
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Build and Integrate API from scratch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Build and Integrate API from scratch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E2 - Build a Backend API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E3 - Add Declarative Agent and API Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E4 - Enhance API and Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab E5 - Add Adaptive Cards
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab E5 - Add Adaptive Cards
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1-create-and-test-a-simple-adaptive-card" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Create and test a simple Adaptive Card
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-update-the-plugin-manifest" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Update the plugin manifest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-test-the-plugin-in-copilot" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Test the plugin in Copilot
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6a - Add Entra ID Authentication (Toolkit)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Older Authentication Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Older Authentication Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6b - Add Entra ID Authentication (Manual Setup)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E6c - Add Entra ID Authentication (Single Sign-on manual)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E7 - Add Copilot Connector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Build - Build a custom engine agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Build - Build a custom engine agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    M365 Agents SDK labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            M365 Agents SDK labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA0 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA1 - Prepare your agent in Azure AI Foundry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA2 - Build your first agent using M365 Agents SDK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA3 - Configure agent properties and test on Teams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA4 - Bring your agent to Copilot Chat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Teams AI library labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Teams AI library labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA0 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/01-custom-engine-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA1 - First custom engine agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/02-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA2 - Index your data in Azure AI Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/03-powered-by-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA3 - Enhance user experience
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/04-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA4 - Add single sign on authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/05-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA5 - Add actions to handle complex tasks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prompt engineering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Prompt engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../copilot-instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../copilot-instructions/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Level 1 - Simple agent instructions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-e5-add-adaptive-cards">Lab E5 - Add adaptive cards</h1>
<p>In this lab you will further enhance the response from Microsoft 365 Copilot from text to rich cards using Adaptive Cards. </p>
<p>In this lab you will learn:</p>
<ul>
<li>What are Adaptive Cards</li>
<li>How to create and test an Adaptive Card</li>
<li>How to update Microsoft 365 Copilot responses to use Adaptive Cards for rich content</li>
</ul>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/9kb9whCKey4" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>Get a quick overview of the lab in this video.</div>
            <div class="note-box">
            📘 <strong>Note:</strong> This lab builds on the previous one, Lab E4. You should be able to continue working in the same folder for labs E2-E6, but solution folders have been provided for your reference.
    The finished solution for this lab is in the <a  src="https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab05-add-adaptive-cards/trey-research-lab05-END" target="_blank">/src/extend-m365-copilot/path-e-lab05-add-adaptive-cards/trey-research-lab05-END</a>
        </div>
    </div>
    <div style="flex: 1; min-width: 0;">

  <div class="floatwide">
  <div class="cc-lab-toc e-path">
      <img src="/copilot-camp/assets/images/path-icons/E-path-heading.png"></img>
      <div>
          <p>Do these labs if you want to build a Declarative agent where Microsoft 365 provides the AI model and
              orchestration</p>
          <ul id="lab-toc">
              <li><strong><a href="/copilot-camp/pages/extend-m365-copilot/index">🏁 Welcome</a></strong></li>
              <li><strong>🔧 Set up</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/00-prerequisites">Lab E0 - Setup</a></li>
                  </ul>
              </li>
              <li><strong>🧰 Declarative agent fundamentals</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01-typespec-declarative-agent"> Lab E1 - Build a Detailed Declarative Agent</a>
                      </li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01a-geolocator"> Lab E1a - Geo locator game</a></li>
                  </ul>
              </li>
              <li><strong>🛠️ Build and integrate API from scratch</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/02-build-the-api">Lab E2 - Build an API</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/03-add-declarative-agent"> Lab E3 - Add Declarative Agent + API</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/04-enhance-api-plugin"> Lab E4 - Enhance API + Plugin</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/05-add-adaptive-card">Lab E5 - Add Adaptive Cards</a></li>
                  </ul>
              </li>
              <li><strong>🔐 Authentication</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06a-add-authentication-ttk"> Lab E6a - Toolkit</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06b-add-authentication"> Lab E6b - Manual</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06c-add-sso"> Lab E6c - SSO</a></li>
                  </ul>
              </li>
              <li><strong>🔌 Integration</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/07-add-graphconnector"> Lab EB - Add Graph Connector</a></li>
                  </ul>
              </li>
          </ul>
      </div>
  </div>

  <script>
  (() => {

  // This script decorates the table of contents with a "you are here" indicator.
  const toc = document.getElementsByClassName('cc-lab-toc');
  for (const div of toc) {
      const lis = div.querySelectorAll('li');
      for (const li of lis) {
          const anchor = li.querySelector('a');
          if (anchor) {            // Get the last segment of the current URL path
              const currentPath = window.location.pathname.slice(0, -1).split('/').pop();

              // Get the last segment of the link path
              const linkPath = anchor.getAttribute('href').split('/').pop().replace('.md', '');

              // Compare the last segments
              if (currentPath === linkPath) {
                  const existingSpan = document.querySelector('span.you-are-here');
                  if (existingSpan) {
                      existingSpan.remove();
                  }
                  const span = document.createElement("span");
                  span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
                  span.className = "you-are-here";
                  li.appendChild(span);
              }
          }
      }
  }
  })();
  </script>
  </div>

    </div>
</div>

<h2 id="introduction">Introduction</h2>
<details>
<summary>What are Adaptive Cards?</summary>

Adaptive Cards are platform-independent UI snippets authored in JSON that can be exchanged between apps and services. Once delivered to an app, the JSON transforms into native UI that automatically adapts to its environment. This enables the design and integration of lightweight UI across major platforms and frameworks.
    <div class="video">
      <iframe src="//www.youtube.com/embed/pYe2NqKhJoM" frameborder="0" allowfullscreen></iframe>
      <div>Adaptive cards are everywhere</div>
    </div>
</details>

<h2 id="exercise-1-create-and-test-a-simple-adaptive-card">Exercise 1: Create and test a simple Adaptive Card</h2>
<p>Let's dive in and discover how fun it is to create adaptive cards.</p>
<h3 id="step-1-define-your-adaptive-card-in-json">Step 1: Define Your Adaptive Card in JSON</h3>
<p>Here is an adaptive card in JSON. Begin by copying it to your clipboard.</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;AdaptiveCard&quot;,
  &quot;body&quot;: [
    {
      &quot;type&quot;: &quot;TextBlock&quot;,
      &quot;text&quot;: &quot;Hello, Adaptive Cards!&quot;,
      &quot;size&quot;: &quot;large&quot;,
      &quot;weight&quot;: &quot;bolder&quot;
    }
  ],
  &quot;actions&quot;: [
    {
      &quot;type&quot;: &quot;Action.OpenUrl&quot;,
      &quot;title&quot;: &quot;Click me&quot;,
      &quot;url&quot;:&quot;https://www.contoso.com&quot;
    }
  ],
  &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
  &quot;version&quot;: &quot;1.3&quot;
}
</code></pre>
<p>This JSON defines a simple Adaptive Card with a text block and a button.</p>
<p><cc-end-step lab="e5" exercise="1" step="1" /></p>
<h3 id="step-2-test-your-adaptive-card">Step 2: Test Your Adaptive Card</h3>
<p>To test your Adaptive Card, you can use the <a href="https://adaptivecards.io/designer/" target="_blank">Adaptive Cards Designer</a>.</p>
<ol>
<li>Open the <a href="https://adaptivecards.io/designer/" target="_blank">Adaptive Cards Designer</a>  .</li>
<li>Copy the JSON content from your <code>adaptiveCard.json</code> file.</li>
<li>Paste the JSON content into the "Card Payload Editor" section on the lower part of the designer.</li>
<li>You will see a live preview of your Adaptive Card on the upper part of the designer.</li>
</ol>
<p>Congrats! You are now fully skilled to develop Adaptive cards for your plugin!</p>
<p><cc-end-step lab="e5" exercise="1" step="2" /></p>
<h2 id="exercise-2-update-the-plugin-manifest">Exercise 2: Update the plugin manifest</h2>
<p>We are going to update the plugin manifest file called <strong>trey-plugin.json</strong> in the <strong>appPackage</strong> folder with a response template using adaptive cards. We will find each function or API call and update the templates.</p>
<h3 id="step-1-add-an-adaptive-card-for-get-apiconsultants-requests">Step 1: Add an adaptive card for GET /api/consultants requests</h3>
<ul>
<li>Locate the function <strong>getConsultants</strong> and after the <code>properties</code> node add below <code>static_template</code> node.</li>
</ul>
<pre><code class="language-JSON"> &quot;static_template&quot;: {
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${name}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${email}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${phone}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${consultantPhotoUrl}&quot;,
                            &quot;altText&quot;: &quot;${name}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              }   

            ]
 }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="1" /></p>
<h3 id="step-2-add-an-adaptive-card-for-get-apime-requests">Step 2: Add an adaptive card for GET /api/me requests</h3>
<ul>
<li>Locate the function <strong>getUserInformation</strong> and after the <code>properties</code> node add below <code>static_template</code> node.</li>
</ul>
<pre><code class="language-json">
  &quot;static_template&quot;:{
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${name}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${email}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${phone}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${consultantPhotoUrl}&quot;,
                            &quot;altText&quot;: &quot;${name}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              }   

            ]
  }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="2" /></p>
<h3 id="step-3-add-an-adaptive-card-for-get-apiprojects-requests">Step 3: Add an adaptive card for GET /api/projects requests</h3>
<ul>
<li>Locate the function <strong>getProjects</strong> and after the <code>properties</code> node add below <code>static_template</code> node.</li>
</ul>
<pre><code class="language-JSON">  &quot;static_template&quot;: {
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${description}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${description}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientName}&quot;,
                            &quot;weight&quot;: &quot;Bolder&quot;,
                            &quot;size&quot;: &quot;Large&quot;,
                            &quot;spacing&quot;: &quot;Medium&quot;,
                            &quot;wrap&quot;: true,
                            &quot;maxLines&quot;: 3
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientContact}&quot;,
                            &quot;size&quot;: &quot;small&quot;,
                            &quot;wrap&quot;: true
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientEmail}&quot;,
                            &quot;size&quot;: &quot;small&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${location.mapUrl}&quot;,
                            &quot;altText&quot;: &quot;${location.street}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Metrics&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;spacing&quot;: &quot;Medium&quot;,
                &quot;horizontalAlignment&quot;: &quot;Center&quot;,
                &quot;separator&quot;: true
              },
              {
                &quot;type&quot;: &quot;ColumnSet&quot;,
                &quot;columns&quot;: [
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Forecast This Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${forecastThisMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  },
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Forecast Next Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${forecastNextMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;ColumnSet&quot;,
                &quot;columns&quot;: [
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Delivered Last Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${deliveredLastMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  },
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Delivered This Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${deliveredThisMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  }
                ]
              }
            ],
            &quot;actions&quot;: [
              {
                &quot;type&quot;: &quot;Action.OpenUrl&quot;,
                &quot;title&quot;: &quot;View map&quot;,
                &quot;url&quot;: &quot;${location.mapUrl}&quot;
              }
            ]
  }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="3" /></p>
<h3 id="step-4-add-an-adaptive-card-for-post-apibillhours-requests">Step 4: Add an adaptive card for POST /api/billHours requests</h3>
<ul>
<li>Locate the function <strong>postBillhours</strong> and after the <code>properties</code> node add below <code>static_template</code> node.</li>
</ul>
<pre><code class="language-JSON">&quot;static_template&quot;: {
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Status Summary&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;separator&quot;: true
              },              
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Client Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.clientName, results.clientName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Project Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.projectName, results.projectName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },  
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Remaining Forecast&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.remainingForecast, results.remainingForecast, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },           
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Message&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.message, results.message, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              }
            ]
          }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="4" /></p>
<h3 id="step-5-add-an-adaptive-card-for-post-apiassignconsultant-requests">Step 5: Add an adaptive card for POST /api/assignConsultant requests</h3>
<ul>
<li>Locate the function <strong>postAssignConsultant</strong> and after the <code>properties</code> node add below <code>static_template</code> node.</li>
</ul>
<pre><code class="language-JSON"> &quot;static_template&quot;: {
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Overview&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;separator&quot;: true,
                &quot;spacing&quot;: &quot;Medium&quot;
              },              
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Client Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.clientName, results.clientName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Project Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.projectName, results.projectName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Consultant Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.consultantName, results.consultantName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Remaining Forecast&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.remainingForecast, results.remainingForecast, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Message&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.message, results.message, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              }            
            ]          
          }

</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="5" /></p>
<h2 id="exercise-3-test-the-plugin-in-copilot">Exercise 3: Test the plugin in Copilot</h2>
<p>Before you test the application, update the manifest version of your app package in the <code>appPackage\manifest.json</code> file, follow these steps:</p>
<ol>
<li>
<p>Open the <code>manifest.json</code> file located in the <code>appPackage</code> folder of your project.</p>
</li>
<li>
<p>Locate the <code>version</code> field in the JSON file. It should look something like this:<br />
<code>json
   "version": "1.0.1"</code></p>
</li>
<li>
<p>Increment the version number to a small increment. For example, change it to:<br />
<code>json
   "version": "1.0.2"</code></p>
</li>
<li>
<p>Save the file after making the change.</p>
</li>
</ol>
<h3 id="step-1-install-the-plugin">Step 1: Install the plugin</h3>
<p>Stop and restart your project to force it to re-deploy the application package.
You will be brought into Microsoft Teams. Once you're back in Copilot, open the right flyout 1️⃣ to show your previous chats and declarative agents and select the Trey Genie Local agent 2️⃣.</p>
<p><img alt="Microsoft 365 Copilot showing the Trey Genie agent in action. On the right side there is the custom declarative agent, together with other agents. In the main body of the page there are the conversation starters and the textbox to provide a prompt to the agent." src="../../../assets/images/extend-m365-copilot-05/run-declarative-copilot-01.png" /></p>
<p><cc-end-step lab="e5" exercise="3" step="1" /></p>
<h3 id="step-2-display-an-adaptive-card">Step 2: Display an adaptive card</h3>
<p>Now try a prompt such below</p>
<p><em>what projects are we doing for adatum?</em></p>
<p>Instead of just the text response you will also get a rich card with information of the project.</p>
<p><img alt="The response of the agent based on an Adaptive Card showing rich content, including a table with metrics and an image." src="../../../assets/images/extend-m365-copilot-04/project-adaptive.png" /></p>
<p>Now try a POST operation prompt such below</p>
<p><em>please charge 1 hour to woodgrove bank in trey research</em></p>
<p>Since the request requires Copilot to send some data via POST to the API plugin, you need to confirm that you want to allow Copilot to do so selecting the <em>Confirm</em> button.</p>
<p><img alt="A card generated by Copilot to confirm sending data to the API plugin." src="../../../assets/images/extend-m365-copilot-04/bill-hours-confirm.png" /></p>
<p>Once confirmed, instead of just the text response you will also get a rich card with information of the project.</p>
<p><img alt="The response of the agent based on an Adaptive Card showing rich content about the project status." src="../../../assets/images/extend-m365-copilot-04/bill-hours.png" /></p>
<p>You can now test other prompts as well to see the improved responses from Microsoft 365 Copilot.</p>
<p><cc-end-step lab="e5" exercise="3" step="2" /></p>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">CONGRATULATIONS!</span></p>
<p>You've completed adding adaptive card responses to your first API plugin. You are now ready to proceed to the next lab to add authentication to your API.</p>
<p>Go to the lab <strong>Use OAuth 2.0 with Agents Toolkit</strong> to add authentication - This is the easiest approach; you will learn to set up Agents Toolkit's automated Entra ID registration for an F5 project start experience.</p>
<p><cc-next url="../06a-add-authentication-ttk" label="Next" /></p>
<details>
<summary>Other labs on Authentication with manual steps </summary>
There are older labs created before OAuth 2.0 support with the Agents Toolkit. They demonstrate how to add authentication to your app package and validate access tokens in your web service. The main difference lies in how the app is registered in Entra ID and Microsoft 365.

Feel free to explore them and they all build on the project from this lab.

  1. **Use OAuth 2.0 with Manual Setup** - Leads you through all the Entra ID registration details so you can really understand what's happening; this may help adapt your solution to work with another identity provider
  <cc-next url="../06b-add-authentication" label="OAuth with Manual Setup" />

  2. **Use Single Sign-on** - New capability for seamless Entra ID authentication, manual setup
  <cc-next url="../06c-add-sso" label="Single Sign-on with Manual Setup" />
</details>

<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/extend-m365-copilot/04-add-adaptive-card" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../javascripts/cc-award.js"></script>
      
        <script src="../../../javascripts/cc-next.js"></script>
      
        <script src="../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>