
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/ja/pages/extend-m365-copilot/01-typespec-declarative-agent/">
      
      
        <link rel="prev" href="../00-prerequisites/">
      
      
        <link rel="next" href="../01a-geolocator/">
      
      
        
          <link rel="alternate" href="../../../../pages/extend-m365-copilot/01-typespec-declarative-agent/" hreflang="en">
        
          <link rel="alternate" href="./" hreflang="ja">
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ラボ E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使って Declarative エージェントを初めて作成する - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#e1-microsoft-365-agents-toolkit-typespec-declarative" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../../" title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ラボ E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使って Declarative エージェントを初めて作成する
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../pages/extend-m365-copilot/01-typespec-declarative-agent/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link">
        
  
  
    
  
  ようこそ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../make/" class="md-tabs__link">
          
  
  
  Maker 向けエージェントの作成

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  宣言型エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  
  カスタム エンジン エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../beyond-agents/" class="md-tabs__link">
          
  
  
  AI の概念と手法

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resources/" class="md-tabs__link">
        
  
  
    
  
  動画など

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ようこそ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Maker 向けエージェントの作成
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Maker 向けエージェントの作成
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microsoft 365 Copilot 向けエージェントの作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MAB - Copilot Studio Lite によるエージェント作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MAB1 - 最初のエージェントの構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS - Microsoft Copilot Studio の理解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS0 - セットアップ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MCS1 - 最初のエージェント
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS2 - トピックの定義
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS3 - ツールの定義
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS4 - Microsoft 365 Copilot の拡張
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS5 - Power Platform カスタム コネクター
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS6 - MCP サーバーの利用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/07-autonomous/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS7 - Autonomous エージェントの作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/08-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS8 - RAG のための Azure AI Search 統合
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/09-connected-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS9 - Connected エージェント (プレビュー)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MSA - SharePoint エージェントの理解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MSA1 - 最初の SharePoint エージェントを構築する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MSA2 - SharePoint エージェントの共有
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    宣言型エージェントの構築
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    宣言型エージェントの構築
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microsoft 365 Copilot の拡張
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    セットアップ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    セットアップ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E0 - セットアップ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    宣言型エージェントの基礎
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    宣言型エージェントの基礎
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ラボ E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使って Declarative エージェントを初めて作成する
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使って Declarative エージェントを初めて作成する
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#declarative" class="md-nav__link">
    <span class="md-ellipsis">
      
        Declarative エージェントとは何か
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#declarative-typespec" class="md-nav__link">
    <span class="md-ellipsis">
      
        Declarative エージェントにおける TypeSpec の重要性
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-declarative" class="md-nav__link">
    <span class="md-ellipsis">
      
        演習 1: 単一操作を実行するアクションを持つ Declarative エージェントを構築する
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        演習 2: 追加操作を実装し、エージェントをテストしてデバッグ手法を学ぶ
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      
        ボーナス演習: エージェントに Code Interpreter 機能を追加する
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E1 - Geo Locator ゲーム エージェントのインストラクション
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API をゼロから構築して統合
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API をゼロから構築して統合
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E2 - API の構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E3 - 宣言型エージェントと API プラグインの追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E4 - API とプラグインの強化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-add-adaptive-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E5 - Adaptive Card の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E6a - OAuth で Entra ID 認証を追加 (Agents Toolkit)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    インテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    インテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E7 - 統合: Microsoft Copilot Connector を使用して Trey Genie に Knowledge 機能を追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-mcp-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ 08 : Declarative エージェントを MCP サーバーに接続する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-connected-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ 09: Connected Agent - Zava のマルチ エージェント請求オーケストレーション
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    カスタム エンジン エージェントの構築
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    カスタム エンジン エージェントの構築
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    カスタム エンジン エージェントの構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Microsoft Foundry で構築する
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Microsoft Foundry で構築する
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    はじめに - M365 Agents SDK と Semantic Kernel で独自エージェントを構築する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA0 - 前提条件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA1 - Microsoft Foundry でエージェントを準備する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA2 - M365 Agents SDK を使用した初めてのエージェント構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA3 - Microsoft Foundry エージェントと M365 Agents SDK の統合
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MBA4 - エージェントを Copilot Chat に追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agent Framework で構築する
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agent Framework で構築する
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zava Insurance エージェントの構築 - Microsoft 365 Agents SDK と Agent Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/01-build-and-run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF1 - 最初のエージェントの構築と実行
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/02-add-claim-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF2 - Azure AI Search を使用したドキュメント検索の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/03-add-vision-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF3 - Mistral AI を使用したビジョン解析の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/04-add-policy-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF4 - ポリシー検索の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/05-add-communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF5 - 通信機能の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/06-add-copilot-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF6 - Microsoft 365 Work IQ API 統合を追加する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agent-framework/07-add-mcp-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BAF7 - MCP ツール統合の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI の概念と手法
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI の概念と手法
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beyond-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beyond-agents/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    エージェント指示ラボ - エージェント指示の改善 (初心者向け)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    動画など
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="e1-microsoft-365-agents-toolkit-typespec-declarative">ラボ E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使って Declarative エージェントを初めて作成する</h1>
<p>このラボでは、Microsoft 365 Agents Toolkit を使用して TypeSpec 定義を持つ Declarative エージェントを構築します。修理データと対話して自動車修理レコードを管理するための <code>RepairServiceAgent</code> というエージェントを作成します。<br />
完成版エージェントのソースコードは <a href="https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab01-declarative-copilot/RepairServiceAgent">こちら</a> で確認できます。</p>
<p>このラボは Ignite 2025 の発表内容を反映して更新されています。TypeSpec は GA となり、Toolkit バージョン 6.4.1 がリリースされました。このラボは 2025 年 11 月の Ignite で提供された Lab 560 をベースにしています。</p>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/RNsa0kLsXgY" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>ビデオでラボの概要を短く確認しましょう。</div>
        </div>
    <div style="flex: 1; min-width: 0;">
  <div class="floatwide">
  <div class="cc-lab-toc e-path">
      <img src="/copilot-camp/assets/images/path-icons/E-path-heading.png"></img>
      <div>
          <p>Microsoft 365 が AI モデルとオーケストレーションを提供する宣言型エージェントを構築したい場合は、これらのラボを実施してください。</p>
          <ul id="lab-toc">
              <li><strong><a href="/copilot-camp/pages/extend-m365-copilot/index">🏁 はじめに</a></strong></li>
              <li><strong>🔧 セットアップ</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/00-prerequisites">ラボ E0 - セットアップ</a></li>
                  </ul>
              </li>
              <li><strong>🧰 宣言型エージェントの基礎</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01-typespec-declarative-agent">ラボ E1 - 詳細な宣言型エージェントを構築する</a>
                      </li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01a-geolocator">ラボ E1a - Geo ロケーターゲーム</a></li>
                  </ul>
              </li>
              <li><strong>🛠️ API をゼロから構築して統合する</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/02-build-the-api">ラボ E2 - API を構築する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/03-add-declarative-agent">ラボ E3 - 宣言型エージェント + API を追加する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/04-enhance-api-plugin">ラボ E4 - API + プラグインを強化する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/05-add-adaptive-card">ラボ E5 - Adaptive Card を追加する</a></li>
                  </ul>
              </li>
              <li><strong>🔐 認証</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06a-add-authentication-ttk">ラボ E6a - Toolkit</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06b-add-authentication">ラボ E6b - 手動</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06c-add-sso">ラボ E6c - SSO</a></li>
                  </ul>
              </li>
              <li><strong>🔌 統合</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/07-add-graphconnector">ラボ EB - Graph Connector を追加する</a></li>
                  </ul>
              </li>
          </ul>
      </div>
  </div>

  <script>
  (() => {

  // This script decorates the table of contents with a "you are here" indicator.
  const toc = document.getElementsByClassName('cc-lab-toc');
  for (const div of toc) {
      const lis = div.querySelectorAll('li');
      for (const li of lis) {
          const anchor = li.querySelector('a');
          if (anchor) {            // Get the last segment of the current URL path
              const currentPath = window.location.pathname.slice(0, -1).split('/').pop();

              // Get the last segment of the link path
              const linkPath = anchor.getAttribute('href').split('/').pop().replace('.md', '');

              // Compare the last segments
              if (currentPath === linkPath) {
                  const existingSpan = document.querySelector('span.you-are-here');
                  if (existingSpan) {
                      existingSpan.remove();
                  }
                  const span = document.createElement("span");
                  span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
                  span.className = "you-are-here";
                  li.appendChild(span);
              }
          }
      }
  }
  })();
  </script>
  </div>
    </div>
</div>

<h2 id="declarative">Declarative エージェントとは何か</h2>
<p><strong>Declarative エージェント</strong> は、Microsoft 365 Copilot のスケーラブルなインフラストラクチャとプラットフォームを活用し、特定のニーズにフォーカスした形で提供されるものです。Microsoft 365 Copilot の標準チャット インターフェイスと同じ UI を使いながら、対象タスクに専念できる専門家として機能します。</p>
<h3 id="declarative_1">Declarative エージェントの構成要素</h3>
<p>Copilot 用に複数のエージェントを作成すると、最終的な成果物が zip ファイルにまとめられた数個のファイルのセット (アプリ パッケージ) であることに気付くでしょう。これは Teams アプリをデプロイした経験がある方には馴染みのある構成で、追加要素が含まれています。以下の表で主な要素を確認してください。また、アプリの展開プロセスは Teams アプリの展開と非常によく似ています。</p>
<table>
<thead>
<tr>
<th>ファイル種別</th>
<th>説明</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>アプリ マニフェスト</td>
<td>標準の Teams アプリ マニフェストを定義する JSON ファイル (<strong>manifest.json</strong>)</td>
<td>Yes</td>
</tr>
<tr>
<td>Declarative エージェント マニフェスト</td>
<td>エージェントの名前、指示、機能、会話スターター、アクション (該当する場合) を含む JSON ファイル</td>
<td>Yes</td>
</tr>
<tr>
<td>プラグイン マニフェスト</td>
<td>アクションを API プラグインとして構成するための JSON ファイル。認証、必須フィールド、Adaptive Card 応答などを含む。アクションが存在する場合のみ必要</td>
<td>No</td>
</tr>
<tr>
<td>アプリ アイコン</td>
<td>Declarative エージェント用のカラー アイコンおよびアウトライン アイコン</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h3 id="declarative_2">Declarative エージェントの機能</h3>
<p>指示を追加するだけでなく、エージェントがアクセスすべきナレッジ ベースを指定することで、対象データに対する集中度を高められます。これらを「機能 (capabilities)」と呼びます。現在 Declarative エージェントでサポートされている機能は次のとおりです。</p>
<ul>
<li><strong>Copilot Connectors</strong> – Microsoft 365 上にコンテンツを一元化します。外部コンテンツを Microsoft 365 に取り込むことで、関連情報の検索を容易にし、組織内の他者が新しいコンテンツを発見しやすくなります。</li>
<li><strong>OneDrive and SharePoint</strong> – OneDrive や SharePoint のファイル/サイトの URL を指定して、エージェントのナレッジ ベースに含められます。</li>
<li><strong>Web 検索</strong> – Web コンテンツをナレッジ ベースに含めるかどうかを設定できます。最大 4 件の Web サイト URL をソースとして渡すことも可能です。</li>
<li><strong>Code Interpreter</strong> – 数学的問題をより良く解決し、必要に応じて Python コードで高度なデータ分析やチャート作成を行う能力をエージェントに付与します。</li>
<li><strong>GraphicArt</strong> – DALL·E を利用した画像または動画生成機能をエージェントに追加します。</li>
<li><strong>Email Knowledge</strong> – 個人または共有メールボックス (オプションで特定フォルダー) をナレッジとして使用できます。</li>
<li><strong>People Knowledge</strong> – 組織内の人物に関する質問に回答するエージェントを構築できます。</li>
<li><strong>Teams Messages</strong> – Teams のチャネル、チーム、会議、1:1 チャット、グループ チャットを検索できるようにします。</li>
<li><strong>Dataverse Knowledge</strong> – Dataverse インスタンスをナレッジ ソースとして追加できます。</li>
<li><strong>Scenario Models</strong> – タスク固有のモデルを追加できます。</li>
<li><strong>Teams Meetings</strong> – 組織内の会議情報を検索できるエージェントを構築できます。</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">OneDrive and SharePoint</p>
<p>URL は SharePoint アイテム (サイト、ドキュメント ライブラリ、フォルダー、ファイル) の完全パスである必要があります。SharePoint の「リンクをコピー」オプションを使用してフル パスを取得できます。ファイルまたはフォルダーを右クリックして [詳細] を選択し、[パス] 項目のコピー アイコンをクリックしてください。<br />
<mark>URL を指定しない場合、ログイン ユーザーがアクセス可能な OneDrive と SharePoint の全コンテンツがエージェントのナレッジとして使用されます。</mark></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Microsoft Copilot Connector</p>
<p>接続を指定しない場合、ログイン ユーザーがアクセス可能な Copilot Connectors の全コンテンツがナレッジとして使用されます。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Web 検索</p>
<p>サイトを指定しない場合、エージェントはすべてのサイトを検索できます。指定できるサイトはパス セグメントが 2 つ以内で、クエリ ストリングのない URL を最大 4 件までです。</p>
</div>
<h2 id="declarative-typespec">Declarative エージェントにおける TypeSpec の重要性</h2>
<h3 id="typespec">TypeSpec とは</h3>
<p><strong>TypeSpec</strong> は、API 契約を構造化され型安全な方法で設計・記述するために Microsoft が開発した言語です。API がどのようなデータを受け取り、返し、各部分やアクションがどのように接続されるかを示す設計図のようなものと考えてください。</p>
<h3 id="typespec_1">エージェントになぜ TypeSpec か</h3>
<p>TypeScript がフロントエンド/バックエンド コードに構造を提供するのと同様に、TypeSpec はエージェントとその API サービス (アクションなど) に構造を提供します。Visual Studio Code などのツールと整合するデザイン ファースト開発ワークフローに最適です。</p>
<ul>
<li><strong>明確なコミュニケーション</strong> – 複数のマニフェスト ファイルを扱う混乱を避ける単一のソース オブ トゥルースを提供します。</li>
<li><strong>一貫性</strong> – エージェント、アクション、機能などの全要素が同じパターンに従って設計されることを保証します。</li>
<li><strong>自動化に適合</strong> – OpenAPI スペックやその他マニフェストを自動生成し、時間を節約し人的ミスを削減します。</li>
<li><strong>早期検証</strong> – 実装前に設計上の問題 (データ型の不一致や定義の不明確さなど) を早期に検出します。</li>
<li><strong>デザイン ファースト アプローチ</strong> – 実装に入る前にエージェントと API の構造・契約を考えることを促し、長期的な保守性を向上させます。</li>
</ul>
<p>☑️ Declarative エージェントと TypeSpec に関する基本概念を理解できました！最初の演習に進みましょう。</p>
<h2 id="1-declarative">演習 1: 単一操作を実行するアクションを持つ Declarative エージェントを構築する</h2>
<p>Microsoft 365 Agents Toolkit を使用して、最初の Declarative エージェントを作りましょう。<br />
修理データと対話して自動車修理レコードを管理する <strong>RepairServiceAgent</strong> を作成します。<br />
追加の前提条件をインストールしてください。</p>
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=humao.rest-client">Visual Studio Code 用 REST Client アドイン</a>: API をローカルでテストするために使用します。</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension">Microsoft 365 Agents Toolkit バージョン 6.4.0 以上</a>。古いバージョンをお使いの場合は更新してください。</li>
</ul>
<h3 id="1-microsoft-365-agents-toolkit">手順 1: Microsoft 365 Agents Toolkit でエージェント プロジェクトをスキャフォールディングする</h3>
<ul>
<li>VS Code を開き、左メニューの Microsoft 365 Agents Toolkit アイコン <img width="24" alt="m365atk-icon" src="https://github.com/user-attachments/assets/b5a5a093-2344-4276-b7e7-82553ee73199" /> を選択します。アクティビティ バーが開きます。  </li>
<li>アクティビティ バーで "Create a New Agent/App" ボタンを選択すると、利用可能なアプリ テンプレートのリストが表示されます。  </li>
<li>テンプレートの一覧から "Declarative Agent" を選択します。  </li>
<li>次に "Start with TypeSpec for Microsoft 365 Copilot" を選択して、TypeSpec でエージェントを定義します。  </li>
<li>エージェント プロジェクトを作成する <strong>デフォルト フォルダー</strong> を選択します。  </li>
<li>アプリケーション名として <code>RepairServiceAgent</code> などを入力し Enter を押すと完了です。新しい VS Code ウィンドウにプロジェクトが読み込まれます。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>フォルダー内のファイルの作成者を信頼するかどうかを尋ねるプロンプトが表示される場合があります。これは想定されたもので、<strong>Yes, I trust the authors</strong> を選択して問題ありません。このダイアログはセキュリティ保護の一環で、コード作成者の信頼性に応じて機能の実行を制限するかどうかを判断するためのものです。自分のコード、または信頼できるソースからのコードであれば安心して信頼してください。</p>
</div>
<p><cc-end-step lab="e01" exercise="1" step="1" /></p>
<h3 id="2-microsoft-365-agents-toolkit">手順 2: Microsoft 365 Agents Toolkit にサインインする</h3>
<p>エージェントをアップロードしてテストするには、Microsoft 365 Agents Toolkit にサインインする必要があります。</p>
<ul>
<li>プロジェクト ウィンドウで再度 Microsoft 365 Agents Toolkit アイコン <img width="24" alt="m365atk-icon" src="https://github.com/user-attachments/assets/b5a5a093-2344-4276-b7e7-82553ee73199" /> を選択します。Accounts、Environment、Development などのセクションが表示されます。  </li>
<li>"Accounts" セクションの "Sign in to Microsoft 365" を選択します。サインイン ダイアログが表示されるので <strong>Sign in</strong> を選択します。  </li>
<li>サインインが完了したらブラウザーを閉じ、プロジェクト ウィンドウに戻ります。</li>
</ul>
<p><cc-end-step lab="e01" exercise="1" step="2" /></p>
<h3 id="3">手順 3: エージェントを定義する</h3>
<p>Agents Toolkit によってスキャフォールディングされた Declarative エージェント プロジェクトには、GitHub API と接続してリポジトリの issue を表示するためのテンプレート コードが含まれています。本ラボでは、修理 API サービスと統合し、複数の操作をサポートする独自のエージェントを構築します。</p>
<p>エージェント定義に進む前に、修理 API サービスの機能を把握しましょう。</p>
<h4 id="api">修理 API サービスを理解する</h4>
<p>API サービスのエンドポイントとペイロードを対話的に調べる必要があります。REST Client 拡張機能を使用すると、VS Code 内で <strong>.http</strong> ファイルを使って HTTP リクエストを定義し送信できます。外部ツールを開く必要がなく、テストやレスポンスの確認、反復が素早く行えます。</p>
<p>プロジェクトのルート フォルダーで <strong>http</strong> フォルダーを作成します。<br />
その中に <code>repairs-api.http</code> というファイルを作成します。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>VS Code でフォルダーとファイルを作成する方法:</strong></p>
<ul>
<li>フォルダーを作成する場合: Explorer パネルで右クリックし、"New Folder" を選択してフォルダー名を入力します。</li>
<li>ファイルを作成する場合: 目的のフォルダーを右クリックし、"New File" を選択してファイル名と拡張子を入力します。</li>
<li>Explorer パネルのアイコン (📁 フォルダー、📄 ファイル) を使うこともできます。</li>
</ul>
</div>
<p>ファイルに以下の内容を貼り付けます。</p>
<pre><code>@base_url = https://repairshub.azurewebsites.net

### Get all repair requests
{{base_url}}/repairs

### Get a specific repair request by ID
{{base_url}}/repairs/1

### Create a new repair request
POST {{base_url}}/repairs
Content-Type: application/json

{
  &quot;description&quot;: &quot;Repair broken screen&quot;,
  &quot;date&quot;: &quot;2023-10-01T12:00:00Z&quot;,
  &quot;image&quot;: &quot;https://example.com/image.png&quot;
}

### Update an existing repair request
PATCH {{base_url}}/repairs/1
Content-Type: application/json  

{
  &quot;id&quot;: 1,
  &quot;description&quot;: &quot;Repair broken screen - updated&quot;,
  &quot;date&quot;: &quot;2023-10-01T12:00:00Z&quot;,
  &quot;image&quot;: &quot;https://example.com/image-updated.png&quot;
}


### Delete a repair request by ID
DELETE {{base_url}}/repairs/10
Content-Type: application/json

{
  &quot;id&quot;: 10
}
</code></pre>
<blockquote>
<p>エディターからリクエストを送信すると若干の遅延がありますが、数秒でレスポンスが返るはずです。</p>
</blockquote>
<p>各リクエスト行 (例: GET {{base_url}}/repairs) にカーソルを合わせ、<strong>Send Request</strong> をクリックしてレスポンスを確認してください。リクエストとレスポンスの構造を観察し、エージェントが API とどのようにやり取りするかを理解します。</p>
<p><img alt="http request" src="https://github.com/user-attachments/assets/050ca976-4523-463d-920f-4f0f2da46249" /></p>
<h4 id="repairs-api">Repairs API の概要</h4>
<p><strong>ベース URL</strong>: <em>https://repairshub.azurewebsites.net</em></p>
<table>
<thead>
<tr>
<th>操作</th>
<th>メソッド</th>
<th>エンドポイント</th>
<th>ペイロード</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>すべての修理リクエスト取得</td>
<td>GET</td>
<td>/repairs</td>
<td>なし</td>
<td>すべての修理ジョブを取得</td>
</tr>
<tr>
<td>ID で修理取得</td>
<td>GET</td>
<td>/repairs/{id}</td>
<td>なし</td>
<td>特定の修理ジョブを取得</td>
</tr>
<tr>
<td>修理リクエスト作成</td>
<td>POST</td>
<td>/repairs</td>
<td>必須</td>
<td>新しい修理ジョブを登録</td>
</tr>
<tr>
<td>修理リクエスト更新</td>
<td>PATCH</td>
<td>/repairs/{id}</td>
<td>必須</td>
<td>既存の修理ジョブを更新</td>
</tr>
<tr>
<td>修理リクエスト削除</td>
<td>DELETE</td>
<td>/repairs/{id}</td>
<td>なし</td>
<td>修理ジョブを ID 指定で削除</td>
</tr>
</tbody>
</table>
<p>API サービスを理解できたら、次にエージェントへの統合に進みます。</p>
<h4 id="_1">プロジェクト構成</h4>
<p>エージェント プロジェクトの <strong>src</strong> フォルダーには、主要な TypeSpec 構成ファイル <strong>main.tsp</strong> と <strong>env.tsp</strong> があります。</p>
<ul>
<li><strong>main.tsp</strong>: エージェントのメタデータ、挙動を定義する指示、機能など、主要な定義を含みます。  </li>
<li><strong>env.tsp</strong>: 環境変数をコンパイル時に処理するために Toolkit が使用します。<strong>env/.env.*</strong> から生成されるため手動更新は不要です。</li>
</ul>
<p>さらに <strong>actions</strong> フォルダーにテンプレート ファイル (初期状態では <strong>github.tsp</strong>) があり、GitHub API 統合の例が示されています。このラボでは、これを置き換えて Repairs API サービスとの接続を定義します。</p>
<p><strong>prompts</strong> フォルダーには <strong>instructions.tsp</strong> があり、エージェントの詳細な挙動やガイダンスを定義できます。</p>
<h4 id="_2">エージェントのメタデータと指示を更新する</h4>
<p><strong>main.tsp</strong> を開き、デフォルト テンプレートの内容を修理サービス シナリオ向けにどのように変更するか確認します。</p>
<p><strong>main.tsp</strong> の基本構造には以下が含まれます。
- エージェント名と説明 1️⃣<br />
- 基本的な指示 2️⃣<br />
- アクションと機能のプレースホルダー コード (コメントアウト) 3️⃣</p>
<p><img alt="image of main.tsp file" src="https://github.com/user-attachments/assets/9924db6f-930b-453c-92ec-72ac7534c1cb" /></p>
<p>まず修理シナリオ用にエージェントを定義します。<strong>@agent</strong> メタデータを以下のコード スニペットに置き換えてください。</p>
<pre><code class="language-typespec">@agent(
  &quot;RepairServiceAgent&quot;,
  &quot;An agent for managing repair information&quot;
)

</code></pre>
<p>次に会話スターターを設定します。これはユーザーとエージェントの対話を開始する初期プロンプトです。テンプレートの該当セクションをコメント解除し、title と text をシナリオに合わせて更新します。</p>
<pre><code class="language-typespec">// Uncomment this part to add a conversation starter to the agent.
// This will be shown to the user when the agent is first created.
@conversationStarter(#{
  title: &quot;List repairs&quot;,
  text: &quot;List all repairs&quot;
})

</code></pre>
<p>このスタータープロンプトでは GET 操作を呼び出してサービスからすべての修理を取得する必要があります。その動作を可能にするため、対応するアクションを定義します。次の手順に進んでください。</p>
<p>続いて <strong>prompts/instructions.tsp</strong> を開き、指示を更新します。<br />
ファイル全体を以下のコードに置き換えます。</p>
<pre><code class="language-typespec">namespace Prompts {
  const INSTRUCTIONS = &quot;&quot;&quot;
    ## Purpose
    You will assist the user in finding car repair records based on the information provided by the user.
  &quot;&quot;&quot;;
}

</code></pre>
<h4 id="_3">エージェントのアクションを定義する</h4>
<p>次に <strong>actions/github.tsp</strong> を <strong>actions.tsp</strong> にリネームします。VS Code でファイルを右クリックし "Rename" を選択してください。</p>
<p><strong>main.tsp</strong> でアクション参照を完了させる前に、アクション自体を定義する必要があります。<strong>actions.tsp</strong> を開き、サービス URL が定義される行までのコードを以下に置き換えます。</p>
<pre><code class="language-typespec">@service
@server(RepairsAPI.SERVER_URL)
@actions(RepairsAPI.ACTIONS_METADATA)
namespace RepairsAPI{
  /**
   * Metadata for the API actions.
   */
  const ACTIONS_METADATA = #{
    nameForHuman: &quot;Repair Service Agent&quot;,
    descriptionForHuman: &quot;Manage your repairs and maintenance tasks.&quot;,
    descriptionForModel: &quot;Plugin to add, update, remove, and view repair objects.&quot;,
    legalInfoUrl: &quot;https://docs.github.com/en/site-policy/github-terms/github-terms-of-service&quot;,
    privacyPolicyUrl: &quot;https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement&quot;
  };

  /**
   * The base URL for the  API.
   */
  const SERVER_URL = &quot;https://repairshub.azurewebsites.net&quot;;

</code></pre>
<p>次にテンプレートの <code>searchIssues</code> 操作を <code>listRepairs</code> に置換して修理一覧を取得します。SERVER_URL 定義の直後から最終の閉じ括弧直前までを以下のスニペットに置き換えてください。閉じ括弧は残します。  </p>
<p><strong>コメント部分もドキュメントとして必要なので必ずコピーしてください</strong>。</p>
<pre><code class="language-typespec">  /**
   * List repairs from the API 
   * @param assignedTo The user assigned to a repair item.
   */

  @route(&quot;/repairs&quot;)
  @get  op listRepairs(@query assignedTo?: string): string;

</code></pre>
<p><strong>main.tsp</strong> に戻り、インポート文を確認します。まだ <em>./actions/github.tsp</em> を参照している場合は、以下の文に置換します。</p>
<pre><code class="language-typespec">import &quot;./actions/actions.tsp&quot;;
</code></pre>
<p>同じファイルで、会話スターターの後にエージェントにアクションを追加します。<strong>RepairServiceAgent</strong> 名前空間全体を以下のスニペットに置換してください。</p>
<pre><code class="language-typespec">namespace RepairServiceAgent{  

  op listRepairs is global.RepairsAPI.listRepairs;   

}

</code></pre>
<p><cc-end-step lab="e01" exercise="1" step="3" /></p>
<h3 id="4">手順 4: デコレーターを理解する (任意)</h3>
<p>任意のステップですが、TypeSpec ファイルで何を定義したか気になる場合はお読みください。<br />
<strong>main.tsp</strong> と <strong>actions.tsp</strong> には、デコレーター (@ で始まる), namespace, model などが記述されています。</p>
<p>以下の表で主要なデコレーターを確認できます。</p>
<table>
<thead>
<tr>
<th>アノテーション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>@agent</td>
<td>エージェントの namespace (名前) と説明を定義</td>
</tr>
<tr>
<td>@instructions</td>
<td>エージェントの挙動を規定する指示 (最大 8000 文字)</td>
</tr>
<tr>
<td>@conversationStarter</td>
<td>エージェントの会話スターターを定義</td>
</tr>
<tr>
<td>@op</td>
<td>任意の操作を定義。エージェントの機能 (例: <em>op GraphicArt</em>, <em>op CodeInterpreter</em>) や API 操作 (<strong>op listRepairs</strong> など) を定義する。POST 操作は <code>op createRepair(@body repair: Repair): Repair;</code> のように記述</td>
</tr>
<tr>
<td>@server</td>
<td>API のサーバー エンドポイントと名前を定義</td>
</tr>
<tr>
<td>@capabilities</td>
<td>関数内で使用すると、操作用の小規模な Adaptive Card (確認カードなど) を定義</td>
</tr>
</tbody>
</table>
<p>☑️ 第一演習を完了しました！GET 操作で修理一覧を取得するアクションを追加する方法を学びました。次の演習では、修理管理用のさらなる操作を追加し、テストとデバッグを行います。</p>
<p>次の演習へ進みましょう。</p>
<p><cc-end-step lab="e01" exercise="1" step="4" /></p>
<h2 id="2">演習 2: 追加操作を実装し、エージェントをテストしてデバッグ手法を学ぶ</h2>
<p>ここでは Repairs API サービスのさらなる操作と Adaptive Card 応答を追加してエージェントを拡張します。手順を追って進めましょう。ブラウザーをご利用の場合は VS Code のプロジェクトに戻ってください。</p>
<h3 id="1">手順 1: エージェントを修正して追加操作を実装する</h3>
<ul>
<li><strong>actions/actions.tsp</strong> を開き、<strong>listRepairs</strong> 操作の直後に以下のスニペットを貼り付けて <strong>createRepair</strong>, <strong>updateRepair</strong>, <strong>deleteRepair</strong> の各操作を追加します。また <strong>Repair</strong> データモデルも定義します。</li>
</ul>
<pre><code class="language-typespec">/**
   * Create a new repair using the API. 
   * When creating a repair, the `id` field is optional and will be generated by the server.
   * The `date` field should be in ISO 8601 format (e.g., &quot;2023-10-01T12:00:00Z&quot;).
   * The `title` field based on what repair user wants to create
   * @param repair The repair to create.
   */
  @route(&quot;/repairs&quot;)  
  @post  op createRepair(@body repair: Repair): Repair;

  /**
   * Update an existing repair.
   * The `id` field is required to identify the repair to update.
   * The `date` field should be in ISO 8601 format (e.g., &quot;2023-10-01T12:00:00Z&quot;).
   * The `image` field should be a valid URL pointing to the image associated with the repair.
   * @param repair The repair to update.
   */
  @route(&quot;/repairs&quot;)  
  @patch(#{implicitOptionality: true})
  op updateRepair(@body repair: Repair): Repair;


  /**
   * Delete a repair.
   * The `id` field is required to identify the repair to delete.
   * @param repair The repair to delete.
   */
  @route(&quot;/repairs&quot;) 
  @delete  op deleteRepair(@body repair: Repair): Repair;

  /**
   * A model representing a repair.
   */
  model Repair {
    /**
     * The unique identifier for the repair.
     */
    id?: string;

    /**
     * The short summary or title of the repair.
     */
    title: string;

    /**
     * The detailed description of the repair.
     */
    description?: string;

    /**
     * The user who is assigned to the repair.
     */
    assignedTo?: string;

    /**
     * The optional date and time when the repair is scheduled or completed.
     */
    @format(&quot;date-time&quot;)
    date?: string;

    /**
     * The URL of the image associated with the repair.
     */
    @format(&quot;uri&quot;)
    image?: string;
  }

</code></pre>
<ul>
<li><strong>main.tsp</strong> に戻り、エージェントのアクションとして新しい操作が追加されているか確認します。<strong>RepairServiceActions</strong> 名前空間内の <code>op listRepairs is global.RepairsAPI.listRepairs;</code> の次に以下のスニペットを貼り付けます。</li>
</ul>
<pre><code class="language-typespec">op createRepair is global.RepairsAPI.createRepair;
op updateRepair is global.RepairsAPI.updateRepair;
op deleteRepair is global.RepairsAPI.deleteRepair;   

</code></pre>
<ul>
<li>さらに、新しい修理アイテムを作成する会話スターターを最初のスターター定義の直後に追加します。</li>
</ul>
<pre><code class="language-typespec">@conversationStarter(#{
  title: &quot;Create repair&quot;,
  text: &quot;Create a new repair titled \&quot;[TO_REPLACE]\&quot; and assign it to me&quot;
})

</code></pre>
<p><cc-end-step lab="e01" exercise="2" step="1" /></p>
<h3 id="2-adaptive-card">手順 2: 関数参照に Adaptive Card を追加する</h3>
<p>次に応答カードを Adaptive Card で強化します。修理アイテム用のカードを作成しましょう。</p>
<ul>
<li><strong>appPackage</strong> フォルダー内の <strong>adaptiveCards</strong> フォルダーに <code>repair.json</code> を作成し、提供されたコード スニペットを貼り付けます。既存のテンプレート カードは無視してください。</li>
</ul>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
    &quot;type&quot;: &quot;AdaptiveCard&quot;,
    &quot;version&quot;: &quot;1.5&quot;,
    &quot;body&quot;: [
  {
    &quot;type&quot;: &quot;Container&quot;,
    &quot;$data&quot;: &quot;${$root}&quot;,
    &quot;items&quot;: [
      {
        &quot;type&quot;: &quot;TextBlock&quot;,
        &quot;text&quot;: &quot;Title: ${if(title, title, 'N/A')}&quot;,
        &quot;weight&quot;: &quot;Bolder&quot;,
        &quot;wrap&quot;: true
      },
      {
        &quot;type&quot;: &quot;TextBlock&quot;,
        &quot;text&quot;: &quot;Description: ${if(description, description, 'N/A')}&quot;,
        &quot;wrap&quot;: true
      },
      {
        &quot;type&quot;: &quot;TextBlock&quot;,
        &quot;text&quot;: &quot;Assigned To: ${if(assignedTo, assignedTo, 'N/A')}&quot;,
        &quot;wrap&quot;: true
      },
      {
        &quot;type&quot;: &quot;TextBlock&quot;,
        &quot;text&quot;: &quot;Date: ${if(date, date, 'N/A')}&quot;,
        &quot;wrap&quot;: true
      },
      {
        &quot;type&quot;: &quot;Image&quot;,
        &quot;url&quot;: &quot;${image}&quot;,
        &quot;$when&quot;: &quot;${image != null}&quot;
      }
    ]
  }
],  
    &quot;actions&quot;: [
      {
        &quot;type&quot;: &quot;Action.OpenUrl&quot;,
        &quot;title&quot;: &quot;View Image&quot;,
        &quot;url&quot;: &quot;https://www.howmuchisit.org/wp-content/uploads/2011/01/oil-change.jpg&quot;
      }
    ]
  }


</code></pre>
<ul>
<li><strong>actions.tsp</strong> に戻り、<code>@get op listRepairs(@query assignedTo?: string): string;</code> の直前に以下のスニペットを貼り付けてカード定義を追加します。</li>
</ul>
<pre><code class="language-typespec">
@card(#{  dataPath: &quot;$&quot;, file: &quot;adaptiveCards/repair.json&quot;,    properties: #{ title: &quot;$.title&quot;, url: &quot;$.image&quot; } })

</code></pre>
<p>このカード応答は、修理アイテムを問い合わせた場合やエージェントがアイテム一覧を返す際に使用されます。</p>
<blockquote>
<p>このラボでは簡略化のため同じカードを再利用します。実際には操作ごとに異なるカードを作成しても構いません。</p>
</blockquote>
<p><strong>createRepair</strong> 操作に対してもカード応答を追加し、POST の結果を表示します。</p>
<ul>
<li><code>@post  op createRepair(@body repair: Repair): Repair;</code> の直前に以下のスニペットを貼り付けます。</li>
</ul>
<pre><code class="language-typespec">
@card(#{  dataPath: &quot;$&quot;, file: &quot;adaptiveCards/repair.json&quot;,    properties: #{ title: &quot;$.title&quot;, url: &quot;$.image&quot; } })

</code></pre>
<p><cc-end-step lab="e01" exercise="2" step="2" /></p>
<h3 id="3_1">手順 3: 新しい操作に合わせてエージェントの指示を更新する</h3>
<p><strong>prompts/instructions.tsp</strong> の INSTRUCTIONS 定義を追加機能に対応させます。以下のコードで置き換えてください。</p>
<pre><code class="language-typespec">const INSTRUCTIONS =&quot;&quot;&quot;  
    ## Purpose
    You will assist the user in finding car repair records based on the information provided by the user.

    ## Guidelines
    - You are a repair service agent.
    - You can use the actions to create, update, and delete repairs.
    - When creating a repair item, if the user did not provide a description or date, use the title as the description and put today's date in the format YYYY-MM-DD.
    - Do not use any technical jargon or complex terms.
  &quot;&quot;&quot;;
</code></pre>
<p><cc-end-step lab="e01" exercise="2" step="3" /></p>
<h3 id="4_1">手順 4: エージェントをプロビジョニングしてテストする</h3>
<h4 id="_4">プロビジョニング</h4>
<p>まずエージェントをテナントにプロビジョニングしてテストします。以下の手順に従ってください。</p>
<ul>
<li>プロジェクト ルートの <strong>env</strong> フォルダー内にある <strong>.env.dev</strong> を開き、<strong>AGENT_SCOPE</strong> 変数があれば値を <code>shared</code> から <code>personal</code> に変更します。</li>
<li>Agents Toolkit アイコン <img width="24" alt="m365atk-icon" src="https://github.com/user-attachments/assets/b5a5a093-2344-4276-b7e7-82553ee73199" /> を選択し、アクティビティ バーを開きます。</li>
<li>アクティビティ バーの "LifeCycle" セクションで "Provision" を選択します。これにより TypeSpec から生成されたマニフェストとアイコンを含むアプリ パッケージがビルドされ、テスト用にカタログへサイドロードされます。</li>
</ul>
<blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Agents Toolkit は TypeSpec ファイルに記述された定義を検証し、エラーを特定して開発者体験を向上させます。</p>
</div>
</blockquote>
<p>処理には時間がかかりますが、VS Code のトースト メッセージで進捗が確認できます。</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Provision</strong> が失敗し、次のようなエラーが表示される既知の問題があります。発生した場合は成功するまで再試行してください。<br />
<img alt="provision 429 issue" src="https://github.com/user-attachments/assets/bf849c94-6f5a-406a-9902-ae5a07d47840" /><br />
<img alt="provision timeout issue" src="https://github.com/user-attachments/assets/fd13651e-d469-4ecb-91b2-c24045fb4264" /></p>
</div>
<ul>
<li>ラボ マシンのタスクバーから Microsoft Edge を開き、<code>https://m365.cloud.microsoft/chat</code> にアクセスして Copilot アプリを開き、サインインします。</li>
<li>左側の <strong>Agents</strong> から <strong>RepairServiceAgent</strong> を選択します。  </li>
</ul>
<blockquote>
<p>ナビゲーションが見当たらない場合は、以下のアイコンを選択して表示してください。<br />
<img alt="find agents nav" src="https://github.com/user-attachments/assets/0d603d1b-6458-4766-9063-4f87597f10dc" /></p>
</blockquote>
<h4 id="list">list 操作をテストする</h4>
<ul>
<li>会話スターター <strong>List repairs</strong> を選択し、チャットに送信してエージェントとの対話を開始します。サービスへのアクセス許可を求めるメッセージが表示された場合は <strong>"Always allow"</strong> を選択してください。</li>
</ul>
<p>許可すると、以下のようなレスポンスが返ります。  </p>
<p><img alt="ex1-dem0-01" src="https://github.com/user-attachments/assets/02400c13-0766-4440-999b-93c88ca45dc7" /></p>
<h4 id="_5">エージェントの診断とデバッグ</h4>
<p>チャットで開発者モードを有効にすると、エージェントがタスクをどの程度理解しているか、サービス呼び出しが正しいか、チューニングが必要な箇所、パフォーマンス問題などを確認できます。</p>
<ul>
<li>チャットに <code>-developer on</code> と送信してデバッグ モードを有効にします。</li>
</ul>
<p>成功すると <strong>Successfully enabled developer mode</strong> と返ります。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>F5 キーでブラウザーを更新するとデバッグ情報が表示されます。</p>
</div>
<ul>
<li>例として以下のプロンプトを送信し、エージェントの応答を確認します。</li>
</ul>
<p><code>Find out what Karin is working on</code></p>
<ul>
<li>修理サービスからの情報に加え <strong>Agent debug info</strong> カードが表示されます。</li>
<li>カードを展開すると以下が確認できます。<br />
  1️⃣ エージェント情報<br />
  2️⃣ エージェントの機能<br />
  3️⃣ 選択されたアクションと関数<br />
  4️⃣ 実行されたアクションの詳細 (リクエスト、レイテンシ、レスポンス データなど)</li>
</ul>
<p><img alt="image of agent debug info" src="https://github.com/user-attachments/assets/cb8623c7-27e1-4ece-9ec6-4c43b76917fb" /></p>
<ul>
<li>Executed Actions を展開するとリクエスト URL、パラメーター、ヘッダー、レスポンス、レイテンシなどが確認できます。</li>
</ul>
<h4 id="create">create 操作をテストする</h4>
<p>POST 呼び出しで修理アイテムを作成してみましょう。</p>
<ul>
<li>
<p>会話スターター <strong>Create repair</strong> を選択し、プロンプト内容を置換して送信します。例:</p>
<p><code>Create a new repair titled "360 camera issue" and assign it to me.</code></p>
</li>
<li>
<p>送信すると、拡張した指示のおかげで入力した内容より詳細なメタデータが含まれる確認ダイアログが表示されます。</p>
</li>
</ul>
<p><img alt="response from Create a new repair titled &quot;360 camera issue&quot; and assign it to me" src="https://github.com/user-attachments/assets/f570f9fd-fa85-4ab1-9c3d-f9baf993dc95" /></p>
<ul>
<li>ダイアログを承認してアイテムを追加します。</li>
</ul>
<p>エージェントはリッチな Adaptive Card で作成されたアイテムを返します。</p>
<p><img alt="adaptive card response" src="https://github.com/user-attachments/assets/d4d5906d-e5fb-4728-bb0c-b7a9f54215c5" /></p>
<ul>
<li>
<p>参照カードが機能するか再確認します。新しいチャットを開き、次のプロンプトを送信します。</p>
<p><code>List all my repairs.</code></p>
</li>
</ul>
<p>エージェントはアイテムごとに Adaptive Card を添えて一覧を返します。</p>
<p><img alt="list all repairs with new repair added" src="https://github.com/user-attachments/assets/8240525d-c683-40f9-aa68-d6ba9a19d0f2" /></p>
<p>☑️ 第二演習を完了しました！修理操作を追加し、テストとデバッグ方法を学習しました。ボーナス演習に進みましょう。</p>
<p><cc-end-step lab="e01" exercise="2" step="4" /></p>
<h2 id="code-interpreter">ボーナス演習: エージェントに Code Interpreter 機能を追加する</h2>
<h3 id="1-code-interpreter">手順 1: エージェントに Code Interpreter 機能を追加する</h3>
<p>Declarative エージェントは OneDriveAndSharePoint、WebSearch、CodeInterpreter など多くの機能を拡張できます。ここでは Code Interpreter 機能を追加します。</p>
<ul>
<li><strong>main.tsp</strong> を開き、エージェント挙動を定義する <strong>RepairServiceAgent</strong> 名前空間を探します。</li>
<li>名前空間 <strong>RepairServiceAgent</strong> 内で <strong>op listRepairs</strong> の上に以下のスニペットを挿入して、コード実行を可能にする新しい機能を定義します。</li>
</ul>
<pre><code class="language-typespec">op codeInterpreter is AgentCapabilities.CodeInterpreter;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>この codeinterpreter 操作は、エージェントの機能を定義する外側の <strong>RepairServiceAgent</strong> 名前空間に追加してください。アクションを定義する <strong>RepairServiceActions</strong> 名前空間ではありません。</p>
</div>
<p>追加機能に対応するよう指示も更新します。</p>
<ul>
<li><strong>prompts/instructions.tsp</strong> を開き、INSTRUCTIONS 定数を以下のスニペットに置き換えます。</li>
</ul>
<pre><code class="language-typespec">
  const INSTRUCTIONS =&quot;&quot;&quot;
   ## Purpose
    You will assist the user in finding car repair records based on the information provided by the user. You can generate charts based on data. Use python execution for charting/visualization.

    ## Guidelines
    - You are a repair service agent.
    - You can use the actions to create, update, and delete repairs.
    - When creating a repair item, if the user did not provide a description or date, use the title as the description and put today's date in the format YYYY-MM-DD.
    - when asked to generate report, generate charts using existing data.
    - Do not use any technical jargon or complex terms.
&quot;&quot;&quot;;

</code></pre>
<p><cc-end-step lab="e01" exercise="3" step="1" /></p>
<h3 id="2_1">手順 2: 追加機能をテストする</h3>
<p>新しい分析機能をテストします。再度エージェントをプロビジョニングする必要があります。以下の手順を実行してください。</p>
<ul>
<li><strong>appPackage/manifest.json</strong> を開き、バージョンを <strong>"version": "1.0.0"</strong> から <strong>"version": "1.0.1"</strong> に更新します。</li>
<li>変更を保存し、Agents Toolkit アイコン <img width="24" alt="m365atk-icon" src="https://github.com/user-attachments/assets/b5a5a093-2344-4276-b7e7-82553ee73199" /> を選択し、アクティビティ バーで "Provision" を選択して再プロビジョニングします。</li>
<li>既にエージェントとのチャットを開いている場合は <strong>New chat</strong> ボタンで新しいチャットを作成します。</li>
<li>または Microsoft Edge で <code>https://m365.cloud.microsoft/chat</code> を開き、Copilot アプリでサインインします。</li>
<li>左側の <strong>Agents</strong> から <strong>RepairServiceAgent</strong> を選択します。  </li>
</ul>
<blockquote>
<p>ナビゲーションが見当たらない場合は、以下のアイコンを選択して表示してください。<br />
<img alt="find agents nav" src="https://github.com/user-attachments/assets/0d603d1b-6458-4766-9063-4f87597f10dc" /></p>
</blockquote>
<ul>
<li>次のプロンプトをコピーしてメッセージ ボックスに貼り付け、送信します。</li>
</ul>
<p><code>Classify repair items based on title into three distinct categories: Routine Maintenance, Critical, and Low Priority. Then, generate a pie chart displaying the percentage representation of each category. Use unique colours for each group and incorporate tooltips to show the precise values for each segment.</code></p>
<p>以下のようなレスポンスが返ります (結果は異なる場合があります)。<br />
<img alt="response with chart using code interpreter" src="https://github.com/user-attachments/assets/8ccc7758-28ec-42ff-96fd-2341cad6c9ed" /></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Code Interpreter の既知の問題: 応答に次のようなエラーメッセージが表示されても、チャートは正しく生成されますので無視して構いません。<br />
<img alt="error with CI" src="https://github.com/user-attachments/assets/d9d04b7f-5696-42ca-8767-178dbc51f342" /></p>
</div>
<p><cc-end-step lab="e01" exercise="3" step="2" /></p>
<p>☑️ すべての演習を完了しました。お疲れさまでした！</p>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">おめでとうございます！</span>
Great job on building your first agent using TypeSpec 🎉 </p>
<p>Proceed to create, build, and integrate an API selecting <strong>Next</strong>.
 <cc-next url="../02-build-the-api" label="Next" /></p>
<p>Continue practicing by building a Geolocator game agent—select <strong>Create a game</strong> below.
 <cc-next url="../01a-geolocator" label="Create a game" /></p>
<p><img src="https://pnptelemetry.azurewebsites.net/copilot-camp/extend-m365-copilot/01-typespec-declarative-agent--ja" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>