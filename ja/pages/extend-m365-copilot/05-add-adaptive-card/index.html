
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/ja/pages/extend-m365-copilot/05-add-adaptive-card/">
      
      
        <link rel="prev" href="../04-enhance-api-plugin/">
      
      
        <link rel="next" href="../06a-add-authentication-ttk/">
      
      
        
          <link rel="alternate" href="../../../../pages/extend-m365-copilot/05-add-adaptive-card/" hreflang="en">
        
          <link rel="alternate" href="./" hreflang="ja">
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Lab E5 - Adaptive Cards の追加 - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-e5-adaptive-cards" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../../" title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab E5 - Adaptive Cards の追加
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../pages/extend-m365-copilot/05-add-adaptive-card/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link">
        
  
  
    
  
  ようこそ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../make/" class="md-tabs__link">
          
  
  
  Maker 向けエージェントの作成

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  宣言型エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  
  カスタム エンジン エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../beyond-agents/" class="md-tabs__link">
          
  
  
  AI の概念と手法

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resources/" class="md-tabs__link">
        
  
  
    
  
  動画など

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ようこそ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Maker 向けエージェントの作成
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Maker 向けエージェントの作成
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microsoft 365 Copilot 用エージェントの作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MAB - Copilot Studio エージェント ビルダーによるエージェント作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MAB1 - 最初のエージェント構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MCS - Microsoft Copilot Studio の概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS0 - セットアップ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS1 - 最初のエージェント
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MCS2 - トピックの定義
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS3 - ツールの定義
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS4 - Microsoft 365 Copilot の拡張
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS5 - Power Platform カスタム コネクタ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS6 - MCP サーバーの利用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/07-autonomous/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS7 - 自律型エージェントの作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/08-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MCS8 - RAG のための Azure AI Search 統合
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MSA - SharePoint エージェントの理解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MSA1 - はじめての SharePoint エージェント作成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ MSA2 - SharePoint エージェントの共有
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    宣言型エージェントの構築
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    宣言型エージェントの構築
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microsoft 365 Copilot の拡張
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    セットアップ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    セットアップ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E0 - セットアップ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    宣言型エージェントの基礎
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    宣言型エージェントの基礎
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E1 - Microsoft 365 Agents Toolkit と TypeSpec 定義による Declarative エージェントの初構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E1 - 指示ベース Geo Locator ゲーム エージェント
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API をゼロから構築して統合
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API をゼロから構築して統合
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E2 - API の構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E3 - 宣言型 エージェント と API プラグインの追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E4 - API とプラグインを拡張する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab E5 - Adaptive Cards の追加
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab E5 - Adaptive Cards の追加
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1-adaptive-card" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exercise 1: シンプルな Adaptive Card の作成とテスト
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exercise 2: プラグイン マニフェストの更新
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-copilot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exercise 3: Copilot でプラグインをテストする
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E6a - Entra ID 認証を OAuth で追加 (Agents Toolkit)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    認証 (旧ラボ)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    認証 (旧ラボ)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E6b - OAuth を使用した Entra ID 認証の追加 (手動セットアップ)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E6c - Entra ID 認証と Single Sign-on の追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    インテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    インテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ E7 - 統合: Microsoft Copilot Connector を使用して Trey Genie にナレッジ機能を追加
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    カスタム エンジン エージェントの構築
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    カスタム エンジン エージェントの構築
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    カスタムエンジン エージェントの構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    M365 Agents SDK ラボ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    M365 Agents SDK ラボ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    イントロ - M365 Agents SDK と Semantic Kernel を使用したエージェント構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA0 - 前提条件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA1 - Microsoft Foundry でエージェントを準備する
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA2 - M365 Agents SDK を使用して最初のエージェントを構築
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ラボ BMA3 - Microsoft Foundry エージェントを M365 Agents SDK と統合
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab MBA4 - エージェントを Copilot Chat に導入
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI の概念と手法
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI の概念と手法
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beyond-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    始めてみましょう
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beyond-agents/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    エージェント指示ラボ - エージェント指示の改善（初心者向け）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    動画など
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-e5-adaptive-cards">Lab E5 - Adaptive Cards の追加</h1>
<p>この lab では、Microsoft 365 Copilot からの応答をテキストからリッチ カードへと強化するために Adaptive Cards を使用します。 </p>
<p>この lab で学習する内容:</p>
<ul>
<li>Adaptive Cards とは何か</li>
<li>Adaptive Card を作成してテストする方法</li>
<li>Microsoft 365 Copilot の応答を Adaptive Cards でリッチ コンテンツに更新する方法</li>
</ul>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/9kb9whCKey4" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>この動画で lab の概要を素早く確認できます。</div>
            <div class="note-box">
            📘 <strong>Note:</strong> この lab は前の Lab E4 に基づいています。Lab E2–E6 では同じフォルダーで作業を続けられますが、参照用のソリューション フォルダーも用意されています。  
    本 lab の完成版ソリューションは <a  src="https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab05-add-adaptive-cards/trey-research-lab05-END" target="_blank">/src/extend-m365-copilot/path-e-lab05-add-adaptive-cards/trey-research-lab05-END</a> にあります。
        </div>
    </div>
    <div style="flex: 1; min-width: 0;">
  <div class="floatwide">
  <div class="cc-lab-toc e-path">
      <img src="/copilot-camp/assets/images/path-icons/E-path-heading.png"></img>
      <div>
          <p>Microsoft 365 が AI モデルとオーケストレーションを提供する宣言型エージェントを構築したい場合は、これらのラボを実施してください。</p>
          <ul id="lab-toc">
              <li><strong><a href="/copilot-camp/pages/extend-m365-copilot/index">🏁 はじめに</a></strong></li>
              <li><strong>🔧 セットアップ</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/00-prerequisites">ラボ E0 - セットアップ</a></li>
                  </ul>
              </li>
              <li><strong>🧰 宣言型エージェントの基礎</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01-typespec-declarative-agent">ラボ E1 - 詳細な宣言型エージェントを構築する</a>
                      </li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01a-geolocator">ラボ E1a - Geo ロケーターゲーム</a></li>
                  </ul>
              </li>
              <li><strong>🛠️ API をゼロから構築して統合する</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/02-build-the-api">ラボ E2 - API を構築する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/03-add-declarative-agent">ラボ E3 - 宣言型エージェント + API を追加する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/04-enhance-api-plugin">ラボ E4 - API + プラグインを強化する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/05-add-adaptive-card">ラボ E5 - Adaptive Card を追加する</a></li>
                  </ul>
              </li>
              <li><strong>🔐 認証</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06a-add-authentication-ttk">ラボ E6a - Toolkit</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06b-add-authentication">ラボ E6b - 手動</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06c-add-sso">ラボ E6c - SSO</a></li>
                  </ul>
              </li>
              <li><strong>🔌 統合</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/07-add-graphconnector">ラボ EB - Graph Connector を追加する</a></li>
                  </ul>
              </li>
          </ul>
      </div>
  </div>

  <script>
  (() => {

  // This script decorates the table of contents with a "you are here" indicator.
  const toc = document.getElementsByClassName('cc-lab-toc');
  for (const div of toc) {
      const lis = div.querySelectorAll('li');
      for (const li of lis) {
          const anchor = li.querySelector('a');
          if (anchor) {            // Get the last segment of the current URL path
              const currentPath = window.location.pathname.slice(0, -1).split('/').pop();

              // Get the last segment of the link path
              const linkPath = anchor.getAttribute('href').split('/').pop().replace('.md', '');

              // Compare the last segments
              if (currentPath === linkPath) {
                  const existingSpan = document.querySelector('span.you-are-here');
                  if (existingSpan) {
                      existingSpan.remove();
                  }
                  const span = document.createElement("span");
                  span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
                  span.className = "you-are-here";
                  li.appendChild(span);
              }
          }
      }
  }
  })();
  </script>
  </div>
    </div>
</div>

<h2 id="introduction">Introduction</h2>
<details>
<summary>Adaptive Cards とは？</summary>

Adaptive Cards は、JSON で記述されたプラットフォーム非依存の UI スニペットで、アプリやサービス間でやり取りできます。アプリに届けられると、JSON がネイティブ UI に変換され、環境に自動的に適応します。これにより、主要プラットフォームとフレームワークを跨いで軽量 UI を設計・統合できます。
    <div class="video">
      <iframe src="//www.youtube.com/embed/pYe2NqKhJoM" frameborder="0" allowfullscreen></iframe>
      <div>Adaptive Cards はあらゆる場所で利用されています</div>
    </div>
</details>

<h2 id="exercise-1-adaptive-card">Exercise 1: シンプルな Adaptive Card の作成とテスト</h2>
<p>では、Adaptive Card の作成がどれほど楽しいか体験してみましょう。</p>
<h3 id="step-1-json-adaptive-card">Step 1: JSON で Adaptive Card を定義する</h3>
<p>以下は Adaptive Card の JSON です。まずはコピーしてください。</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;AdaptiveCard&quot;,
  &quot;body&quot;: [
    {
      &quot;type&quot;: &quot;TextBlock&quot;,
      &quot;text&quot;: &quot;Hello, Adaptive Cards!&quot;,
      &quot;size&quot;: &quot;large&quot;,
      &quot;weight&quot;: &quot;bolder&quot;
    }
  ],
  &quot;actions&quot;: [
    {
      &quot;type&quot;: &quot;Action.OpenUrl&quot;,
      &quot;title&quot;: &quot;Click me&quot;,
      &quot;url&quot;:&quot;https://www.contoso.com&quot;
    }
  ],
  &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
  &quot;version&quot;: &quot;1.3&quot;
}
</code></pre>
<p>この JSON は、テキスト ブロックとボタンが含まれるシンプルな Adaptive Card を定義しています。</p>
<p><cc-end-step lab="e5" exercise="1" step="1" /></p>
<h3 id="step-2-adaptive-card">Step 2: Adaptive Card をテストする</h3>
<p>Adaptive Card をテストするには、<a href="https://adaptivecards.io/designer/" target="_blank">Adaptive Cards Designer</a> を利用します。</p>
<ol>
<li><a href="https://adaptivecards.io/designer/" target="_blank">Adaptive Cards Designer</a> を開きます。  </li>
<li><code>adaptiveCard.json</code> ファイルの JSON コンテンツをコピーします。  </li>
<li>デザイナー下部の「Card Payload Editor」セクションにペーストします。  </li>
<li>上部にライブ プレビューが表示されます。  </li>
</ol>
<p>おめでとうございます！ これでプラグイン用の Adaptive Card を開発するスキルが身に付きました。</p>
<p><cc-end-step lab="e5" exercise="1" step="2" /></p>
<h2 id="exercise-2">Exercise 2: プラグイン マニフェストの更新</h2>
<p><strong>appPackage</strong> フォルダーにある <strong>trey-plugin.json</strong> のプラグイン マニフェスト ファイルを更新し、Adaptive Cards を使用した応答テンプレートを追加します。各関数または API 呼び出しごとにテンプレートを更新します。</p>
<h3 id="step-1-get-apiconsultants-adaptive-card">Step 1: GET /api/consultants 用の Adaptive Card を追加する</h3>
<ul>
<li><strong>getConsultants</strong> 関数を探し、<code>properties</code> ノードの後に以下の <code>static_template</code> ノードを追加します。</li>
</ul>
<pre><code class="language-JSON"> &quot;static_template&quot;: {
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${name}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${email}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${phone}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${consultantPhotoUrl}&quot;,
                            &quot;altText&quot;: &quot;${name}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              }   

            ]
 }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="1" /></p>
<h3 id="step-2-get-apime-adaptive-card">Step 2: GET /api/me 用の Adaptive Card を追加する</h3>
<ul>
<li><strong>getUserInformation</strong> 関数を探し、<code>properties</code> ノードの後に以下の <code>static_template</code> ノードを追加します。</li>
</ul>
<pre><code class="language-json">
  &quot;static_template&quot;:{
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${name}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${email}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${phone}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${consultantPhotoUrl}&quot;,
                            &quot;altText&quot;: &quot;${name}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              }   

            ]
  }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="2" /></p>
<h3 id="step-3-get-apiprojects-adaptive-card">Step 3: GET /api/projects 用の Adaptive Card を追加する</h3>
<ul>
<li><strong>getProjects</strong> 関数を探し、<code>properties</code> ノードの後に以下の <code>static_template</code> ノードを追加します。</li>
</ul>
<pre><code class="language-JSON">  &quot;static_template&quot;: {
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;$data&quot;: &quot;${$root}&quot;,
                &quot;items&quot;: [
                  {
                    &quot;speak&quot;: &quot;${description}&quot;,
                    &quot;type&quot;: &quot;ColumnSet&quot;,
                    &quot;columns&quot;: [
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${name}&quot;,
                            &quot;weight&quot;: &quot;bolder&quot;,
                            &quot;size&quot;: &quot;extraLarge&quot;,
                            &quot;spacing&quot;: &quot;none&quot;,
                            &quot;wrap&quot;: true,
                            &quot;style&quot;: &quot;heading&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${description}&quot;,
                            &quot;wrap&quot;: true,
                            &quot;spacing&quot;: &quot;none&quot;
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${location.city}, ${location.country}&quot;,
                            &quot;wrap&quot;: true
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientName}&quot;,
                            &quot;weight&quot;: &quot;Bolder&quot;,
                            &quot;size&quot;: &quot;Large&quot;,
                            &quot;spacing&quot;: &quot;Medium&quot;,
                            &quot;wrap&quot;: true,
                            &quot;maxLines&quot;: 3
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientContact}&quot;,
                            &quot;size&quot;: &quot;small&quot;,
                            &quot;wrap&quot;: true
                          },
                          {
                            &quot;type&quot;: &quot;TextBlock&quot;,
                            &quot;text&quot;: &quot;${clientEmail}&quot;,
                            &quot;size&quot;: &quot;small&quot;,
                            &quot;wrap&quot;: true
                          }
                        ]
                      },
                      {
                        &quot;type&quot;: &quot;Column&quot;,
                        &quot;items&quot;: [
                          {
                            &quot;type&quot;: &quot;Image&quot;,
                            &quot;url&quot;: &quot;${location.mapUrl}&quot;,
                            &quot;altText&quot;: &quot;${location.street}&quot;
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Metrics&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;spacing&quot;: &quot;Medium&quot;,
                &quot;horizontalAlignment&quot;: &quot;Center&quot;,
                &quot;separator&quot;: true
              },
              {
                &quot;type&quot;: &quot;ColumnSet&quot;,
                &quot;columns&quot;: [
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Forecast This Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${forecastThisMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  },
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Forecast Next Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${forecastNextMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;ColumnSet&quot;,
                &quot;columns&quot;: [
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Delivered Last Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${deliveredLastMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  },
                  {
                    &quot;type&quot;: &quot;Column&quot;,
                    &quot;width&quot;: &quot;stretch&quot;,
                    &quot;items&quot;: [
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;Delivered This Month&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;spacing&quot;: &quot;Small&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      },
                      {
                        &quot;type&quot;: &quot;TextBlock&quot;,
                        &quot;text&quot;: &quot;${deliveredThisMonth} &quot;,
                        &quot;size&quot;: &quot;ExtraLarge&quot;,
                        &quot;weight&quot;: &quot;Bolder&quot;,
                        &quot;horizontalAlignment&quot;: &quot;Center&quot;
                      }
                    ]
                  }
                ]
              }
            ],
            &quot;actions&quot;: [
              {
                &quot;type&quot;: &quot;Action.OpenUrl&quot;,
                &quot;title&quot;: &quot;View map&quot;,
                &quot;url&quot;: &quot;${location.mapUrl}&quot;
              }
            ]
  }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="3" /></p>
<h3 id="step-4-post-apibillhours-adaptive-card">Step 4: POST /api/billHours 用の Adaptive Card を追加する</h3>
<ul>
<li><strong>postBillhours</strong> 関数を探し、<code>properties</code> ノードの後に以下の <code>static_template</code> ノードを追加します。</li>
</ul>
<pre><code class="language-JSON">&quot;static_template&quot;: {
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Status Summary&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;separator&quot;: true
              },              
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Client Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.clientName, results.clientName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Project Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.projectName, results.projectName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },  
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Remaining Forecast&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.remainingForecast, results.remainingForecast, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },           
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Message&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.message, results.message, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              }
            ]
          }
</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="4" /></p>
<h3 id="step-5-post-apiassignconsultant-adaptive-card">Step 5: POST /api/assignConsultant 用の Adaptive Card を追加する</h3>
<ul>
<li><strong>postAssignConsultant</strong> 関数を探し、<code>properties</code> ノードの後に以下の <code>static_template</code> ノードを追加します。</li>
</ul>
<pre><code class="language-JSON"> &quot;static_template&quot;: {
            &quot;type&quot;: &quot;AdaptiveCard&quot;,
            &quot;$schema&quot;: &quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;,
            &quot;version&quot;: &quot;1.5&quot;,
            &quot;body&quot;: [
              {
                &quot;type&quot;: &quot;TextBlock&quot;,
                &quot;text&quot;: &quot;Project Overview&quot;,
                &quot;weight&quot;: &quot;Bolder&quot;,
                &quot;size&quot;: &quot;Large&quot;,
                &quot;separator&quot;: true,
                &quot;spacing&quot;: &quot;Medium&quot;
              },              
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Client Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.clientName, results.clientName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Project Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.projectName, results.projectName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Consultant Name&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.consultantName, results.consultantName, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Remaining Forecast&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.remainingForecast, results.remainingForecast, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              },
              {
                &quot;type&quot;: &quot;Container&quot;,
                &quot;items&quot;: [
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;Message&quot;,
                    &quot;weight&quot;: &quot;Bolder&quot;,
                    &quot;spacing&quot;: &quot;Small&quot;
                  },
                  {
                    &quot;type&quot;: &quot;TextBlock&quot;,
                    &quot;text&quot;: &quot;${if(results.message, results.message, 'N/A')}&quot;,
                    &quot;wrap&quot;: true
                  }
                ]
              }            
            ]          
          }

</code></pre>
<p><cc-end-step lab="e5" exercise="2" step="5" /></p>
<h2 id="exercise-3-copilot">Exercise 3: Copilot でプラグインをテストする</h2>
<p>アプリケーションをテストする前に、<code>appPackage\manifest.json</code> ファイルでアプリ パッケージのマニフェスト バージョンを更新します。</p>
<ol>
<li>
<p>プロジェクトの <code>appPackage</code> フォルダーにある <code>manifest.json</code> を開きます。  </p>
</li>
<li>
<p>JSON ファイル内の <code>version</code> フィールドを探します。次のようになっています:<br />
<code>json
   "version": "1.0.1"</code></p>
</li>
<li>
<p>バージョン番号を小さい増分で上げます。例:<br />
<code>json
   "version": "1.0.2"</code></p>
</li>
<li>
<p>変更後、ファイルを保存します。</p>
</li>
</ol>
<h3 id="step-1">Step 1: プラグインをインストールする</h3>
<p>プロジェクトを停止して再起動し、アプリケーション パッケージを再デプロイさせます。<br />
Microsoft Teams が起動します。Copilot に戻ったら、右側のフライアウト 1️⃣ を開いて過去のチャットと宣言型エージェントを表示し、Trey Genie Local エージェント 2️⃣ を選択します。</p>
<p><img alt="Microsoft 365 Copilot showing the Trey Genie agent in action. On the right side there is the custom declarative agent, together with other agents. In the main body of the page there are the conversation starters and the textbox to provide a prompt to the agent." src="../../../../assets/images/extend-m365-copilot-05/run-declarative-copilot-01.png" /></p>
<p><cc-end-step lab="e5" exercise="3" step="1" /></p>
<h3 id="step-2-adaptive-card_1">Step 2: Adaptive Card を表示する</h3>
<p>次のようなプロンプトを試してみましょう。</p>
<p><em>what projects are we doing for adatum?</em></p>
<p>テキスト応答だけでなく、プロジェクト情報を含むリッチ カードも表示されます。</p>
<p><img alt="The response of the agent based on an Adaptive Card showing rich content, including a table with metrics and an image." src="../../../../assets/images/extend-m365-copilot-04/project-adaptive.png" /></p>
<p>次に POST 操作のプロンプトを試します。</p>
<p><em>please charge 1 hour to woodgrove bank in trey research</em></p>
<p>このリクエストは Copilot が API プラグインへ POST でデータを送信する必要があるため、<em>Confirm</em> ボタンで許可を確認する必要があります。</p>
<p><img alt="A card generated by Copilot to confirm sending data to the API plugin." src="../../../../assets/images/extend-m365-copilot-04/bill-hours-confirm.png" /></p>
<p>確認すると、テキスト応答だけでなく、プロジェクトの情報を含むリッチ カードが表示されます。</p>
<p><img alt="The response of the agent based on an Adaptive Card showing rich content about the project status." src="../../../../assets/images/extend-m365-copilot-04/bill-hours.png" /></p>
<p>他のプロンプトも試して、Microsoft 365 Copilot の改善された応答を確認してみてください。</p>
<p><cc-end-step lab="e5" exercise="3" step="2" /></p>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">おめでとうございます！</span></p>
<p>Adaptive Card 応答を最初の API プラグインに追加しました。次の lab では API に認証を追加します。</p>
<p>OAuth 2.0 と Agents Toolkit を使用して認証を追加する lab に進みましょう。これは最も簡単な方法で、Agents Toolkit の自動 Entra ID 登録を使用した F5 プロジェクト開始エクスペリエンスを学習できます。</p>
<p><cc-next url="../06a-add-authentication-ttk" label="Next" /></p>
<details>
<summary>手動ステップによる認証の他の lab </summary>
Agents Toolkit に OAuth 2.0 がサポートされる前に作成された古い lab です。アプリ パッケージに認証を追加し、Web サービスでアクセストークンを検証する方法を示します。主な違いは、Entra ID と Microsoft 365 でのアプリ登録方法です。

これらも自由に試してみてください。すべてこの lab のプロジェクトを基にしています。

  1. **Use OAuth 2.0 with Manual Setup** - Entra ID 登録の詳細をすべて確認しながら進むため、仕組みを理解でき、別の ID プロバイダーに適用する際にも役立ちます  
  <cc-next url="../06b-add-authentication" label="OAuth with Manual Setup" />

  2. **Use Single Sign-on** - Entra ID 認証をシームレスに行う新機能、手動セットアップ  
  <cc-next url="../06c-add-sso" label="Single Sign-on with Manual Setup" />
</details>

<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/extend-m365-copilot/04-add-adaptive-card--ja" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>