
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/ja/pages/extend-m365-copilot/01a-geolocator/">
      
      
        <link rel="prev" href="../01-typespec-declarative-agent/">
      
      
        <link rel="next" href="../02-build-the-api/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>ラボ E1 - インストラクションベースの Geo Locator Game エージェント - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#e1-geo-locator-game" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../../" title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ラボ E1 - インストラクションベースの Geo Locator Game エージェント
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../pages/extend-m365-copilot/01a-geolocator/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link">
        
  
  
    
  
  ようこそ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../make/" class="md-tabs__link">
          
  
  
  Maker 向けエージェントの作成

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  宣言型エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  
  カスタム エンジン エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../copilot-instructions/beginner-agent/" class="md-tabs__link">
          
  
  
  プロンプト エンジニアリング

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../awards/" class="md-tabs__link">
        
  
  
    
  
  アワード

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resources/" class="md-tabs__link">
        
  
  
    
  
  動画など

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ようこそ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Maker 向けエージェントの作成
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Maker 向けエージェントの作成
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot 用エージェント作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB - Copilot Studio agent builder を使用したエージェント作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MAB1 - 最初のエージェント構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS - Microsoft Copilot Studio の概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS1 - 最初のエージェント
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS2 － トピックの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS3 - ツールの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS4 - Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS5 - Power Platform custom connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/copilot-studio/06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS6 - MCP サーバーの利用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA - SharePoint エージェントの概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA1 - 最初の SharePoint エージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../make/sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA2 - SharePoint エージェントの共有
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    セットアップ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            セットアップ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの基礎
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの基礎
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を用いて初めての宣言型エージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    ラボ E1 - インストラクションベースの Geo Locator Game エージェント
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    ラボ E1 - インストラクションベースの Geo Locator Game エージェント
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: テンプレートから宣言型エージェントをスキャフォールドする
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: インストラクションとアイコンを更新する
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: 参照用ファイルを追加する (ボーナス)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      リソース
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API をゼロから構築して統合
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            API をゼロから構築して統合
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E2 - API の構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E3 - 宣言型エージェントと API プラグインの追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E4 - API とプラグインの拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-add-adaptive-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E5 - Adaptive Card の追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    認証
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            認証
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6a - Entra ID 認証を OAuth で追加 (Agents Toolkit)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6b - Entra ID 認証を OAuth で追加 (手動セットアップ)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6c - Entra ID 認証とシングル サインオンの追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    インテグレーション
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            インテグレーション
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E7 - 統合: Microsoft Copilot Connector を使用して Trey Genie にナレッジ機能を追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            カスタム エンジン エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    M365 Agents SDK ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            M365 Agents SDK ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要 - M365 Agents SDK と Semantic Kernel でエージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA1 - Azure AI Foundry でエージェントを準備する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA2 - M365 Agents SDK を使用した最初の エージェント 構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA3 - Azure AI Foundry エージェント と M365 Agents SDK の統合
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MBA4 - エージェントを Copilot Chat に導入
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Teams AI library ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Teams AI library ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    イントロ - Teams AI Library で独自の エージェント を構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/01-custom-engine-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA1 - 最初のカスタムエンジン エージェント (Teams AI library)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/02-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA2 - Azure AI Search でデータをインデックス化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/03-powered-by-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BTA3 - ユーザー エクスペリエンスの強化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/04-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA4 - シングル サインオン認証の追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/teams-ai/05-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA5 - 複雑なタスクを処理するアクションの追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    プロンプト エンジニアリング
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            プロンプト エンジニアリング
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../copilot-instructions/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    エージェント指示ラボ - エージェント指示の改善（初心者向け）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../awards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    アワード
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    動画など
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="e1-geo-locator-game">ラボ E1 - インストラクションベースの <strong>Geo Locator Game</strong> エージェント</h1>
<p>このラボでは、インストラクションとファイルで提供される補足知識を使って、基本的な宣言型エージェントを作成します。<br />
作成するエージェントは、仕事の合間に楽しく学習できるよう、世界各地の都市を探索するゲームを提供します。抽象的な手掛かりを提示し、都市を当てるまでに使った手掛かりが少ないほど高得点になります。ゲーム終了時に最終スコアが表示されます。</p>
<p>このラボで学ぶ内容は次のとおりです。</p>
<ul>
<li>Agents Toolkit テンプレートを使用して宣言型エージェントを作成する  </li>
<li>インストラクションを使ってエージェントを <strong>Geo Locator Game</strong> にカスタマイズする  </li>
<li>アプリを実行してテストする方法を学ぶ  </li>
<li>ボーナス課題として SharePoint Teams サイトを使用する</li>
</ul>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/VDhRFMH3Qbs" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>ビデオでラボの概要を確認しましょう。</div>
        </div>
    <div style="flex: 1; min-width: 0;">
  <div class="floatwide">
  <div class="cc-lab-toc e-path">
      <img src="/copilot-camp/assets/images/path-icons/E-path-heading.png"></img>
      <div>
          <p>Microsoft 365 が AI モデルとオーケストレーションを提供する宣言型エージェントを構築したい場合は、これらのラボを実施してください。</p>
          <ul id="lab-toc">
              <li><strong><a href="/copilot-camp/pages/extend-m365-copilot/index">🏁 はじめに</a></strong></li>
              <li><strong>🔧 セットアップ</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/00-prerequisites">ラボ E0 - セットアップ</a></li>
                  </ul>
              </li>
              <li><strong>🧰 宣言型エージェントの基礎</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01-typespec-declarative-agent">ラボ E1 - 詳細な宣言型エージェントを構築する</a>
                      </li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/01a-geolocator">ラボ E1a - Geo ロケーターゲーム</a></li>
                  </ul>
              </li>
              <li><strong>🛠️ API をゼロから構築して統合する</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/02-build-the-api">ラボ E2 - API を構築する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/03-add-declarative-agent">ラボ E3 - 宣言型エージェント + API を追加する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/04-enhance-api-plugin">ラボ E4 - API + プラグインを強化する</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/05-add-adaptive-card">ラボ E5 - Adaptive Card を追加する</a></li>
                  </ul>
              </li>
              <li><strong>🔐 認証</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06a-add-authentication-ttk">ラボ E6a - Toolkit</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06b-add-authentication">ラボ E6b - 手動</a></li>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/06c-add-sso">ラボ E6c - SSO</a></li>
                  </ul>
              </li>
              <li><strong>🔌 統合</strong>
                  <ul>
                      <li><a href="/copilot-camp/pages/extend-m365-copilot/07-add-graphconnector">ラボ EB - Graph Connector を追加する</a></li>
                  </ul>
              </li>
          </ul>
      </div>
  </div>

  <script>
  (() => {

  // This script decorates the table of contents with a "you are here" indicator.
  const toc = document.getElementsByClassName('cc-lab-toc');
  for (const div of toc) {
      const lis = div.querySelectorAll('li');
      for (const li of lis) {
          const anchor = li.querySelector('a');
          if (anchor) {            // Get the last segment of the current URL path
              const currentPath = window.location.pathname.slice(0, -1).split('/').pop();

              // Get the last segment of the link path
              const linkPath = anchor.getAttribute('href').split('/').pop().replace('.md', '');

              // Compare the last segments
              if (currentPath === linkPath) {
                  const existingSpan = document.querySelector('span.you-are-here');
                  if (existingSpan) {
                      existingSpan.remove();
                  }
                  const span = document.createElement("span");
                  span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
                  span.className = "you-are-here";
                  li.appendChild(span);
              }
          }
      }
  }
  })();
  </script>
  </div>
    </div>
</div>

<h2 id="_1">はじめに</h2>
<p>宣言型エージェントは、 Microsoft 365 Copilot と同じスケーラブルなインフラストラクチャとプラットフォームを活用しながら、特定のニーズにフォーカスできるよう調整されています。<br />
標準の Microsoft 365 Copilot チャットと同じインターフェイスを使用しつつ、特定のタスクにのみ集中する専門家として機能します。</p>
<p>このラボでは、 Agents Toolkit に用意されている既定テンプレートを使って宣言型エージェントを作成するところから始めます。その後、このエージェントを <strong>Geo Locator Game</strong> に特化させるよう修正します。</p>
<p>AI の目的は、世界中のさまざまな都市について学びながら、仕事の合間に楽しい休憩時間を提供することです。都市を推測するための抽象的な手掛かりを提示し、手掛かりを多く使うほど得点は低くなります。ゲーム終了時に最終スコアが明らかになります。</p>
<p><img alt="The initial UI of the Geo Locator Game with a couple of guesses from the user." src="../../../../assets/images/extend-m365-copilot-01/game.png" /></p>
<p>ボーナスとして、エージェントに秘密の日記 🕵🏽 や地図 🗺️ のファイルを参照させ、プレイヤーへのチャレンジ要素を増やします。</p>
<p>それでは始めましょう 💪🏼</p>
<h2 id="exercise-1">Exercise 1: テンプレートから宣言型エージェントをスキャフォールドする</h2>
<p>宣言型エージェントに必要なファイル構成さえ把握していれば、任意のエディターで作成できます。ただし、 Agents Toolkit を使用するとファイル生成だけでなく、デプロイや公開も簡単に行えます。<br />
そのため、このラボでは Agents Toolkit を使用して作業を簡素化します。</p>
<h3 id="step-1-agents-toolkit">Step 1: Agents Toolkit をインストールする</h3>
<ul>
<li>** Visual Studio Code ** の拡張機能タブを開き、 <strong>Microsoft 365 Agents Toolkit</strong> を検索します。  </li>
<li>選択してインストールします。</li>
</ul>
<p><cc-end-step lab="e1a" exercise="1" step="1" /></p>
<h3 id="step-2-agents-toolkit">Step 2: Agents Toolkit で宣言型エージェントアプリを作成する</h3>
<p>左側の <strong>Agents Toolkit</strong> 拡張機能 1️⃣ を開き、 <strong>Create a New Agent/App</strong> 2️⃣ を選択します。</p>
<p><img alt="The UI of the Agents Toolkit to start creating a new app with the 'Create a New Agent' button highlighted." src="../../../../assets/images/extend-m365-copilot-01/atk-create-new-agent.png" /></p>
<p>パネルが開くので、プロジェクトタイプの一覧から <strong>Declarative Agent</strong> を選択します。</p>
<p><img alt="The project types available when creating a new app with Agents Toolkit. Options include 'Agent', which is highlighted." src="../../../../assets/images/extend-m365-copilot-01/atk-da.png" /></p>
<p>続いて、基本の宣言型エージェントを作成するか、 API プラグイン付きにするかを尋ねられます。 <strong>No Action</strong> を選択してください。</p>
<p><img alt="The Agents Toolkit app creation flow with the type of Declarative Agent with 'No plugin' selected." src="../../../../assets/images/extend-m365-copilot-01/atk-no-action.png" /></p>
<div class="admonition tip">
<p class="admonition-title">ここでアクション付きにしない理由</p>
<p>次のラボで REST API を構築し、その API を宣言型エージェントにアクションとして統合する方法を学びます。今回は宣言型エージェントの作成だけに集中しましょう。小さなステップから！</p>
</div>
<p>次に、プロジェクトフォルダーを作成するディレクトリを入力します。</p>
<p><img alt="The Agents Toolkit app creation flow with the prompt to provide a target path where to store the new app." src="../../../../assets/images/extend-m365-copilot-01/atk-folder.png" /></p>
<p>アプリケーション名として <code>Geo Locator Game</code> と入力し、 Enter キーを押します。</p>
<p><img alt="The Agents Toolkit app creation flow with the prompt to provide a name for the app." src="../../../../assets/images/extend-m365-copilot-01/atk-app-name.png" /></p>
<p>指定したフォルダーに数秒でプロジェクトが作成され、新しい Visual Studio Code ウィンドウで開きます。これが作業用フォルダーです。</p>
<p><img alt="Visual Studio Code with the new app scaffolded and ready to be extendend and the README file on the screen." src="../../../../assets/images/extend-m365-copilot-01/atk-scaffold.png" /></p>
<p>お疲れさまです！ベースの宣言型エージェントがセットアップできました。次に、ファイル内容を確認し、 <strong>Geo Locator Game</strong> にカスタマイズしましょう。</p>
<p><cc-end-step lab="e1a" exercise="1" step="2" /></p>
<h3 id="step-3-agents-toolkit">Step 3: Agents Toolkit でアカウントを設定する</h3>
<p>左側の <strong>Agents Toolkit</strong> アイコン 1️⃣ を選択し、"Accounts" セクションの <strong>Sign in to Microsoft 365</strong> 2️⃣ をクリックして、自身の Microsoft 365 アカウントでサインインします。</p>
<p><img alt="The UI of Agents Toolkit to allow logging into a target Microsoft 365 tenant." src="../../../../assets/images/extend-m365-copilot-01/atk-accounts.png" /></p>
<p>ブラウザーが開き、 Microsoft 365 へのサインインを求めます。"You are signed in now and close this page" と表示されたらページを閉じます。</p>
<p>"Custom App Upload Enabled" に緑のチェックマークが付いていることを確認します。付いていない場合、そのユーザーが Teams アプリをアップロードする権限を持っていません。ラボの Exercise 1 の手順を参照して設定してください。</p>
<p>次に "Copilot Access Enabled" に緑のチェックマークがあるか確認します。無い場合、そのユーザーが Copilot のライセンスを持っていません。ライセンスが必要です。</p>
<p><img alt="The UI of Agents Toolkit after logging in, when the checkmarks are green." src="../../../../assets/images/extend-m365-copilot-01/atk-accounts-logged.png" /></p>
<p>それではコードツアーを行いましょう。</p>
<p><cc-end-step lab="e1a" exercise="1" step="3" /></p>
<h3 id="step-4">Step 4: アプリ内のファイルを理解する</h3>
<p>ベースプロジェクトの構成は次のとおりです。</p>
<table>
<thead>
<tr>
<th>フォルダー／ファイル</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.vscode</code></td>
<td>デバッグ用 VS Code 設定ファイル</td>
</tr>
<tr>
<td><code>appPackage</code></td>
<td>Teams アプリのマニフェスト、エージェントマニフェスト、 API 仕様 (存在する場合) のテンプレート</td>
</tr>
<tr>
<td><code>env</code></td>
<td>デフォルトの <code>.env.dev</code> を含む環境設定ファイル</td>
</tr>
<tr>
<td><code>appPackage/color.png</code></td>
<td>アプリのロゴ画像</td>
</tr>
<tr>
<td><code>appPackage/outline.png</code></td>
<td>アプリのロゴ（アウトライン）画像</td>
</tr>
<tr>
<td><code>appPackage/declarativeAgent.json</code></td>
<td>宣言型エージェントの設定および構成</td>
</tr>
<tr>
<td><code>appPackage/instruction.txt</code></td>
<td>宣言型エージェントの動作を定義するインストラクション</td>
</tr>
<tr>
<td><code>appPackage/manifest.json</code></td>
<td>宣言型エージェントのメタデータを定義する Teams アプリマニフェスト</td>
</tr>
<tr>
<td><code>m365agent.yml</code></td>
<td>Agents Toolkit のメインプロジェクトファイル。プロパティと構成ステージを定義</td>
</tr>
</tbody>
</table>
<p>このラボで特に重要なのは <strong>appPackage/instruction.txt</strong> です。エージェントの主要ディレクティブが含まれています。<br />
プレーンテキストなので、自然言語でインストラクションを記述できます。</p>
<p>もう一つ重要なのは <strong>appPackage/declarativeAgent.json</strong> で、 Microsoft 365 Copilot を新しい宣言型エージェントで拡張するためのスキーマが定義されています。主なプロパティは以下のとおりです。</p>
<ul>
<li><code>$schema</code>: スキーマ参照  </li>
<li><code>version</code>: スキーマバージョン  </li>
<li><code>name</code>: 宣言型エージェントの名前  </li>
<li><code>description</code>: 説明  </li>
<li><code>instructions</code>: <strong>instructions.txt</strong> へのパス。ここに直接テキストで記述することも可能ですが、本ラボでは <strong>instructions.txt</strong> を使用します。</li>
</ul>
<p>さらに <strong>appPackage/manifest.json</strong> には、パッケージ名、開発者名、アプリで利用するエージェントの参照など、重要なメタデータが含まれます。次の抜粋はその一部です。</p>
<pre><code class="language-JSON">&quot;copilotAgents&quot;: {
        &quot;declarativeAgents&quot;: [            
            {
                &quot;id&quot;: &quot;declarativeAgent&quot;,
                &quot;file&quot;: &quot;declarativeAgent.json&quot;
            }
        ]
    },
</code></pre>
<p>ロゴファイル <code>color.png</code> と <code>outline.png</code> を差し替えてブランドに合わせることもできます。本ラボでは <strong>color.png</strong> を変更してエージェントを目立たせます。</p>
<p><cc-end-step lab="e1a" exercise="1" step="4" /></p>
<h2 id="exercise-2">Exercise 2: インストラクションとアイコンを更新する</h2>
<h3 id="step-1">Step 1: アイコンとマニフェストを更新する</h3>
<p>まずはロゴを差し替えます。 <a href="../../../../assets/images/extend-m365-copilot-01/color.png" target="_blank">こちら</a> の画像をコピーし、プロジェクトルートの <strong>appPackage</strong> フォルダーにある同名ファイルと置き換えます。</p>
<p>次に、ルートプロジェクトの <strong>appPackage/manifest.json</strong> を開き、 <strong>copilotAgents</strong> ノードを探します。 <code>declarativeAgents</code> 配列の最初の <code>id</code> を <code>declarativeAgent</code> から <code>dcGeolocator</code> に変更して、一意の ID にします。</p>
<pre>
 "copilotAgents": {
        "declarativeAgents": [            
            {
                "id": "<b>dcGeolocator</b>",
                "file": "declarativeAgent.json"
            }
        ]
    },
</pre>

<p>続いて <strong>appPackage/instruction.txt</strong> を開き、下記のインストラクションで既存内容を上書きしてください。</p>
<pre><code class="language-txt">System Role: You are the game host for a geo-location guessing game. Your goal is to provide the player with clues about a specific city and guide them through the game until they guess the correct answer. You will progressively offer more detailed clues if the player guesses incorrectly. You will also reference PDF files in special rounds to create a clever and immersive game experience.

Game play Instructions:
Game Introduction Prompt
Use the following prompt to welcome the player and explain the rules:
Welcome to the Geo Location Game! I’ll give you clues about a city, and your task is to guess the name of the city. After each wrong guess, I’ll give you a more detailed clue. The fewer clues you use, the more points you score! Let’s get started. Here’s your first clue:
Clue Progression Prompts
Start with vague clues and become progressively specific if the player guesses incorrectly. Use the following structure:
Clue 1: Provide a general geographical clue about the city (e.g., continent, climate, latitude/longitude).
Clue 2: Offer a hint about the city’s landmarks or natural features (e.g., a famous monument, a river).
Clue 3: Give a historical or cultural clue about the city (e.g., famous events, cultural significance).
Clue 4: Offer a specific clue related to the city’s cuisine, local people, or industry.
Response Handling
After the player’s guess, respond accordingly:

If the player guesses correctly, say:
That’s correct! You’ve guessed the city in [number of clues] clues and earned [score] points. Would you like to play another round?
If the guess is wrong, say:
Nice try! [followed by more clues]
PDF-Based Scenario
For special rounds, use a PDF file to provide clues from a historical document, traveler's diary, or ancient map:
This round is different! I’ve got a secret document to help us. I’ll read clues from this [historical map/traveler’s diary] and guide you to guess the city. Here’s the first clue:
Reference the specific PDF to extract details: Do not provide the citations and also link to the document since its a secret document for generating the questions.
Traveler's Diary PDF,Historical Map PDF. Do not provide the citations and also link to the document since its a secret document for generating the questions.
Use emojis where necessary to have friendly tone. 
Scorekeeping System
Track how many clues the player uses and calculate points:

1 clue: 10 points
2 clues: 8 points
3 clues: 5 points
4 clues: 3 points
End of Game Prompt
After the player guesses the city or exhausts all clues, prompt:
Would you like to play another round, try a special challenge?

</code></pre>
<p>次の手順で、ユーザーがエージェントとやり取りしやすくなるよう、会話スターターを追加します。</p>
<div class="admonition tip">
<p class="admonition-title"><strong>appPackage</strong> 内のファイルをモジュール化</p>
<p><strong>appPackage/declarativeAgent.json</strong> の以下の行に注目してください。</p>
<p><code>"instructions": "$[file('instruction.txt')]",</code></p>
<p>これは <strong>instruction.txt</strong> からインストラクションを読み込む指定です。<br />
<strong>appPackage</strong> 内の他の JSON ファイルでも、この手法でファイルを分割管理できます。</p>
</div>
<p><cc-end-step lab="e1a" exercise="2" step="1" /></p>
<h3 id="step-2">Step 2 : 会話スターターを追加する</h3>
<p>宣言型エージェントに会話スターターを追加すると、ユーザーエンゲージメントを高められます。</p>
<p>会話スターターの主なメリットは以下のとおりです。</p>
<ul>
<li><strong>エンゲージメント</strong>: 交流を始めやすくし、ユーザーが気軽に参加できる  </li>
<li><strong>コンテキスト設定</strong>: 会話のトーンとトピックを示し、進行方向をガイド  </li>
<li><strong>効率性</strong>: 明確なフォーカスを提示することで曖昧さを減らし、スムーズに会話が進む  </li>
<li><strong>ユーザー維持</strong>: 興味を引き続け、再利用を促進  </li>
</ul>
<p><code>declarativeAgent.json</code> を開き、 <code>instructions</code> ノードの直後にカンマ <code>,</code> を追加し、次のコードを貼り付けます。</p>
<pre><code class="language-JSON"> &quot;conversation_starters&quot;: [
      { 
            &quot;title&quot;: &quot;Getting Started&quot;,
            &quot;text&quot;:&quot;I am ready to play the Geo Location Game! Give me a city to guess, and start with the first clue.&quot;          

         },
        {
            &quot;title&quot;: &quot;Ready for a Challenge&quot;,
            &quot;text&quot;: &quot;Let us try something different. Can we play a round using the travelers diary?&quot;
        },
        { 
            &quot;title&quot;: &quot;Feeling More Adventurous&quot;,
            &quot;text&quot;: &quot;I am in the mood for a challenge! Can we play the game using the historical map? I want to see if I can figure out the city from those ancient clues.&quot;
        }
    ]
</code></pre>
<p>すべての変更が完了したので、テストに進みます。</p>
<p><cc-end-step lab="e1a" exercise="2" step="2" /></p>
<h3 id="step-3">Step 3: アプリをテストする</h3>
<p>アプリをテストするには、 <code>Visual Studio Code</code> の <code>Agents Toolkit</code> 拡張機能を開きます。左ペインの "LIFECYCLE" で <strong>Provision</strong> を選択します。<br />
Agents Toolkit が <strong>appPackage</strong> 内のファイルを ZIP 化し、エージェントを自身のアプリカタログにインストールしてくれます。</p>
<p><img alt="The UI of Agents Toolkit highlighting the 'Provision' command under the 'Lifecycle' group of commands." src="../../../../assets/images/extend-m365-copilot-01/atk-provision.png" /></p>
<p>Microsoft 365 Copilot BizChat を開きます: <a href="https://microsoft365.com/copilot/" target="_blank">https://microsoft365.com/copilot/</a><br />
開発者テナントのアカウントでサインインしてください。</p>
<p>Copilot アプリが読み込まれたら、右側のリストから <strong>Geo Locator Game</strong> を見つけます。</p>
<p><img alt="The UI of Microsoft 365 Copilot with the list of agents on the right side and the 'Geo Locator Game' agent highlighted." src="../../../../assets/images/extend-m365-copilot-01/launch-geo.png" /></p>
<p>見つからない場合は "see more" を展開して探してください。</p>
<p>起動すると、そのエージェント専用のチャットウィンドウが開き、会話スターターが表示されます。</p>
<p><img alt="The UI of Microsoft 365 Copilot when the 'Geo Locator Game' agent is selected. The image highlights the conversation starters." src="../../../../assets/images/extend-m365-copilot-01/launched-geo.png" /></p>
<p>会話スターターのいずれかを選択すると、入力ボックスに自動で挿入されます。 Enter キーを押すまで送信されません 🟢</p>
<p>ゲームのデモはこちらです。</p>
<p><img alt="A video of the 'Geo Locator Game' in action with a user guessing a couple of cities and the agent showing the collected points." src="../../../../assets/images/extend-m365-copilot-01/demo.gif" /></p>
<p><cc-end-step lab="e1a" exercise="2" step="3" /></p>
<h2 id="exercise-3">Exercise 3: 参照用ファイルを追加する (ボーナス)</h2>
<p>同じゲームを繰り返すだけでは飽きてしまいます。ゲームを楽しく保つには、定期的に更新されるデータへのアクセスが必要です。ここでは、エージェントに SharePoint サイトや OneDrive のファイルを参照させる機能を追加し、チャレンジを強化します。</p>
<h3 id="step-1-sharepoint">Step 1: SharePoint にファイルをアップロードする</h3>
<p>2 つの PDF が入った ZIP ファイルを <a href="https://download-directory.github.io/?url=https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab01a-declarative-copilot/geo-locator-lab-sample/sharepoint-docs&amp;filename=sharepoint-docs" target="_blank">こちら</a> からダウンロードしてください。</p>
<p>ZIP を展開し、同じテナントの SharePoint Teams サイトの <strong>Documents</strong> ドキュメントライブラリに <strong>historical_map.pdf</strong> と <strong>travelers_diary.pdf</strong> をアップロードします。</p>
<p>サイトの絶対 URL をコピーします。例: <code>https://xyz.sharepoint.com/sites/contoso</code></p>
<blockquote>
<p>[!NOTE]<br />
ファイルやフォルダーの完全パスは、 SharePoint の “Copy direct link” 機能で取得できます。対象を右クリックし <strong>Details</strong> を選択後、 <strong>Path</strong> のコピーアイコンをクリックしてください。</p>
</blockquote>
<p>完了したら次の手順に進みます。</p>
<p><cc-end-step lab="e1a" exercise="3" step="1" /></p>
<h3 id="step-2_1">Step 2: 宣言型エージェントマニフェストを更新する</h3>
<p><strong>.env.dev</strong> を開き、 <code>SP_SITE_URL</code> という新しい変数を作成して、先ほどの SharePoint サイトの絶対 URL を値に設定します。</p>
<p>続いて <strong>appPackage/declarativeAgent.json</strong> を開き、 <code>conversation_starters</code> 配列の後ろにカンマ <code>,</code> を追加し、下記の配列オブジェクトを貼り付けます。これでエージェントが特定の SharePoint サイトのドキュメントを参照できるようになります。</p>
<pre><code class="language-JSON"> &quot;capabilities&quot;: [
        {

            &quot;name&quot;: &quot;OneDriveAndSharePoint&quot;,
            &quot;items_by_url&quot;: [
            {
                &quot;url&quot;: &quot;${{SP_SITE_URL}}&quot;
            }
        ]
        }
    ]
</code></pre>
<p>これにより、ゲームを盛り上げるためのドキュメント参照が可能になりました。 URL の数に制限はありません 💪🏼</p>
<p><cc-end-step lab="e1a" exercise="3" step="2" /></p>
<h3 id="step-3_1">Step 3: アプリマニフェストをアップグレードする</h3>
<p><strong>appPackage/manifest.json</strong> を開き、 <code>version</code> を <code>"1.0.0"</code> から <code>"1.0.1"</code> に更新して変更を反映させます。</p>
<p><cc-end-step lab="e1a" exercise="3" step="3" /></p>
<h3 id="step-4_1">Step 4: アプリをテストする</h3>
<ol>
<li><code>Visual Studio Code</code> の <code>Agents Toolkit</code> 拡張機能に戻り、左ペインの "LIFECYCLE" で <strong>Provision</strong> を選択して、更新済みエージェントをパッケージ化しアプリカタログにインストールします。  </li>
<li>Microsoft 365 Copilot BizChat <a href="https://microsoft365.com/copilot/" target="_blank">https://microsoft365.com/copilot/</a> を開きます。  </li>
<li><strong>Geo Locator Game</strong> を再度起動します。</li>
</ol>
<p><img alt="The UI of Microsoft 365 Copilot when the 'Geo Locator Game' agent is selected. The image highlights the conversation starters." src="../../../../assets/images/extend-m365-copilot-01/launched-geo.png" /></p>
<p>今回は旅行日記を使ったチャレンジを試してください。 2 番目の会話スターターを選択します。</p>
<p><img alt="The 'Geo Locator Game' when relying on the travel diary. The agent answers providing a reference to the travelers_diary.pdf document stored in SharePoint Online." src="../../../../assets/images/extend-m365-copilot-01/traveller.gif" /></p>
<p>これであなたは宣言型エージェントのボスです。詳細は次のビデオをご覧ください。</p>
<div class="tinyVideo">
      <iframe src="//www.youtube.com/embed/QTP4PfXyyNk" frameborder="0" allowfullscreen></iframe>
      <div>宣言型エージェント入門</div>
    </div>

<p><cc-end-step lab="e1a" exercise="3" step="4" /></p>
<h2 id="_2">リソース</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/overview-declarative-copilot" target="_blank">宣言型エージェント</a></li>
<li><a href="https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/declarative-agent-manifest" target="_blank">宣言型エージェントマニフェスト スキーマ</a></li>
<li><a href="https://learn.microsoft.com/microsoftsearch/semantic-index-for-copilot#supported-content-types" target="_blank">サポートされるコンテンツタイプ</a></li>
<li><a href="https://learn.microsoft.com/microsoft-365-copilot/extensibility/declarative-agent-capabilities-ids?tabs=explorer" target="_blank">宣言型エージェントの機能</a></li>
<li><a href="https://learn.microsoft.com/microsoftteams/platform/concepts/deploy-and-publish/appsource/prepare/review-copilot-validation-guidelines" target="_blank">エージェントの検証ガイドライン</a></li>
</ul>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">おめでとうございます！</span></p>
<p>素晴らしい！ゲームエージェントを構築できました 🎉 次のラボでは REST API を作成し、それを使ったプラグインを構築して、別のエージェントで実際のビジネスシナリオを解決していきます。ワクワクですね。 <strong>Next</strong> を選択して次のラボに進みましょう。</p>
<p><cc-next /></p>
<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/extend-m365-copilot/01a-geolocator--ja" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>