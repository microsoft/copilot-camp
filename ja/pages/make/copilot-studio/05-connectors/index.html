
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/ja/pages/make/copilot-studio/05-connectors/">
      
      
        <link rel="prev" href="../04-extending-m365-copilot/">
      
      
        <link rel="next" href="../06-mcp/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Lab MCS5 - Power Platform カスタム コネクタ - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-mcs5-power-platform" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../../../" title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab MCS5 - Power Platform カスタム コネクタ
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../../pages/make/copilot-studio/05-connectors/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../" class="md-tabs__link">
        
  
  
    
  
  ようこそ

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Maker 向けエージェントの作成

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../extend-m365-copilot/" class="md-tabs__link">
          
  
  
  宣言型エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../custom-engine/" class="md-tabs__link">
          
  
  
  カスタム エンジン エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../copilot-instructions/beginner-agent/" class="md-tabs__link">
          
  
  
  プロンプト エンジニアリング

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../awards/" class="md-tabs__link">
        
  
  
    
  
  アワード

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../resources/" class="md-tabs__link">
        
  
  
    
  
  動画など

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../" title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ようこそ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Maker 向けエージェントの作成
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Maker 向けエージェントの作成
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot 向けエージェントの作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MAB - Copilot Studio エージェントビルダーによるエージェント作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB1 - 最初のエージェントを作成する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS - Microsoft Copilot Studio の理解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS1 - 初めてのエージェント
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS2 - トピックの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MCS3 - ツールの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS4 - Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab MCS5 - Power Platform カスタム コネクタ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab MCS5 - Power Platform カスタム コネクタ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1-rest-api" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1 : REST API の作成
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2 : カスタム コネクタの作成
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3 : カスタム コネクタの利用
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS6 - MCP サーバーの利用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA - SharePoint エージェントの理解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA1 - 最初の SharePoint エージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA2 - SharePoint エージェントの共有
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    セットアップ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            セットアップ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの基礎
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの基礎
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E1 - Microsoft 365 Agents Toolkit と TypeSpec を使った Declarative エージェントの初回構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1 - Instructions ベースの Geo Locator Game エージェント
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API をゼロから構築して統合
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            API をゼロから構築して統合
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E2 - API の構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E3 - 宣言型エージェントと API プラグインの追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E4 - API とプラグインの拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/05-add-adaptive-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E5 - Adaptive Card の追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    認証
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            認証
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6a - OAuth で Entra ID 認証を追加 (Agents Toolkit)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6b - OAuth を使用した Entra ID 認証の追加 (手動セットアップ)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6c - Entra ID 認証を使用した Single Sign-on の追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    インテグレーション
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            インテグレーション
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E7 - 統合: Microsoft Copilot Connector を使った Trey Genie の Knowledge 機能追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            カスタム エンジン エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    M365 Agents SDK ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            M365 Agents SDK ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要 - M365 Agents SDK と Semantic Kernel でエージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA1 - Azure AI Foundry でエージェントを準備する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA2 - M365 Agents SDK を使用した初めてのエージェント構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA3 - Azure AI Foundry エージェント と M365 Agents SDK の統合
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MBA4 - エージェントを Copilot Chat に追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Teams AI library ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Teams AI library ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    はじめに - Teams AI Library で独自エージェントを構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/01-custom-engine-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA1 - Teams AI library で最初のカスタムエンジン エージェント
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/02-rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA2 - Azure AI Search でデータをインデックス
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/03-powered-by-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA3 - ユーザー エクスペリエンスの向上
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/04-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA4 - シングル サインオン認証の追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../custom-engine/teams-ai/05-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA5 - 複雑なタスクを処理するアクションの追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    プロンプト エンジニアリング
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            プロンプト エンジニアリング
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../copilot-instructions/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    エージェントインストラクション ラボ - エージェントの指示を改善する（初心者向け）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../awards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    アワード
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    動画など
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-mcs5-power-platform">Lab MCS5 - Power Platform カスタム コネクタ</h1>
<p>このラボでは、Microsoft Copilot Studio で作成したエージェントを Power Platform のカスタム コネクタで拡張する方法を学習します。具体的には、REST API を使用して仮想的な求人候補者リストを管理します。API では、次の機能を提供しています。</p>
<ul>
<li>候補者の一覧取得</li>
<li>特定の候補者の取得</li>
<li>新しい候補者の追加</li>
<li>候補者の削除</li>
</ul>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/f_HrMbg6kOU" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>このビデオでラボの概要を確認できます。</div>
    </div>
    <div style="flex: 1; min-width: 0;">
   <div class="floatwide">
   <div class="cc-lab-toc mcs-path">
     <img src="/copilot-camp/assets/images/path-icons/MCS-path-heading.png"></img>
     <div>
       <p>Microsoft Copilot Studio でエージェントを構築したい場合は、次のラボを実施してください</p>
       <ul>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/00-prerequisites/">MCS0 - セットアップ</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/01-first-agent/">MCS1 - 最初のエージェント</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/02-topics/">MCS2 - トピックの定義</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/03-actions/">MCS3 - ツールの定義</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/04-extending-m365-copilot/">MCS4 - Microsoft 365 Copilot の拡張</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/05-connectors/">MCS5 - カスタム コネクタの利用</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/06-mcp/">MCS6 - MCP サーバーの利用</a></li>
         <li><a href="/copilot-camp/ja/pages/make/copilot-studio/07-autonomous/">MCS7 - 自律型エージェントの作成</a></li>
       </ul>
     </div>
   </div>

   <script>
   (() => {

   // This script decorates the table of contents with a "you are here" indicator.
   const toc = document.getElementsByClassName('cc-lab-toc');
   for (const div of toc) {
       const lis = div.querySelectorAll('li');
       for (const li of lis) {
           const anchor = li.querySelector('a');
           if (location.href.includes(anchor.href)) {
               const span = document.createElement("span");
               span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
               li.appendChild(span);
           }
       }    
   }
   })();
   </script>
   <!-- 
     <div class="cc-mcs-lab-steps">
       <h4>目次</h4>
       <cc-table-of-contents />
     </div> -->
   </div>
    </div>
</div>

<p>Microsoft 365 Copilot の Copilot Studio では、これらの機能を利用して、前の <a href="../04-extending-m365-copilot" target="_blank">Lab MCS4</a> で作成したカスタム エージェントの可能性を高めることができます。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>このラボは前の <a href="../04-extending-m365-copilot" target="_blank">Lab MCS4</a> を基盤としています。同じエージェントを使用し、その機能を拡張できます。</p>
</div>
<p>このラボで学習する内容:</p>
<ul>
<li>REST API を Power Platform のカスタム コネクタとして公開する方法</li>
<li>Power Platform で外部 REST API との通信を保護する方法</li>
<li>カスタム コネクタをエージェントから利用する方法</li>
</ul>
<h2 id="exercise-1-rest-api">Exercise 1 : REST API の作成</h2>
<p>このラボでは簡単にするため、あらかじめ用意された REST API を使用します。このエクササイズでは、ローカルで実行できるように API をダウンロードして構成します。</p>
<h3 id="step-1-rest-api">Step 1: REST API のダウンロードとテスト</h3>
<p>サンプル REST API は TypeScript と Node.js で構築された Azure Function で、<code>HR Service</code> という名前です。ソース コードは <a href="https://download-directory.github.io/?url=https://github.com/microsoft/copilot-camp/tree/main/src/make/copilot-studio/path-m-lab-mcs5-connectors/hr-service&amp;filename=hr-service" target="_blank">こちら</a> からダウンロードできます。</p>
<p>ZIP を展開し、対象フォルダーを Visual Studio Code で開きます。以下のスクリーンショットはプロジェクト構成の概要です。</p>
<p><img alt="The outline of the HR Service project in Visual Studio Code. There are an http folder with a couple of .http files to test the API, a src folder with sample data and the actual azure function, two Open API specification files, some JSON configuration files." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-01.png" /></p>
<p>プロジェクトの主な要素は次のとおりです。</p>
<ul>
<li><code>http</code>: Visual Studio Code で API をテストするための .http ファイルが含まれています。</li>
<li><code>src/data/candidates.json</code>: サービスの初期データ ソースとして使用される仮想的な候補者リストの JSON ファイル。</li>
<li><code>src/functions/candidatesFunction.ts</code>: Azure Function の実装。</li>
<li><code>src/openapi.json</code>: Azure Function の Open API 仕様 (JSON)。</li>
<li><code>src/openapi.yaml</code>: Azure Function の Open API 仕様 (YAML)。</li>
<li><code>askCandidateData.json</code>: 新規候補者を登録するためのアダプティブ カードの JSON。</li>
<li><code>dev-tunnel-steps.md</code>: ローカルで実行中の REST API へリバース プロキシを構築する Dev Tunnel 手順。</li>
<li><code>local.settings.json.sample</code>: 後で使用するサンプル構成ファイル。</li>
</ul>
<p><code>local.settings.json.sample</code> を <code>local.settings.json</code> にリネームし、F5 キーでプロジェクトを開始します。
Visual Studio Code で <code>http/ht-service.http</code> を開き、<code>http://localhost:7071/api/candidates</code> に対する GET リクエストの <strong>Send request</strong> を選択して候補者一覧を取得します。
画面右側にレスポンス ヘッダーと JSON 形式の候補者一覧が表示されます。</p>
<p><img alt="The HTTP request in action in Visual Studio Code. On the left side there is the .http file with the list of requests and the one to list the candidates is highlighted. On the right side there is the response for the get list of candidates request, with some HTTP headers and the JSON body of the response. In the lower part of the screen there is the **Terminal** with an highlighted message about OAuth disabled." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-02.png" /></p>
<p>画面下部の <strong>Terminal</strong> ウィンドウには、呼び出しのトレースと <code>OAuth is disabled. Skipping token validation</code> というメッセージが表示されています。現在 API は匿名アクセスが可能な状態です。</p>
<p><cc-end-step lab="mcs5" exercise="1" step="1" /></p>
<h3 id="step-2-entra-id-api">Step 2: Entra ID での API 登録</h3>
<p>次に、API へのアクセスを保護します。まずブラウザーで <a href="https://entra.microsoft.com" target="_blank">https://entra.microsoft.com</a> を開き、対象 Microsoft 365 テナントの職場アカウントで Microsoft Entra 管理センターにサインインします。左メニューから 1️⃣ <strong>App registrations</strong> を選択し、2️⃣ <strong>+ New registration</strong> をクリックして新しいアプリケーションを登録します。</p>
<p><img alt="The Microsoft Entra admin center user interface with highlighting of the **App registration** menu and of the **+ New registration** command." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-03.png" /></p>
<p><code>Register an application</code> ページで、アプリケーション名に <code>HR-Service-API</code> などを入力し、対象テナントのみをサポートするように設定して <strong>Register</strong> を選択します。</p>
<p><img alt="The page to register a new application with the application name &quot;HR-Service-API&quot;, the selection of single tenant authentication, and the button to register the application highlighted." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-04.png" /></p>
<p>登録後に表示される <strong>Overview</strong> ページから、Client ID と Tenant ID を控えておきます。</p>
<p>左メニューの 1️⃣ <strong>Expose an API</strong> を選択し、2️⃣ <strong>+ Add a scope</strong> をクリックします。最初のスコープ追加時には <strong>Application ID URI</strong> を設定する必要があります。既定値 <code>api://&lt;Client-Id&gt;</code> をそのまま使用し <strong>Save and continue</strong> を選択します。右側のパネルでスコープを 3️⃣ 設定し、4️⃣ <strong>Add scope</strong> を選択します。</p>
<p><img alt="The page to configure a new permission scope for the application. On the right side there is a panel to configure bunch of settings for the new permission scope." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-05.png" /></p>
<p>以下はスコープ設定例です。</p>
<ul>
<li>Scope name: <code>HR.Consume</code></li>
<li>Who can consent?: <code>Admins and users</code></li>
<li>Admin consent display name: <code>HR.Consume</code></li>
<li>Admin consent description: <code>Allows consuming the HR Service</code></li>
<li>User consent display name: <code>HR.Consume</code></li>
<li>User consent description: <code>Allows consuming the HR Service</code></li>
<li>State: <strong>Enabled</strong></li>
</ul>
<p>スコープを追加すると、一覧に表示されます。</p>
<p><img alt="The permission scope configured for the current application. There is the scope name, who can consent, the admin consent display name, the user consent display name, and the state as enabled." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-06.png" /></p>
<p>次に 1️⃣ <strong>Manifest</strong> を選択し、2️⃣ <strong>Microsoft Graph App Manifest (new)</strong> で開き、3️⃣ <code>requestedAccessTokenVersion</code> を <code>2</code> に変更します。これにより v2.0 の JWT トークンを要求することを示します。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Microsoft Graph App Manifest とトークン v2.0 については <a href="https://learn.microsoft.com/en-us/entra/identity-platform/reference-microsoft-graph-app-manifest" target="_blank">こちら</a> を参照してください。</p>
</div>
<p><img alt="The page to edit the manifest of the Entra application. There is the editor with highlighted the property requestedAccessTokenVersion and value of &quot;2&quot;." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-07.png" /></p>
<p>Visual Studio Code に戻り、<code>local.settings.json</code> を更新します。<code>&lt;Client-ID&gt;</code> と <code>&lt;Tenant-ID&gt;</code> を実際の値に置き換え、<code>UseOAuth</code> を <code>true</code> に設定します。</p>
<pre><code class="language-JSON">{
  &quot;IsEncrypted&quot;: false,
  &quot;Values&quot;: {
    &quot;AzureWebJobsStorage&quot;: &quot;UseDevelopmentStorage=true&quot;,
    &quot;FUNCTIONS_WORKER_RUNTIME&quot;: &quot;node&quot;,
    &quot;AAD_APP_CLIENT_ID&quot;: &quot;&lt;Client-ID&gt;&quot;,
    &quot;AAD_APP_TENANT_ID&quot;: &quot;&lt;Tenant-ID&gt;&quot;,
    &quot;AAD_APP_OAUTH_AUTHORITY&quot;: &quot;https://login.microsoftonline.com/&lt;Tenant-ID&gt;&quot;,
    &quot;UseOAuth&quot;: false
  }
}
</code></pre>
<p>API プロジェクトを再起動すると、API は保護され、Authorization ヘッダーに OAuth 2.0 トークンを要求するようになります。トークンがない、または無効な場合、HTTP 401 (Unauthorized) が返されます。</p>
<p><cc-end-step lab="mcs5" exercise="1" step="2" /></p>
<h3 id="step-3-dev-tunnel">Step 3: Dev Tunnel の構成</h3>
<p>次に、REST API を公開 URL でアクセスできるようにします。ローカルで実行しているため、reverse proxy ツールが必要です。ここでは Microsoft 提供の dev tunnel を使用します。</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/get-started" target="_blank">こちらの手順</a> に従って dev tunnel をインストールします。</li>
<li>次のコマンドでサインインします。</li>
</ul>
<pre><code class="language-console">devtunnel user login
</code></pre>
<ul>
<li>次のコマンドでトンネルをホストします。</li>
</ul>
<pre><code class="language-console">devtunnel create hr-service -a --host-header unchanged
devtunnel port create hr-service -p 7071
devtunnel host hr-service
</code></pre>
<p>コンソールに接続情報が表示されます。</p>
<p><img alt="The devtunnel running in a console window showing the hosting port, the connect via browser URL, and the URL to inspect network activity." src="../../../../../assets/images/extend-m365-copilot-06/devtunnel-output.png" /></p>
<p>「Connect via browser」の URL をコピーして保管してください。</p>
<p>ラボの作業中は devtunnel コマンドを実行したままにします。再起動が必要な場合は <code>devtunnel host hr-service</code> を再実行してください。</p>
<p><cc-end-step lab="mcs5" exercise="1" step="3" /></p>
<h3 id="step-4-entra-id">Step 4: Entra ID でのコンシューマー登録</h3>
<p>Power Platform のカスタム コネクタから API を利用するには、コンシューマー アプリも Microsoft Entra ID に登録する必要があります。<a href="https://entra.microsoft.com" target="_blank">Microsoft Entra admin center</a> に戻り、<strong>App registrations</strong> → <strong>+ New registration</strong> を選択します。今回は <code>HR-Service-Consumer</code> と名付け、同様にシングル テナントで登録します。</p>
<p>登録後の <strong>Overview</strong> で Client ID と Tenant ID を控えます。</p>
<p><img alt="The page to create a new client secret for the consumer application in Microsoft Entra ID. There are fields to configure description and duration of the secret, and a command to add the secret." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-08.png" /></p>
<p>1️⃣ <strong>Certificates &amp; Secrets</strong> → 2️⃣ <strong>+ New secret</strong> を選択し、3️⃣ 説明と有効期間を設定、4️⃣ <strong>Add</strong> をクリックします。生成されたシークレットの値を安全な場所に保存します。</p>
<p>次に 1️⃣ <strong>API permissions</strong> → 2️⃣ <strong>+ Add a permission</strong> を選択し、3️⃣ <strong>APIs my organization uses</strong> で検索して 4️⃣ <code>HR-Service-API</code> を選択します。</p>
<p><img alt="The page of Microsoft Entra admin center to grant a new permission to the consumer application. There is a panel on the right side with the list of APIs registered in the tenant and the &quot;HR-Service-API&quot; highlighted." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-09.png" /></p>
<p>側面パネルで <code>HR.Consume</code> の委任済みアクセス許可を選択し、<strong>Add permission</strong> をクリックします。
追加後、<strong>Grand admin consent for ...</strong> を選択して管理者同意を与えます。</p>
<p><img alt="The panel of Microsoft Entra admin center to grant a permission to an application. The group of **Delegated permissions** is selected and the permission of type **HR.Consume** is selected. The **Add permission** command is highlighted." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-10.png" /></p>
<p>完了すると、下図のように <code>User.Read</code> と <code>HR.Consume</code> の委任許可が並びます。</p>
<p><img alt="The permissions for the consumer applicaiton. There is the permission **User.Read** and there is the permission **HR.Consume**. Both permissions are of type Delegated." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-11.png" /></p>
<p>このタブは後の手順で再度使用するため開いたままにしておいてください。</p>
<p><cc-end-step lab="mcs5" exercise="1" step="4" /></p>
<h2 id="exercise-2">Exercise 2 : カスタム コネクタの作成</h2>
<p>このエクササイズでは、HR Service API を利用する Power Platform カスタム コネクタを作成します。</p>
<h3 id="step-1">Step 1: カスタム コネクタの作成</h3>
<p>ブラウザーで <a href="https://make.powerautomate.com" target="_blank">https://make.powerautomate.com</a> にアクセスし、左メニューで <strong>More</strong> → <strong>Discover all</strong> と進み、<strong>Custom connectors</strong> を探します。頻繁に使用する場合はピン留めしてください。カスタム コネクタ一覧ページで <strong>+ New custom connector</strong> → <strong>Import an OpenAPI file</strong> を選択します。</p>
<p><img alt="The menu to create a new Power Platform custom connector, highlighting the **Import an OpenAPI file** option." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-12.png" /></p>
<p>コネクタ名を入力し、<code>HR-Service</code> の OpenAPI JSON ファイルを参照します。ファイルは <a href="https://github.com/microsoft/copilot-camp/blob/main/src/make/copilot-studio/path-m-lab-mcs5-connectors/hr-service/src/openapi.json?raw=true" target="_blank">こちら</a> からも取得できます。入力後、<strong>Continue</strong> をクリックします。</p>
<p><img alt="The dialog to create a new custom connector starting from an OpenAPI JSON file. There is the name of the connector and the path of the OpenAPI specification file. The **Continue** command is highlighted." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-13.png" /></p>
<p>マルチステップの設定画面が表示されます。最初の <strong>General</strong> タブではアイコン、色、説明を設定できます。また、<strong>Host</strong> には Exercise 1 - Step 3 でコピーした dev tunnel のホスト名を入力し、<strong>Base URL</strong> は <code>/</code> のままで構いません。</p>
<p><img alt="The tab to configure **General** settings for the Power Platform custom connector. There are fields to configure icon, background color, description, protocol (HTTP or HTTPS), hostname, and base URL. There is a **Security** command at the bottom of the page." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-14.png" /></p>
<p>画面下部の <strong>Security</strong> をクリックし、認証タイプに <code>OAuth 2.0</code> を、フレーバーに <code>Azure Active Directory</code> を選択します。</p>
<p><img alt="The authentication type settings for the **Security** tab of the custom connector. The selected value is OAuth 2.0." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-15.png" /></p>
<p>設定項目:</p>
<ul>
<li>Client ID: Exercise 1 - Step 4 で登録したコンシューマー アプリの <code>&lt;Client-Id&gt;</code></li>
<li>Client secret: 同じく <code>&lt;Client-Secret&gt;</code></li>
<li>Authorization URL: 既定の Entra ID 認証 URL</li>
<li>Tenant ID: <code>&lt;Tenant-Id&gt;</code></li>
<li>Resource URL: Exercise 1 - Step 2 で設定した <code>&lt;Application-ID-URI&gt;</code> (<code>api://&lt;Client-Id&gt;</code>)</li>
<li>Enable on-behalf-of login: <code>False</code></li>
<li>Scope: <code>HR.Consume</code></li>
<li>Redirect URL: 読み取り専用</li>
</ul>
<p><img alt="The settings for OAuth 2.0 when Azure Active Directory is selected. There are settings for Client ID, Client secret, Authorization URL, Tenant ID, Resource URL, Enabled on-behalf-of login, Scope, Redirect URL." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-16.png" /></p>
<p>右上の <strong>Create connector</strong> をクリックして保存します。保存後に <strong>Security</strong> タブが更新され、<strong>Redirect URL</strong> の値が表示されます。これをコピーし、Microsoft Entra 管理センターでコンシューマー アプリに戻ります。1️⃣ <strong>Authentication</strong> → 2️⃣ <strong>+ Add a platform</strong> → 3️⃣ <strong>Web</strong> を選択し、4️⃣ コピーした <strong>Redirect URL</strong> を貼り付けて 5️⃣ <strong>Configure</strong> をクリックします。</p>
<p><img alt="The page to configure **Web** authentication for the consumer application." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-17.png" /></p>
<p>これで Power Platform からのリダイレクト URL が登録されました。</p>
<p><img alt="The panel to configure the consumer application with **Redirect URL** for **Web** authentication." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-18.png" /></p>
<p>カスタム コネクタ定義に戻り、<strong>Definition</strong> タブで API の各操作を確認できます。OpenAPI 仕様から取り込まれているため変更は不要です。<strong>Test</strong> タブに切り替えて動作確認も行えます。</p>
<p><cc-end-step lab="mcs5" exercise="2" step="1" /></p>
<h3 id="step-2">Step 2: カスタム コネクタのテスト</h3>
<p><strong>Test</strong> タブで左側の操作一覧から <strong>getCandidates</strong> などを選択し、<strong>+ New connection</strong> で認証を行います。接続後 <strong>Test operation</strong> をクリックすると、下部にレスポンスが表示されます。</p>
<p><img alt="The test page of the Power Platform custom connector, where you can invoke the target API providing credentials through a connection. In the upper part of the screen there is the configured connection. In the middle of the screen there is the operation to test. In the bottom part of the screen there is the output of the test HTTP request." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-19.png" /></p>
<p><cc-end-step lab="mcs5" exercise="2" step="2" /></p>
<h2 id="exercise-3">Exercise 3 : カスタム コネクタの利用</h2>
<p>このエクササイズでは、Exercise 2 で作成したカスタム コネクタを使用します。</p>
<h3 id="step-1_1">Step 1: エージェントからカスタム コネクタを利用する</h3>
<p><a href="../04-extending-m365-copilot" target="_blank">Lab MCS4</a> で作成した Microsoft 365 Copilot Chat エージェントからカスタム コネクタを呼び出します。</p>
<p>ブラウザーで <a href="https://copilotstudio.microsoft.com" target="_blank">https://copilotstudio.microsoft.com</a> にアクセスし、1️⃣ エージェント一覧から 2️⃣ <strong>Microsoft 365 Copilot</strong> を選択します。</p>
<p><img alt="The interface of Microsoft Copilot Studio when browsing the whole list of agents and selecting the **Microsoft 365 Copilot** agent." src="../../../../../assets/images/make/copilot-studio-04/create-agent-m365-copilot-chat-01.png" /></p>
<p><code>Agentic HR</code> エージェントを編集し、<strong>Actions</strong> セクションで <strong>+ Add action</strong> を選択します。Lab MCS4 - Exercise 2 - Step 1 と同様に進めますが、今回は <strong>Custom connector</strong> を選択し <code>HR-Services</code> を検索します。Exercise 2 - Step 1 で作成した <code>HR-Services</code> コネクタのアクションが表示されます。</p>
<p><code>Get all candidates</code> を選び、接続を確認します。
設定:</p>
<ul>
<li>Name: <code>Get all candidates</code></li>
<li>Description: <code>Lists all the HR candidates from an external system</code></li>
<li>Authentication: <code>User authentication</code></li>
</ul>
<p><strong>Add action</strong> で追加し、Lab MCS4 で作成した旧アクションは無効化します。無効化するには、アクション横の (...) をクリックし <strong>Status</strong> を <code>Off</code> にします。</p>
<p><img alt="The status menu item do enable/disable an action in an agent for Microsoft 365 Copilot Chat." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-20.png" /></p>
<p>エージェントを公開し、更新が完了したら Microsoft 365 Copilot Chat で次のプロンプトを入力してテストします。</p>
<pre><code class="language-text">Lists all the HR candidates from an external system
</code></pre>
<p>Microsoft 365 Copilot Chat は外部 REST API の利用許可を求めます。<strong>Always allow</strong> または <strong>Allow once</strong> を選択します。</p>
<p><img alt="Microsoft 365 Copilot Chat prompting the user to consent consumption of the HR Service external REST API. There are commands to **Always allow**, **Allow once**, or **Cancel**." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-21.png" /></p>
<p>続いてサインインを求められるので <strong>Sign in to Agentic HR</strong> をクリックし、認証を完了します。その後、同じプロンプトを再実行すると HR Service から取得した候補者一覧が表示され、回答下部に外部サービスからの応答であることを示すアイコンが表示されます。</p>
<p><img alt="Microsoft 365 Copilot Chat providing the list of candidates retrieved from the external API." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-23.png" /></p>
<p>Visual Studio Code の <strong>Terminal</strong> でも REST リクエストのトレースを確認できます。<code>Token is valid for user &lt;username&gt;</code> と表示され、認証が成功していることがわかります。</p>
<p><img alt="The **Terminal** window of Visual Studio Code with tracing information." src="../../../../../assets/images/make/copilot-studio-05/custom-connector-24.png" /></p>
<p>これでカスタム コネクタを構成し、Microsoft 365 Copilot Chat から利用できました!</p>
<p><cc-end-step lab="mcs5" exercise="3" step="1" /></p>
<p><span style="font-size: large; font-weight: bold; color: #1c8fd2;">おめでとうございます！</span></p>
<p>Lab MCS5 - Power Platform カスタム コネクタ を完了しました!</p>
<p><a href="../06-mcp">こちらから</a> Lab MCS6 を開始して、Copilot Studio で MCP サーバーを利用する方法を学びましょう。
<cc-next /> </p>
<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/make/copilot-studio/05-connectors--ja" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../../javascripts/cc-lab-step.js"></script>
      
        <script src="../../../../../javascripts/cc-card.js"></script>
      
    
  </body>
</html>